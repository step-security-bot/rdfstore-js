!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).rdfstore=e()}}((function(){var define,module,exports;return function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[s]={exports:{}};t[s][0].call(c.exports,(function(e){return i(t[s][1][e]||e)}),c,c.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){(function(e){(function(){"use strict";var r=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],n="undefined"==typeof globalThis?e:globalThis;t.exports=function(){for(var e=[],t=0;t<r.length;t++)"function"==typeof n[r[t]]&&(e[e.length]=r[t]);return e}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";r.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},r.toByteArray=function(e){var t,r,n=u(e),s=n[0],a=n[1],l=new o(function(e,t,r){return 3*(t+r)/4-r}(0,s,a)),c=0,f=a>0?s-4:s;for(r=0;r<f;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;2===a&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,l[c++]=255&t);1===a&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t);return l},r.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=16383,a=0,l=r-i;a<l;a+=s)o.push(c(e,a,a+s>l?l:a+s));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],3:[function(e,t,r){},{}],4:[function(e,t,r){arguments[4][3][0].apply(r,arguments)},{dup:3}],5:[function(e,t,r){(function(t){(function(){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
"use strict";var t=e("base64-js"),n=e("ieee754");r.Buffer=s,r.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},r.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=s.prototype,t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return a(e,t,r)}function a(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|p(e,t),n=o(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(B(e,ArrayBuffer)||e&&B(e.buffer,ArrayBuffer))return function(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r);return n.__proto__=s.prototype,n}(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return s.from(n,t,r);var i=function(e){if(s.isBuffer(e)){var t=0|f(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||U(e.length)?o(0):c(e);if("Buffer"===e.type&&Array.isArray(e.data))return c(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),o(e<0?0:0|f(e))}function c(e){for(var t=e.length<0?0:0|f(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function p(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||B(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Q(e).length;default:if(i)return n?-1:D(e).length;t=(""+t).toLowerCase(),i=!0}}function d(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return S(this,t,r);case"latin1":case"binary":return j(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function h(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),U(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){var o,s=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var c=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*s}else-1!==c&&(o-=o-c),c=-1}else for(r+l>a&&(r=a-l),o=r;o>=0;o--){for(var f=!0,p=0;p<l;p++)if(u(e,o+p)!==u(t,p)){f=!1;break}if(f)return o}return-1}function g(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(U(a))return s;e[r+s]=a}return s}function b(e,t,r,n){return M(D(t,e.length-r),e,r,n)}function m(e,t,r,n){return M(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function x(e,t,r,n){return m(e,t,r,n)}function _(e,t,r,n){return M(Q(t),e,r,n)}function w(e,t,r,n){return M(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function k(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function E(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,l,u=e[i],c=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=r)switch(f){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(l=(15&u)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(c=l)}null===c?(c=65533,f=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=f}return function(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=A));return r}(n)}r.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(e,t,r){return a(e,t,r)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},s.allocUnsafe=function(e){return u(e)},s.allocUnsafeSlow=function(e){return u(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(B(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),B(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=s.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(B(o,Uint8Array)&&(o=s.from(o)),!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):d.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s.prototype.compare=function(e,t,r,n,i){if(B(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),l=Math.min(o,a),u=this.slice(n,i),c=e.slice(t,r),f=0;f<l;++f)if(u[f]!==c[f]){o=u[f],a=c[f];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return g(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return m(this,e,t,r);case"latin1":case"binary":return x(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function S(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function j(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function T(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=P(e[o]);return i}function F(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function C(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,r,n,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function N(e,t,r,i,o){return t=+t,r>>>=0,o||R(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function O(e,t,r,i,o){return t=+t,r>>>=0,o||R(e,0,r,8),n.write(e,t,r,i,52,8),r+8}s.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=s.prototype,n},s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},s.prototype.readUInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||C(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||C(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||C(e,4,this.length),n.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||C(e,4,this.length),n.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||C(e,8,this.length),n.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||C(e,8,this.length),n.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||I(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},s.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||I(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);I(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);I(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,r){return N(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return N(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return O(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return O(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var o=i-1;o>=0;--o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},s.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=s.isBuffer(e)?e:s.from(e,n),l=a.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=a[o%l]}return this};var L=/[^+/0-9A-Za-z-_]/g;function P(e){return e<16?"0"+e.toString(16):e.toString(16)}function D(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Q(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function M(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function B(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function U(e){return e!=e}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":2,buffer:5,ieee754:21}],6:[function(e,t,r){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],7:[function(e,t,r){"use strict";var n=e("get-intrinsic"),i=e("./"),o=i(n("String.prototype.indexOf"));t.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&o(e,".prototype.")>-1?i(r):r}},{"./":8,"get-intrinsic":15}],8:[function(e,t,r){"use strict";var n=e("function-bind"),i=e("get-intrinsic"),o=i("%Function.prototype.apply%"),s=i("%Function.prototype.call%"),a=i("%Reflect.apply%",!0)||n.call(s,o),l=i("%Object.getOwnPropertyDescriptor%",!0),u=i("%Object.defineProperty%",!0),c=i("%Math.max%");if(u)try{u({},"a",{value:1})}catch(e){u=null}t.exports=function(e){var t=a(n,s,arguments);if(l&&u){var r=l(t,"length");r.configurable&&u(t,"length",{value:1+c(0,e.length-(arguments.length-1))})}return t};var f=function(){return a(n,o,arguments)};u?u(t.exports,"apply",{value:f}):t.exports.apply=f},{"function-bind":14,"get-intrinsic":15}],9:[function(e,t,r){"use strict";t.exports=function e(t){return null===t||"object"!=typeof t||null!=t.toJSON?JSON.stringify(t):Array.isArray(t)?"["+t.reduce(((t,r,n)=>t+(0===n?"":",")+e(void 0===r||"symbol"==typeof r?null:r)),"")+"]":"{"+Object.keys(t).sort().reduce(((r,n,i)=>{if(void 0===t[n]||"symbol"==typeof t[n])return r;return r+(0===r.length?"":",")+e(n)+":"+e(t[n])}),"")+"}"}},{}],10:[function(e,t,r){"use strict";var n=e("get-intrinsic")("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}t.exports=n},{"get-intrinsic":15}],11:[function(e,t,r){"use strict";var n,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&g(e,"error",t,r)}(e,i,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function f(e,t,r,n){var i,o,s,a;if(u(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,a=l,console&&console.warn&&console.warn(a)}return e}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=p.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):v(i,i.length)}function y(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function v(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var u=l.length,c=v(l,u);for(r=0;r<u;++r)o(c[r],this,t)}return!0},a.prototype.addListener=function(e,t){return f(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return f(this,e,t,!0)},a.prototype.once=function(e,t){return u(t),this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,i,o,s;if(u(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):y.call(e,t)},a.prototype.listenerCount=y,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},{}],12:[function(e,t,r){"use strict";var n=e("is-callable"),i=Object.prototype.toString,o=Object.prototype.hasOwnProperty,s=function(e,t,r){for(var n=0,i=e.length;n<i;n++)o.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))},a=function(e,t,r){for(var n=0,i=e.length;n<i;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)},l=function(e,t,r){for(var n in e)o.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))};t.exports=function(e,t,r){if(!n(t))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=r),"[object Array]"===i.call(e)?s(e,t,o):"string"==typeof e?a(e,t,o):l(e,t,o)}},{"is-callable":24}],13:[function(e,t,r){"use strict";var n="Function.prototype.bind called on incompatible ",i=Array.prototype.slice,o=Object.prototype.toString,s="[object Function]";t.exports=function(e){var t=this;if("function"!=typeof t||o.call(t)!==s)throw new TypeError(n+t);for(var r,a=i.call(arguments,1),l=function(){if(this instanceof r){var n=t.apply(this,a.concat(i.call(arguments)));return Object(n)===n?n:this}return t.apply(e,a.concat(i.call(arguments)))},u=Math.max(0,t.length-a.length),c=[],f=0;f<u;f++)c.push("$"+f);if(r=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(l),t.prototype){var p=function(){};p.prototype=t.prototype,r.prototype=new p,p.prototype=null}return r}},{}],14:[function(e,t,r){"use strict";var n=e("./implementation");t.exports=Function.prototype.bind||n},{"./implementation":13}],15:[function(e,t,r){"use strict";var n,i=SyntaxError,o=Function,s=TypeError,a=function(e){try{return o('"use strict"; return ('+e+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(e){l=null}var u=function(){throw new s},c=l?function(){try{return u}catch(e){try{return l(arguments,"callee").get}catch(e){return u}}}():u,f=e("has-symbols")(),p=Object.getPrototypeOf||function(e){return e.__proto__},d={},h="undefined"==typeof Uint8Array?n:p(Uint8Array),y={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":f?p([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":d,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":f?p(p([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&f?p((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&f?p((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":f?p(""[Symbol.iterator]()):n,"%Symbol%":f?Symbol:n,"%SyntaxError%":i,"%ThrowTypeError%":c,"%TypedArray%":h,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},v=function e(t){var r;if("%AsyncFunction%"===t)r=a("async function () {}");else if("%GeneratorFunction%"===t)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=a("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&(r=p(i.prototype))}return y[t]=r,r},g={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},b=e("function-bind"),m=e("has"),x=b.call(Function.call,Array.prototype.concat),_=b.call(Function.apply,Array.prototype.splice),w=b.call(Function.call,String.prototype.replace),k=b.call(Function.call,String.prototype.slice),E=b.call(Function.call,RegExp.prototype.exec),A=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,S=/\\(\\)?/g,j=function(e){var t=k(e,0,1),r=k(e,-1);if("%"===t&&"%"!==r)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var n=[];return w(e,A,(function(e,t,r,i){n[n.length]=r?w(i,S,"$1"):t||e})),n},T=function(e,t){var r,n=e;if(m(g,n)&&(n="%"+(r=g[n])[0]+"%"),m(y,n)){var o=y[n];if(o===d&&(o=v(n)),void 0===o&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new i("intrinsic "+e+" does not exist!")};t.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');if(null===E(/^%?[^%]*%?$/g,e))throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=j(e),n=r.length>0?r[0]:"",o=T("%"+n+"%",t),a=o.name,u=o.value,c=!1,f=o.alias;f&&(n=f[0],_(r,x([0,1],f)));for(var p=1,d=!0;p<r.length;p+=1){var h=r[p],v=k(h,0,1),g=k(h,-1);if(('"'===v||"'"===v||"`"===v||'"'===g||"'"===g||"`"===g)&&v!==g)throw new i("property names with quotes must have matching quotes");if("constructor"!==h&&d||(c=!0),m(y,a="%"+(n+="."+h)+"%"))u=y[a];else if(null!=u){if(!(h in u)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(l&&p+1>=r.length){var b=l(u,h);u=(d=!!b)&&"get"in b&&!("originalValue"in b.get)?b.get:u[h]}else d=m(u,h),u=u[h];d&&!c&&(y[a]=u)}}return u}},{"function-bind":14,has:19,"has-symbols":16}],16:[function(e,t,r){"use strict";var n="undefined"!=typeof Symbol&&Symbol,i=e("./shams");t.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&i())))}},{"./shams":17}],17:[function(e,t,r){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},{}],18:[function(e,t,r){"use strict";var n=e("has-symbols/shams");t.exports=function(){return n()&&!!Symbol.toStringTag}},{"has-symbols/shams":17}],19:[function(e,t,r){"use strict";var n=e("function-bind");t.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":14}],20:[function(e,t,r){var n=e("http"),i=e("url"),o=t.exports;for(var s in n)n.hasOwnProperty(s)&&(o[s]=n[s]);function a(e){if("string"==typeof e&&(e=i.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}o.request=function(e,t){return e=a(e),n.request.call(this,e,t)},o.get=function(e,t){return e=a(e),n.get.call(this,e,t)}},{http:91,url:112}],21:[function(e,t,r){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
r.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,l=(1<<a)-1,u=l>>1,c=-7,f=r?i-1:0,p=r?-1:1,d=e[t+f];for(f+=p,o=d&(1<<-c)-1,d>>=-c,c+=a;c>0;o=256*o+e[t+f],f+=p,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+e[t+f],f+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),o-=u}return(d?-1:1)*s*Math.pow(2,o-n)},r.write=function(e,t,r,n,i,o){var s,a,l,u=8*o-i-1,c=(1<<u)-1,f=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,h=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+f>=1?p/l:p*Math.pow(2,1-f))*l>=2&&(s++,l/=2),s+f>=c?(a=0,s=c):s+f>=1?(a=(t*l-1)*Math.pow(2,i),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;e[r+d]=255&a,d+=h,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+d]=255&s,d+=h,s/=256,u-=8);e[r+d-h]|=128*y}},{}],22:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},{}],23:[function(e,t,r){"use strict";var n=e("has-tostringtag/shams")(),i=e("call-bind/callBound")("Object.prototype.toString"),o=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},s=function(e){return!!o(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"[object Function]"===i(e.callee)},a=function(){return o(arguments)}();o.isLegacyArguments=s,t.exports=a?o:s},{"call-bind/callBound":7,"has-tostringtag/shams":18}],24:[function(e,t,r){"use strict";var n,i,o=Function.prototype.toString,s="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof s&&"function"==typeof Object.defineProperty)try{n=Object.defineProperty({},"length",{get:function(){throw i}}),i={},s((function(){throw 42}),null,n)}catch(e){e!==i&&(s=null)}else s=null;var a=/^\s*class\b/,l=function(e){try{var t=o.call(e);return a.test(t)}catch(e){return!1}},u=Object.prototype.toString,c="function"==typeof Symbol&&!!Symbol.toStringTag,f="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};t.exports=s?function(e){if(e===f)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;try{s(e,null,n)}catch(e){if(e!==i)return!1}return!l(e)}:function(e){if(e===f)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(c)return function(e){try{return!l(e)&&(o.call(e),!0)}catch(e){return!1}}(e);if(l(e))return!1;var t=u.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}},{}],25:[function(e,t,r){"use strict";var n,i=Object.prototype.toString,o=Function.prototype.toString,s=/^\s*(?:function)?\*/,a=e("has-tostringtag/shams")(),l=Object.getPrototypeOf;t.exports=function(e){if("function"!=typeof e)return!1;if(s.test(o.call(e)))return!0;if(!a)return"[object GeneratorFunction]"===i.call(e);if(!l)return!1;if(void 0===n){var t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}();n=!!t&&l(t)}return l(e)===n}},{"has-tostringtag/shams":18}],26:[function(e,t,r){(function(r){(function(){"use strict";var n=e("for-each"),i=e("available-typed-arrays"),o=e("call-bind/callBound"),s=o("Object.prototype.toString"),a=e("has-tostringtag/shams")(),l="undefined"==typeof globalThis?r:globalThis,u=i(),c=o("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},f=o("String.prototype.slice"),p={},d=e("es-abstract/helpers/getOwnPropertyDescriptor"),h=Object.getPrototypeOf;a&&d&&h&&n(u,(function(e){var t=new l[e];if(Symbol.toStringTag in t){var r=h(t),n=d(r,Symbol.toStringTag);if(!n){var i=h(r);n=d(i,Symbol.toStringTag)}p[e]=n.get}}));t.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!a||!(Symbol.toStringTag in e)){var t=f(s(e),8,-1);return c(u,t)>-1}return!!d&&function(e){var t=!1;return n(p,(function(r,n){if(!t)try{t=r.call(e)===n}catch(e){}})),t}(e)}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"available-typed-arrays":1,"call-bind/callBound":7,"es-abstract/helpers/getOwnPropertyDescriptor":10,"for-each":12,"has-tostringtag/shams":18}],27:[function(e,t,r){"use strict";const{isArray:n,isObject:i,isString:o}=e("./types"),{asArray:s}=e("./util"),{prependBase:a}=e("./url"),l=e("./JsonLdError"),u=e("./ResolvedContext");function c(e){throw new l("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:e})}function f({context:e,base:t}){if(!e)return;const r=e["@context"];if(o(r))e["@context"]=a(t,r);else if(n(r))for(let e=0;e<r.length;++e){const n=r[e];o(n)?r[e]=a(t,n):i(n)&&f({context:{"@context":n},base:t})}else if(i(r))for(const e in r)f({context:r[e],base:t})}t.exports=class{constructor({sharedCache:e}){this.perOpCache=new Map,this.sharedCache=e}async resolve({activeCtx:e,context:t,documentLoader:r,base:a,cycles:l=new Set}){t&&i(t)&&t["@context"]&&(t=t["@context"]),t=s(t);const f=[];for(const s of t){if(o(s)){let t=this._get(s);t||(t=await this._resolveRemoteContext({activeCtx:e,url:s,documentLoader:r,base:a,cycles:l})),n(t)?f.push(...t):f.push(t);continue}if(null===s){f.push(new u({document:null}));continue}i(s)||c(t);const p=JSON.stringify(s);let d=this._get(p);d||(d=new u({document:s}),this._cacheResolvedContext({key:p,resolved:d,tag:"static"})),f.push(d)}return f}_get(e){let t=this.perOpCache.get(e);if(!t){const r=this.sharedCache.get(e);r&&(t=r.get("static"),t&&this.perOpCache.set(e,t))}return t}_cacheResolvedContext({key:e,resolved:t,tag:r}){if(this.perOpCache.set(e,t),void 0!==r){let n=this.sharedCache.get(e);n||(n=new Map,this.sharedCache.set(e,n)),n.set(r,t)}return t}async _resolveRemoteContext({activeCtx:e,url:t,documentLoader:r,base:n,cycles:i}){t=a(n,t);const{context:o,remoteDoc:s}=await this._fetchContext({activeCtx:e,url:t,documentLoader:r,cycles:i});f({context:o,base:n=s.documentUrl||t});const l=await this.resolve({activeCtx:e,context:o,documentLoader:r,base:n,cycles:i});return this._cacheResolvedContext({key:t,resolved:l,tag:s.tag}),l}async _fetchContext({activeCtx:e,url:t,documentLoader:r,cycles:s}){if(s.size>10)throw new l("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"loading remote context failed":"context overflow",max:10});if(s.has(t))throw new l("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"recursive context inclusion":"context overflow",url:t});let a,u;s.add(t);try{u=await r(t),a=u.document||null,o(a)&&(a=JSON.parse(a))}catch(e){throw new l("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:t,cause:e})}if(!i(a))throw new l("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:t});return a="@context"in a?{"@context":a["@context"]}:{"@context":{}},u.contextUrl&&(n(a["@context"])||(a["@context"]=[a["@context"]]),a["@context"].push(u.contextUrl)),{context:a,remoteDoc:u}}}},{"./JsonLdError":28,"./ResolvedContext":32,"./types":47,"./url":48,"./util":49}],28:[function(e,t,r){"use strict";t.exports=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",t="jsonld.Error",r={}){super(e),this.name=t,this.message=e,this.details=r}}},{}],29:[function(e,t,r){"use strict";t.exports=e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,r){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,r)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t}},{}],30:[function(e,t,r){"use strict";t.exports=e("rdf-canonize").NQuads},{"rdf-canonize":64}],31:[function(e,t,r){"use strict";t.exports=class{constructor(){this._requests={}}wrapLoader(e){const t=this;return t._loader=e,function(){return t.add.apply(t,arguments)}}async add(e){let t=this._requests[e];if(t)return Promise.resolve(t);t=this._requests[e]=this._loader(e);try{return await t}finally{delete this._requests[e]}}}},{}],32:[function(e,t,r){"use strict";const n=e("lru-cache");t.exports=class{constructor({document:e}){this.document=e,this.cache=new n({max:10})}getProcessed(e){return this.cache.get(e)}setProcessed(e,t){this.cache.set(e,t)}}},{"lru-cache":50}],33:[function(e,t,r){"use strict";const n=e("./JsonLdError"),{isArray:i,isObject:o,isString:s,isUndefined:a}=e("./types"),{isList:l,isValue:u,isGraph:c,isSimpleGraph:f,isSubjectReference:p}=e("./graphTypes"),{expandIri:d,getContextValue:h,isKeyword:y,process:v,processingMode:g}=e("./context"),{removeBase:b,prependBase:m}=e("./url"),{REGEX_KEYWORD:x,addValue:_,asArray:w,compareShortestLeast:k}=e("./util"),E={};function A(e,t,r){if("@nest"!==d(e,t,{vocab:!0},r))throw new n("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}t.exports=E,E.compact=async({activeCtx:e,activeProperty:t=null,element:r,options:d={}})=>{if(i(r)){let n=[];for(let i=0;i<r.length;++i){const o=await E.compact({activeCtx:e,activeProperty:t,element:r[i],options:d});null!==o&&n.push(o)}if(d.compactArrays&&1===n.length){0===(h(e,t,"@container")||[]).length&&(n=n[0])}return n}const b=h(e,t,"@context");if(a(b)||(e=await v({activeCtx:e,localCtx:b,propagate:!0,overrideProtected:!0,options:d})),o(r)){if(d.link&&"@id"in r&&d.link.hasOwnProperty(r["@id"])){const e=d.link[r["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===r)return e[t].compacted}if(u(r)||p(r)){const n=E.compactValue({activeCtx:e,activeProperty:t,value:r,options:d});return d.link&&p(r)&&(d.link.hasOwnProperty(r["@id"])||(d.link[r["@id"]]=[]),d.link[r["@id"]].push({expanded:r,compacted:n})),n}if(l(r)){if((h(e,t,"@container")||[]).includes("@list"))return E.compact({activeCtx:e,activeProperty:t,element:r["@list"],options:d})}const b="@reverse"===t,m={},x=e;u(r)||p(r)||(e=e.revertToPreviousContext());const k=h(x,t,"@context");a(k)||(e=await v({activeCtx:e,localCtx:k,propagate:!0,overrideProtected:!0,options:d})),d.link&&"@id"in r&&(d.link.hasOwnProperty(r["@id"])||(d.link[r["@id"]]=[]),d.link[r["@id"]].push({expanded:r,compacted:m}));let S=r["@type"]||[];S.length>1&&(S=Array.from(S).sort());const j=e;for(const t of S){const r=E.compactIri({activeCtx:j,iri:t,relativeTo:{vocab:!0}}),n=h(x,r,"@context");a(n)||(e=await v({activeCtx:e,localCtx:n,options:d,propagate:!1}))}const T=Object.keys(r).sort();for(const a of T){const p=r[a];if("@id"!==a)if("@type"!==a)if("@reverse"!==a)if("@preserve"!==a)if("@index"!==a)if("@graph"!==a&&"@list"!==a&&"@included"!==a&&y(a)){const t=E.compactIri({activeCtx:e,iri:a,relativeTo:{vocab:!0}});_(m,t,p)}else{if(!i(p))throw new n("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===p.length){const t=E.compactIri({activeCtx:e,iri:a,value:p,relativeTo:{vocab:!0},reverse:b}),r=e.mappings.has(t)?e.mappings.get(t)["@nest"]:null;let n=m;r&&(A(e,r,d),o(m[r])||(m[r]={}),n=m[r]),_(n,t,p,{propertyIsArray:!0})}for(const t of p){const r=E.compactIri({activeCtx:e,iri:a,value:t,relativeTo:{vocab:!0},reverse:b}),n=e.mappings.has(r)?e.mappings.get(r)["@nest"]:null;let p=m;n&&(A(e,n,d),o(m[n])||(m[n]={}),p=m[n]);const y=h(e,r,"@container")||[],v=c(t),g=l(t);let x;g?x=t["@list"]:v&&(x=t["@graph"]);let k=await E.compact({activeCtx:e,activeProperty:r,element:g||v?x:t,options:d});if(g){if(i(k)||(k=[k]),y.includes("@list")){_(p,r,k,{valueIsArray:!0,allowDuplicate:!0});continue}k={[E.compactIri({activeCtx:e,iri:"@list",relativeTo:{vocab:!0}})]:k},"@index"in t&&(k[E.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"])}if(v)if(y.includes("@graph")&&(y.includes("@id")||y.includes("@index")&&f(t))){let n;p.hasOwnProperty(r)?n=p[r]:p[r]=n={};const i=(y.includes("@id")?t["@id"]:t["@index"])||E.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}});_(n,i,k,{propertyIsArray:!d.compactArrays||y.includes("@set")})}else y.includes("@graph")&&f(t)?(i(k)&&k.length>1&&(k={"@included":k}),_(p,r,k,{propertyIsArray:!d.compactArrays||y.includes("@set")})):(i(k)&&1===k.length&&d.compactArrays&&(k=k[0]),k={[E.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}})]:k},"@id"in t&&(k[E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t["@id"]),"@index"in t&&(k[E.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]),_(p,r,k,{propertyIsArray:!d.compactArrays||y.includes("@set")}));else if(y.includes("@language")||y.includes("@index")||y.includes("@id")||y.includes("@type")){let n,i;if(p.hasOwnProperty(r)?n=p[r]:p[r]=n={},y.includes("@language"))u(k)&&(k=k["@value"]),i=t["@language"];else if(y.includes("@index")){const n=h(e,r,"@index")||"@index",o=E.compactIri({activeCtx:e,iri:n,relativeTo:{vocab:!0}});if("@index"===n)i=t["@index"],delete k[o];else{let e;if([i,...e]=w(k[n]||[]),s(i))switch(e.length){case 0:delete k[n];break;case 1:k[n]=e[0];break;default:k[n]=e}else i=null}}else if(y.includes("@id")){const t=E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});i=k[t],delete k[t]}else if(y.includes("@type")){const n=E.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}});let o;switch([i,...o]=w(k[n]||[]),o.length){case 0:delete k[n];break;case 1:k[n]=o[0];break;default:k[n]=o}1===Object.keys(k).length&&"@id"in t&&(k=await E.compact({activeCtx:e,activeProperty:r,element:{"@id":t["@id"]},options:d}))}i||(i=E.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}})),_(n,i,k,{propertyIsArray:y.includes("@set")})}else{const e=!d.compactArrays||y.includes("@set")||y.includes("@list")||i(k)&&0===k.length||"@list"===a||"@graph"===a;_(p,r,k,{propertyIsArray:e})}}}else{if((h(e,t,"@container")||[]).includes("@index"))continue;const r=E.compactIri({activeCtx:e,iri:a,relativeTo:{vocab:!0}});_(m,r,p)}else{const r=await E.compact({activeCtx:e,activeProperty:t,element:p,options:d});i(r)&&0===r.length||_(m,a,r)}else{const t=await E.compact({activeCtx:e,activeProperty:"@reverse",element:p,options:d});for(const r in t)if(e.mappings.has(r)&&e.mappings.get(r).reverse){const n=t[r],i=(h(e,r,"@container")||[]).includes("@set")||!d.compactArrays;_(m,r,n,{propertyIsArray:i}),delete t[r]}if(Object.keys(t).length>0){const r=E.compactIri({activeCtx:e,iri:a,relativeTo:{vocab:!0}});_(m,r,t)}}else{let t=w(p).map((e=>E.compactIri({activeCtx:x,iri:e,relativeTo:{vocab:!0}})));1===t.length&&(t=t[0]);const r=E.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}}),n=(h(e,r,"@container")||[]).includes("@set")&&g(e,1.1)||i(t)&&0===p.length;_(m,r,t,{propertyIsArray:n})}else{let t=w(p).map((t=>E.compactIri({activeCtx:e,iri:t,relativeTo:{vocab:!1},base:d.base})));1===t.length&&(t=t[0]);m[E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t}}return m}return r},E.compactIri=({activeCtx:e,iri:t,value:r=null,relativeTo:i={vocab:!1},reverse:s=!1,base:a=null})=>{if(null===t)return t;e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext);const f=e.getInverse();if(y(t)&&t in f&&"@none"in f[t]&&"@type"in f[t]["@none"]&&"@none"in f[t]["@none"]["@type"])return f[t]["@none"]["@type"]["@none"];if(i.vocab&&t in f){const n=e["@language"]||"@none",i=[];o(r)&&"@index"in r&&!("@graph"in r)&&i.push("@index","@index@set"),o(r)&&"@preserve"in r&&(r=r["@preserve"][0]),c(r)?("@index"in r&&i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r&&i.push("@graph@id","@graph@id@set"),i.push("@graph","@graph@set","@set"),"@index"in r||i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r||i.push("@graph@id","@graph@id@set")):o(r)&&!u(r)&&i.push("@id","@id@set","@type","@set@type");let a="@language",f="@null";if(s)a="@type",f="@reverse",i.push("@set");else if(l(r)){"@index"in r||i.push("@list");const e=r["@list"];if(0===e.length)a="@any",f="@none";else{let t=0===e.length?n:null,r=null;for(let n=0;n<e.length;++n){const i=e[n];let o="@none",s="@none";if(u(i))if("@direction"in i){o=`${(i["@language"]||"").toLowerCase()}_${i["@direction"]}`}else"@language"in i?o=i["@language"].toLowerCase():"@type"in i?s=i["@type"]:o="@null";else s="@id";if(null===t?t=o:o!==t&&u(i)&&(t="@none"),null===r?r=s:s!==r&&(r="@none"),"@none"===t&&"@none"===r)break}t=t||"@none",r=r||"@none","@none"!==r?(a="@type",f=r):f=t}}else{if(u(r))if("@language"in r&&!("@index"in r)){i.push("@language","@language@set"),f=r["@language"];const e=r["@direction"];e&&(f=`${f}_${e}`)}else"@direction"in r&&!("@index"in r)?f=`_${r["@direction"]}`:"@type"in r&&(a="@type",f=r["@type"]);else a="@type",f="@id";i.push("@set")}i.push("@none"),o(r)&&!("@index"in r)&&i.push("@index","@index@set"),u(r)&&1===Object.keys(r).length&&i.push("@language","@language@set");const p=function(e,t,r,n,i,s){null===s&&(s="@null");const a=[];if(("@id"===s||"@reverse"===s)&&o(r)&&"@id"in r){"@reverse"===s&&a.push("@reverse");const t=E.compactIri({activeCtx:e,iri:r["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===r["@id"]?a.push.apply(a,["@vocab","@id"]):a.push.apply(a,["@id","@vocab"])}else{a.push(s);const e=a.find((e=>e.includes("_")));e&&a.push(e.replace(/^[^_]+_/,"_"))}a.push("@none");const l=e.inverse[t];for(const e of n){if(!(e in l))continue;const t=l[e][i];for(const e of a)if(e in t)return t[e]}return null}(e,t,r,i,a,f);if(null!==p)return p}if(i.vocab&&"@vocab"in e){const r=e["@vocab"];if(0===t.indexOf(r)&&t!==r){const n=t.substr(r.length);if(!e.mappings.has(n))return n}}let p=null;const d=[];let h=e.fastCurieMap;const v=t.length-1;for(let e=0;e<v&&t[e]in h;++e)h=h[t[e]],""in h&&d.push(h[""][0]);for(let n=d.length-1;n>=0;--n){const i=d[n],o=i.terms;for(const n of o){const o=n+":"+t.substr(i.iri.length);e.mappings.get(n)._prefix&&(!e.mappings.has(o)||null===r&&e.mappings.get(o)["@id"]===t)&&(null===p||k(o,p)<0)&&(p=o)}}if(null!==p)return p;for(const[r,i]of e.mappings)if(i&&i._prefix&&t.startsWith(r+":"))throw new n(`Absolute IRI "${t}" confused with prefix "${r}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:e});if(!i.vocab){if("@base"in e){if(e["@base"]){const r=b(m(a,e["@base"]),t);return x.test(r)?`./${r}`:r}return t}return b(a,t)}return t},E.compactValue=({activeCtx:e,activeProperty:t,value:r,options:n})=>{if(u(r)){const n=h(e,t,"@type"),i=h(e,t,"@language"),o=h(e,t,"@direction"),a=h(e,t,"@container")||[],l="@index"in r&&!a.includes("@index");if(!l&&"@none"!==n){if(r["@type"]===n)return r["@value"];if("@language"in r&&r["@language"]===i&&"@direction"in r&&r["@direction"]===o)return r["@value"];if("@language"in r&&r["@language"]===i)return r["@value"];if("@direction"in r&&r["@direction"]===o)return r["@value"]}const u=Object.keys(r).length,c=1===u||2===u&&"@index"in r&&!l,f="@language"in e,p=s(r["@value"]),d=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(c&&"@none"!==n&&(!f||!p||d))return r["@value"];const y={};return l&&(y[E.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=r["@index"]),"@type"in r?y[E.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:e,iri:r["@type"],relativeTo:{vocab:!0}}):"@language"in r&&(y[E.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=r["@language"]),"@direction"in r&&(y[E.compactIri({activeCtx:e,iri:"@direction",relativeTo:{vocab:!0}})]=r["@direction"]),y[E.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=r["@value"],y}const i=d(e,t,{vocab:!0},n),o=h(e,t,"@type"),a=E.compactIri({activeCtx:e,iri:r["@id"],relativeTo:{vocab:"@vocab"===o},base:n.base});return"@id"===o||"@vocab"===o||"@graph"===i?a:{[E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:a}}},{"./JsonLdError":28,"./context":35,"./graphTypes":42,"./types":47,"./url":48,"./util":49}],34:[function(e,t,r){"use strict";const n="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#";t.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:n,RDF_LIST:n+"List",RDF_FIRST:n+"first",RDF_REST:n+"rest",RDF_NIL:n+"nil",RDF_TYPE:n+"type",RDF_PLAIN_LITERAL:n+"PlainLiteral",RDF_XML_LITERAL:n+"XMLLiteral",RDF_JSON_LITERAL:n+"JSON",RDF_OBJECT:n+"object",RDF_LANGSTRING:n+"langString",XSD:i,XSD_BOOLEAN:i+"boolean",XSD_DOUBLE:i+"double",XSD_INTEGER:i+"integer",XSD_STRING:i+"string"}},{}],35:[function(e,t,r){"use strict";const n=e("./util"),i=e("./JsonLdError"),{isArray:o,isObject:s,isString:a,isUndefined:l}=e("./types"),{isAbsolute:u,isRelative:c,prependBase:f}=e("./url"),{handleEvent:p}=e("./events"),{REGEX_BCP47:d,REGEX_KEYWORD:h,asArray:y,compareShortestLeast:v}=e("./util"),g=new Map,b={};function m(e,t,r,n,i,o){if(null===t||!a(t)||b.isKeyword(t))return t;if(t.match(h))return null;if(n&&n.hasOwnProperty(t)&&!0!==i.get(t)&&b.createTermDefinition({activeCtx:e,localCtx:n,term:t,defined:i,options:o}),(r=r||{}).vocab){const r=e.mappings.get(t);if(null===r)return null;if(s(r)&&"@id"in r)return r["@id"]}const l=t.indexOf(":");if(l>0){const r=t.substr(0,l),s=t.substr(l+1);if("_"===r||0===s.indexOf("//"))return t;n&&n.hasOwnProperty(r)&&b.createTermDefinition({activeCtx:e,localCtx:n,term:r,defined:i,options:o});const a=e.mappings.get(r);if(a&&a._prefix)return a["@id"]+s;if(u(t))return t}if(r.vocab&&"@vocab"in e){t=e["@vocab"]+t}else if(r.base){let r,n;"@base"in e?e["@base"]?(n=f(o.base,e["@base"]),r=f(n,t)):(n=e["@base"],r=t):(n=o.base,r=f(o.base,t)),t=r}return t}function x(e,t){if(!e||"object"!=typeof e||!t||"object"!=typeof t)return e===t;const r=Array.isArray(e);if(r!==Array.isArray(t))return!1;if(r){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!x(e[r],t[r]))return!1;return!0}const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const r in e){let n=e[r],i=t[r];if("@container"===r&&Array.isArray(n)&&Array.isArray(i)&&(n=n.slice().sort(),i=i.slice().sort()),!x(n,i))return!1}return!0}t.exports=b,b.process=async({activeCtx:e,localCtx:t,options:r,propagate:n=!0,overrideProtected:l=!1,cycles:h=new Set})=>{s(t)&&"@context"in t&&o(t["@context"])&&(t=t["@context"]);if(0===y(t).length)return e;const v=[],g=[({event:e,next:t})=>{v.push(e),t()}];r.eventHandler&&g.push(r.eventHandler);const x=r;r={...r,eventHandler:g};const _=await r.contextResolver.resolve({activeCtx:e,context:t,documentLoader:r.documentLoader,base:r.base});s(_[0].document)&&"boolean"==typeof _[0].document["@propagate"]&&(n=_[0].document["@propagate"]);let w=e;n||w.previousContext||(w=w.clone(),w.previousContext=e);for(const n of _){let{document:o}=n;if(e=w,null===o){if(!l&&0!==Object.keys(e.protected).length)throw new i("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});w=e=b.getInitialContext(r).clone();continue}const y=n.getProcessed(e);if(y){if(x.eventHandler)for(const e of y.events)p({event:e,options:x});w=e=y.context;continue}if(s(o)&&"@context"in o&&(o=o["@context"]),!s(o))throw new i("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:o});w=w.clone();const g=new Map;if("@version"in o){if(1.1!==o["@version"])throw new i("Unsupported JSON-LD version: "+o["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:o});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new i("@version: "+o["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:o});w.processingMode="json-ld-1.1",w["@version"]=o["@version"],g.set("@version",!0)}if(w.processingMode=w.processingMode||e.processingMode,"@base"in o){let e=o["@base"];if(null===e||u(e));else{if(!c(e))throw new i('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:o});e=f(w["@base"],e)}w["@base"]=e,g.set("@base",!0)}if("@vocab"in o){const e=o["@vocab"];if(null===e)delete w["@vocab"];else{if(!a(e))throw new i('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:o});if(!u(e)&&b.processingMode(w,1))throw new i('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:o});{const t=m(w,e,{vocab:!0,base:!0},void 0,void 0,r);u(t)||r.eventHandler&&p({event:{type:["JsonLdEvent"],code:"relative @vocab reference",level:"warning",message:"Relative @vocab reference found.",details:{vocab:t}},options:r}),w["@vocab"]=t}}g.set("@vocab",!0)}if("@language"in o){const e=o["@language"];if(null===e)delete w["@language"];else{if(!a(e))throw new i('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:o});e.match(d)||r.eventHandler&&p({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:r}),w["@language"]=e.toLowerCase()}g.set("@language",!0)}if("@direction"in o){const t=o["@direction"];if("json-ld-1.0"===e.processingMode)throw new i("Invalid JSON-LD syntax; @direction not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:o});if(null===t)delete w["@direction"];else{if("ltr"!==t&&"rtl"!==t)throw new i('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:o});w["@direction"]=t}g.set("@direction",!0)}if("@propagate"in o){const r=o["@propagate"];if("json-ld-1.0"===e.processingMode)throw new i("Invalid JSON-LD syntax; @propagate not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:o});if("boolean"!=typeof r)throw new i("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:t});g.set("@propagate",!0)}if("@import"in o){const n=o["@import"];if("json-ld-1.0"===e.processingMode)throw new i("Invalid JSON-LD syntax; @import not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:o});if(!a(n))throw new i("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:t});const s=await r.contextResolver.resolve({activeCtx:e,context:n,documentLoader:r.documentLoader,base:r.base});if(1!==s.length)throw new i("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:t});const l=s[0].getProcessed(e);if(l)o=l;else{const r=s[0].document;if("@import"in r)throw new i("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:t});for(const e in r)o.hasOwnProperty(e)||(o[e]=r[e]);s[0].setProcessed(e,o)}g.set("@import",!0)}g.set("@protected",o["@protected"]||!1);for(const e in o)if(b.createTermDefinition({activeCtx:w,localCtx:o,term:e,defined:g,options:r,overrideProtected:l}),s(o[e])&&"@context"in o[e]){const t=o[e]["@context"];let n=!0;if(a(t)){const e=f(r.base,t);h.has(e)?n=!1:h.add(e)}if(n)try{await b.process({activeCtx:w.clone(),localCtx:o[e]["@context"],overrideProtected:!0,options:r,cycles:h})}catch(t){throw new i("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:o[e]["@context"],term:e})}}n.setProcessed(e,{context:w,events:v})}return w},b.createTermDefinition=({activeCtx:e,localCtx:t,term:r,defined:n,options:l,overrideProtected:c=!1})=>{if(n.has(r)){if(n.get(r))return;throw new i("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:r})}let f;if(n.set(r,!1),t.hasOwnProperty(r)&&(f=t[r]),"@type"===r&&s(f)&&"@set"===(f["@container"]||"@set")&&b.processingMode(e,1.1)){const e=["@container","@id","@protected"],n=Object.keys(f);if(0===n.length||n.some((t=>!e.includes(t))))throw new i("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:r})}else{if(b.isKeyword(r))throw new i("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:r});if(r.match(h))return void(l.eventHandler&&p({event:{type:["JsonLdEvent"],code:"reserved term",level:"warning",message:'Terms beginning with "@" are reserved for future use and dropped.',details:{term:r}},options:l}));if(""===r)throw new i("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t})}const d=e.mappings.get(r);e.mappings.has(r)&&e.mappings.delete(r);let y=!1;if((a(f)||null===f)&&(y=!0,f={"@id":f}),!s(f))throw new i("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const v={};e.mappings.set(r,v),v.reverse=!1;const g=["@container","@id","@language","@reverse","@type"];b.processingMode(e,1.1)&&g.push("@context","@direction","@index","@nest","@prefix","@protected");for(const e in f)if(!g.includes(e))throw new i("Invalid JSON-LD syntax; a term definition must not contain "+e,"jsonld.SyntaxError",{code:"invalid term definition",context:t});const _=r.indexOf(":");if(v._termHasColon=_>0,"@reverse"in f){if("@id"in f)throw new i("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});if("@nest"in f)throw new i("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});const o=f["@reverse"];if(!a(o))throw new i("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(o.match(h))return l.eventHandler&&p({event:{type:["JsonLdEvent"],code:"reserved @reverse value",level:"warning",message:'@reverse values beginning with "@" are reserved for future use and dropped.',details:{reverse:o}},options:l}),void(d?e.mappings.set(r,d):e.mappings.delete(r));const s=m(e,o,{vocab:!0,base:!1},t,n,l);if(!u(s))throw new i("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});v["@id"]=s,v.reverse=!0}else if("@id"in f){let o=f["@id"];if(o&&!a(o))throw new i("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(null===o)v["@id"]=null;else{if(!b.isKeyword(o)&&o.match(h))return l.eventHandler&&p({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:'@id values beginning with "@" are reserved for future use and dropped.',details:{id:o}},options:l}),void(d?e.mappings.set(r,d):e.mappings.delete(r));if(o!==r){if(o=m(e,o,{vocab:!0,base:!1},t,n,l),!u(o)&&!b.isKeyword(o))throw new i("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(r.match(/(?::[^:])|\//)){if(m(e,r,{vocab:!0,base:!1},t,new Map(n).set(r,!0),l)!==o)throw new i("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t})}v["@id"]=o,v._prefix=y&&!v._termHasColon&&o.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in v))if(v._termHasColon){const i=r.substr(0,_);if(t.hasOwnProperty(i)&&b.createTermDefinition({activeCtx:e,localCtx:t,term:i,defined:n,options:l}),e.mappings.has(i)){const t=r.substr(_+1);v["@id"]=e.mappings.get(i)["@id"]+t}else v["@id"]=r}else if("@type"===r)v["@id"]=r;else{if(!("@vocab"in e))throw new i("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:r});v["@id"]=e["@vocab"]+r}if((!0===f["@protected"]||!0===n.get("@protected")&&!1!==f["@protected"])&&(e.protected[r]=!0,v.protected=!0),n.set(r,!0),"@type"in f){let r=f["@type"];if(!a(r))throw new i("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@json"===r||"@none"===r){if(b.processingMode(e,1))throw new i(`Invalid JSON-LD syntax; an @context @type value must not be "${r}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else if("@id"!==r&&"@vocab"!==r){if(r=m(e,r,{vocab:!0,base:!1},t,n,l),!u(r))throw new i("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===r.indexOf("_:"))throw new i("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}v["@type"]=r}if("@container"in f){const r=a(f["@container"])?[f["@container"]]:f["@container"]||[],n=["@list","@set","@index","@language"];let s=!0;const l=r.includes("@set");if(b.processingMode(e,1.1)){if(n.push("@graph","@id","@type"),r.includes("@list")){if(1!==r.length)throw new i("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else if(r.includes("@graph")){if(r.some((e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e)))throw new i("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else s&=r.length<=(l?2:1);if(r.includes("@type")&&(v["@type"]=v["@type"]||"@id",!["@id","@vocab"].includes(v["@type"])))throw new i("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else s&=!o(f["@container"]),s&=r.length<=1;if(s&=r.every((e=>n.includes(e))),s&=!(l&&r.includes("@list")),!s)throw new i("Invalid JSON-LD syntax; @context @container value must be one of the following: "+n.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(v.reverse&&!r.every((e=>["@index","@set"].includes(e))))throw new i("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});v["@container"]=r}if("@index"in f){if(!("@container"in f)||!v["@container"].includes("@index"))throw new i(`Invalid JSON-LD syntax; @index without @index in @container: "${f["@index"]}" on term "${r}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});if(!a(f["@index"])||0===f["@index"].indexOf("@"))throw new i(`Invalid JSON-LD syntax; @index must expand to an IRI: "${f["@index"]}" on term "${r}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});v["@index"]=f["@index"]}if("@context"in f&&(v["@context"]=f["@context"]),"@language"in f&&!("@type"in f)){let e=f["@language"];if(null!==e&&!a(e))throw new i("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==e&&(e=e.toLowerCase()),v["@language"]=e}if("@prefix"in f){if(r.match(/:|\//))throw new i("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:t});if(b.isKeyword(v["@id"]))throw new i("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:t});if("boolean"!=typeof f["@prefix"])throw new i("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:t});v._prefix=!0===f["@prefix"]}if("@direction"in f){const e=f["@direction"];if(null!==e&&"ltr"!==e&&"rtl"!==e)throw new i('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:t});v["@direction"]=e}if("@nest"in f){const e=f["@nest"];if(!a(e)||"@nest"!==e&&0===e.indexOf("@"))throw new i("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:t});v["@nest"]=e}
// disallow aliasing @context and @preserve
const w=v["@id"];if("@context"===w||"@preserve"===w)throw new i("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t});if(d&&d.protected&&!c&&(e.protected[r]=!0,v.protected=!0,!x(d,v)))throw new i("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:t,term:r})},b.expandIri=(e,t,r,n)=>m(e,t,r,void 0,void 0,n),b.getInitialContext=e=>{const t=JSON.stringify({processingMode:e.processingMode}),r=g.get(t);if(r)return r;const i={processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const t=e.inverse={},r=e.fastCurieMap={},n={},i=(e["@language"]||"@none").toLowerCase(),a=e["@direction"],l=e.mappings,u=[...l.keys()].sort(v);for(const e of u){const o=l.get(e);if(null===o)continue;let u=o["@container"]||"@none";if(u=[].concat(u).sort().join(""),null===o["@id"])continue;const c=y(o["@id"]);for(const l of c){let c=t[l];const f=b.isKeyword(l);if(c)f||o._termHasColon||n[l].push(e);else if(t[l]=c={},!f&&!o._termHasColon){n[l]=[e];const t={iri:l,terms:n[l]};l[0]in r?r[l[0]].push(t):r[l[0]]=[t]}if(c[u]||(c[u]={"@language":{},"@type":{},"@any":{}}),c=c[u],s(e,c["@any"],"@none"),o.reverse)s(e,c["@type"],"@reverse");else if("@none"===o["@type"])s(e,c["@any"],"@none"),s(e,c["@language"],"@none"),s(e,c["@type"],"@none");else if("@type"in o)s(e,c["@type"],o["@type"]);else if("@language"in o&&"@direction"in o){const t=o["@language"],r=o["@direction"];s(e,c["@language"],t&&r?`${t}_${r}`.toLowerCase():t?t.toLowerCase():r?`_${r}`:"@null")}else"@language"in o?s(e,c["@language"],(o["@language"]||"@null").toLowerCase()):"@direction"in o?o["@direction"]?s(e,c["@language"],`_${o["@direction"]}`):s(e,c["@language"],"@none"):a?(s(e,c["@language"],`_${a}`),s(e,c["@language"],"@none"),s(e,c["@type"],"@none")):(s(e,c["@language"],i),s(e,c["@language"],"@none"),s(e,c["@type"],"@none"))}}for(const e in r)o(r,e,1);return t},clone:function(){const e={};e.mappings=n.clone(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,e.protected=n.clone(this.protected),this.previousContext&&(e.previousContext=this.previousContext.clone());e.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(e["@base"]=this["@base"]);"@language"in this&&(e["@language"]=this["@language"]);"@vocab"in this&&(e["@vocab"]=this["@vocab"]);return e},revertToPreviousContext:function(){if(!this.previousContext)return this;return this.previousContext.clone()},protected:{}};return 1e4===g.size&&g.clear(),g.set(t,i),i;function o(e,t,r){const n=e[t],i=e[t]={};let s,a;for(const e of n)s=e.iri,a=r>=s.length?"":s[r],a in i?i[a].push(e):i[a]=[e];for(const e in i)""!==e&&o(i,e,r+1)}function s(e,t,r){t.hasOwnProperty(r)||(t[r]=e)}},b.getContextValue=(e,t,r)=>{if(null===t){if("@context"===r)return;return null}if(e.mappings.has(t)){const n=e.mappings.get(t);if(l(r))return n;if(n.hasOwnProperty(r))return n[r]}return"@language"===r&&r in e||"@direction"===r&&r in e?e[r]:"@context"!==r?null:void 0},b.processingMode=(e,t)=>t.toString()>="1.1"?!e.processingMode||e.processingMode>="json-ld-"+t.toString():"json-ld-1.0"===e.processingMode,b.isKeyword=e=>{if(!a(e)||"@"!==e[0])return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":28,"./events":37,"./types":47,"./url":48,"./util":49}],36:[function(e,t,r){"use strict";const{parseLinkHeader:n,buildHeaders:i}=e("../util"),{LINK_HEADER_CONTEXT:o}=e("../constants"),s=e("../JsonLdError"),a=e("../RequestQueue"),{prependBase:l}=e("../url"),u=/(^|(\r\n))link:/i;t.exports=({secure:e,headers:t={},xhr:r}={headers:{}})=>{t=i(t);return(new a).wrapLoader((async function i(a){if(0!==a.indexOf("http:")&&0!==a.indexOf("https:"))throw new s('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:a});if(e&&0!==a.indexOf("https"))throw new s('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:a});let c;try{c=await function(e,t,r){e=e||XMLHttpRequest;const n=new e;return new Promise(((e,i)=>{n.onload=()=>e(n),n.onerror=e=>i(e),n.open("GET",t,!0);for(const e in r)n.setRequestHeader(e,r[e]);n.send()}))}(r,a,t)}catch(e){throw new s("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:a,cause:e})}if(c.status>=400)throw new s("URL could not be dereferenced: "+c.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:a,httpStatusCode:c.status});let f={contextUrl:null,documentUrl:a,document:c.response},p=null;const d=c.getResponseHeader("Content-Type");let h;u.test(c.getAllResponseHeaders())&&(h=c.getResponseHeader("Link"));if(h&&"application/ld+json"!==d){const e=n(h),t=e[o];if(Array.isArray(t))throw new s("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:a});t&&(f.contextUrl=t.target),p=e.alternate,p&&"application/ld+json"==p.type&&!(d||"").match(/^application\/(\w*\+)?json$/)&&(f=await i(l(a,p.target)))}return f}))}},{"../JsonLdError":28,"../RequestQueue":31,"../constants":34,"../url":48,"../util":49}],37:[function(e,t,r){"use strict";const n=e("./JsonLdError"),{isArray:i}=e("./types"),{asArray:o}=e("./util"),s={};function a({event:e,handlers:t}){let r=!0;for(let o=0;r&&o<t.length;++o){r=!1;const s=t[o];if(i(s))r=a({event:e,handlers:s});else if("function"==typeof s)s({event:e,next:()=>{r=!0}});else{if("object"!=typeof s)throw new n("Invalid event handler.","jsonld.InvalidEventHandler",{event:e});e.code in s?s[e.code]({event:e,next:()=>{r=!0}}):r=!0}}return r}t.exports=s,s.defaultEventHandler=null,s.setupEventHandler=({options:e={}})=>{const t=[].concat(e.safe?s.safeEventHandler:[],e.eventHandler?o(e.eventHandler):[],s.defaultEventHandler?s.defaultEventHandler:[]);return 0===t.length?null:t},s.handleEvent=({event:e,options:t})=>{a({event:e,handlers:t.eventHandler})};const l=new Set(["empty object","free-floating scalar","invalid @language value","invalid property","null @id value","null @value value","object with only @id","object with only @language","object with only @list","object with only @value","relative @id reference","relative @type reference","relative @vocab reference","reserved @id value","reserved @reverse value","reserved term","blank node predicate","relative graph reference","relative object reference","relative predicate reference","relative subject reference"]);s.safeEventHandler=function({event:e,next:t}){if("warning"===e.level&&l.has(e.code))throw new n("Safe mode validation error.","jsonld.ValidationError",{event:e});t()},s.logEventHandler=function({event:e,next:t}){console.log(`EVENT: ${e.message}`,{event:e}),t()},s.logWarningEventHandler=function({event:e,next:t}){"warning"===e.level&&console.warn(`WARNING: ${e.message}`,{event:e}),t()},s.unhandledEventHandler=function({event:e}){throw new n("No handler for event.","jsonld.UnhandledEvent",{event:e})},s.setDefaultEventHandler=function({eventHandler:e}={}){s.defaultEventHandler=e?o(e):null}},{"./JsonLdError":28,"./types":47,"./util":49}],38:[function(e,t,r){"use strict";const n=e("./JsonLdError"),{isArray:i,isObject:o,isEmptyObject:s,isString:a,isUndefined:l}=e("./types"),{isList:u,isValue:c,isGraph:f,isSubject:p}=e("./graphTypes"),{expandIri:d,getContextValue:h,isKeyword:y,process:v,processingMode:g}=e("./context"),{isAbsolute:b}=e("./url"),{REGEX_BCP47:m,REGEX_KEYWORD:x,addValue:_,asArray:w,getValues:k,validateTypeValue:E}=e("./util"),{handleEvent:A}=e("./events"),S={};async function j({activeCtx:e,activeProperty:t,expandedActiveProperty:r,element:f,expandedParent:x,options:k={},insideList:T,typeKey:I,typeScopedContext:R}){const N=Object.keys(f).sort(),O=[];let L;const P=f[I]&&"@json"===d(e,i(f[I])?f[I][0]:f[I],{vocab:!0},{...k,typeExpansion:!0});for(const j of N){let T,I=f[j];if("@context"===j)continue;const N=d(e,j,{vocab:!0},k);if(null===N||!b(N)&&!y(N)){k.eventHandler&&A({event:{type:["JsonLdEvent"],code:"invalid property",level:"warning",message:"Dropping property that did not expand into an absolute IRI or keyword.",details:{property:j,expandedProperty:N}},options:k});continue}if(y(N)){if("@reverse"===r)throw new n("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:I});if(N in x&&"@included"!==N&&"@type"!==N)throw new n("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:N})}if("@id"===N){if(!a(I)){if(!k.isFrame)throw new n('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:I});if(o(I)){if(!s(I))throw new n('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:I})}else{if(!i(I))throw new n('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:I});if(!I.every((e=>a(e))))throw new n('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:I})}}_(x,"@id",w(I).map((t=>{if(a(t)){const r=d(e,t,{base:!0},k);return k.eventHandler&&(null===r?A(null===t?{event:{type:["JsonLdEvent"],code:"null @id value",level:"warning",message:"Null @id found.",details:{id:t}},options:k}:{event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:t}},options:k}):b(r)||A({event:{type:["JsonLdEvent"],code:"relative @id reference",level:"warning",message:"Relative @id reference found.",details:{id:t,expandedId:r}},options:k})),r}return t})),{propertyIsArray:k.isFrame});continue}if("@type"===N){o(I)&&(I=Object.fromEntries(Object.entries(I).map((([e,t])=>[d(R,e,{vocab:!0}),w(t).map((e=>d(R,e,{base:!0,vocab:!0},{...k,typeExpansion:!0})))])))),E(I,k.isFrame),_(x,"@type",w(I).map((e=>{if(a(e)){const t=d(R,e,{base:!0,vocab:!0},{...k,typeExpansion:!0});return b(t)||k.eventHandler&&A({event:{type:["JsonLdEvent"],code:"relative @type reference",level:"warning",message:"Relative @type reference found.",details:{type:e}},options:k}),t}return e})),{propertyIsArray:k.isFrame});continue}if("@included"===N&&g(e,1.1)){const r=w(await S.expand({activeCtx:e,activeProperty:t,element:I,options:k}));if(!r.every((e=>p(e))))throw new n("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:I});_(x,"@included",r,{propertyIsArray:!0});continue}if("@graph"===N&&!o(I)&&!i(I))throw new n('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:I});if("@value"===N){L=I,P&&g(e,1.1)?x["@value"]=I:_(x,"@value",I,{propertyIsArray:k.isFrame});continue}if("@language"===N){if(null===I)continue;if(!a(I)&&!k.isFrame)throw new n('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:I});I=w(I).map((e=>a(e)?e.toLowerCase():e));for(const e of I)a(e)&&!e.match(m)&&k.eventHandler&&A({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:k});_(x,"@language",I,{propertyIsArray:k.isFrame});continue}if("@direction"===N){if(!a(I)&&!k.isFrame)throw new n('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:I});I=w(I);for(const e of I)if(a(e)&&"ltr"!==e&&"rtl"!==e)throw new n('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:I});_(x,"@direction",I,{propertyIsArray:k.isFrame});continue}if("@index"===N){if(!a(I))throw new n('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:I});_(x,"@index",I);continue}if("@reverse"===N){if(!o(I))throw new n('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:I});if(T=await S.expand({activeCtx:e,activeProperty:"@reverse",element:I,options:k}),"@reverse"in T)for(const e in T["@reverse"])_(x,e,T["@reverse"][e],{propertyIsArray:!0});let t=x["@reverse"]||null;for(const e in T){if("@reverse"===e)continue;null===t&&(t=x["@reverse"]={}),_(t,e,[],{propertyIsArray:!0});const r=T[e];for(let i=0;i<r.length;++i){const o=r[i];if(c(o)||u(o))throw new n('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:T});_(t,e,o,{propertyIsArray:!0})}}continue}if("@nest"===N){O.push(j);continue}let D=e;const Q=h(e,j,"@context");l(Q)||(D=await v({activeCtx:e,localCtx:Q,propagate:!0,overrideProtected:!0,options:k}));const M=h(D,j,"@container")||[];if(M.includes("@language")&&o(I)){T=F(D,I,h(D,j,"@direction"),k)}else if(M.includes("@index")&&o(I)){const t=M.includes("@graph"),r=h(D,j,"@index")||"@index",n="@index"!==r&&d(e,r,{vocab:!0},k);T=await C({activeCtx:D,options:k,activeProperty:j,value:I,asGraph:t,indexKey:r,propertyIndex:n})}else if(M.includes("@id")&&o(I)){const e=M.includes("@graph");T=await C({activeCtx:D,options:k,activeProperty:j,value:I,asGraph:e,indexKey:"@id"})}else if(M.includes("@type")&&o(I))T=await C({activeCtx:D.revertToPreviousContext(),options:k,activeProperty:j,value:I,asGraph:!1,indexKey:"@type"});else{const n="@list"===N;if(n||"@set"===N){let e=t;n&&"@graph"===r&&(e=null),T=await S.expand({activeCtx:D,activeProperty:e,element:I,options:k,insideList:n})}else T="@json"===h(e,j,"@type")?{"@type":"@json","@value":I}:await S.expand({activeCtx:D,activeProperty:j,element:I,options:k,insideList:!1})}if(null!==T||"@value"===N)if("@list"!==N&&!u(T)&&M.includes("@list")&&(T={"@list":w(T)}),M.includes("@graph")&&!M.some((e=>"@id"===e||"@index"===e))&&(T=w(T).map((e=>({"@graph":w(e)})))),D.mappings.has(j)&&D.mappings.get(j).reverse){const e=x["@reverse"]=x["@reverse"]||{};T=w(T);for(let t=0;t<T.length;++t){const r=T[t];if(c(r)||u(r))throw new n('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:T});_(e,N,r,{propertyIsArray:!0})}}else _(x,N,T,{propertyIsArray:!0})}if("@value"in x)if("@json"===x["@type"]&&g(e,1.1));else if((o(L)||i(L))&&!k.isFrame)throw new n('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:L});for(const s of O){const a=i(f[s])?f[s]:[f[s]];for(const i of a){if(!o(i)||Object.keys(i).some((t=>"@value"===d(e,t,{vocab:!0},k))))throw new n("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:i});await j({activeCtx:e,activeProperty:t,expandedActiveProperty:r,element:i,expandedParent:x,options:k,insideList:T,typeScopedContext:R,typeKey:I})}}}function T({activeCtx:e,activeProperty:t,value:r,options:n}){if(null==r)return null;const i=d(e,t,{vocab:!0},n);if("@id"===i)return d(e,r,{base:!0},n);if("@type"===i)return d(e,r,{vocab:!0,base:!0},{...n,typeExpansion:!0});const o=h(e,t,"@type");if(("@id"===o||"@graph"===i)&&a(r)){const i=d(e,r,{base:!0},n);return null===i&&r.match(x)&&n.eventHandler&&A({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:t}},options:n}),{"@id":i}}if("@vocab"===o&&a(r))return{"@id":d(e,r,{vocab:!0,base:!0},n)};if(y(i))return r;const s={};if(o&&!["@id","@vocab","@none"].includes(o))s["@type"]=o;else if(a(r)){const r=h(e,t,"@language");null!==r&&(s["@language"]=r);const n=h(e,t,"@direction");null!==n&&(s["@direction"]=n)}return["boolean","number","string"].includes(typeof r)||(r=r.toString()),s["@value"]=r,s}function F(e,t,r,o){const s=[],l=Object.keys(t).sort();for(const u of l){const l=d(e,u,{vocab:!0},o);let c=t[u];i(c)||(c=[c]);for(const e of c){if(null===e)continue;if(!a(e))throw new n("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});const i={"@value":e};"@none"!==l&&(u.match(m)||o.eventHandler&&A({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:u}},options:o}),i["@language"]=u.toLowerCase()),r&&(i["@direction"]=r),s.push(i)}}return s}async function C({activeCtx:e,options:t,activeProperty:r,value:o,asGraph:s,indexKey:a,propertyIndex:u}){const p=[],y=Object.keys(o).sort(),g="@type"===a;for(let b of y){if(g){const r=h(e,b,"@context");l(r)||(e=await v({activeCtx:e,localCtx:r,propagate:!1,options:t}))}let y,m=o[b];i(m)||(m=[m]),m=await S.expand({activeCtx:e,activeProperty:r,element:m,options:t,insideList:!1,insideIndex:!0}),y=u?"@none"===b?"@none":T({activeCtx:e,activeProperty:a,value:b,options:t}):d(e,b,{vocab:!0},t),"@id"===a?b=d(e,b,{base:!0},t):g&&(b=y);for(let e of m){if(s&&!f(e)&&(e={"@graph":[e]}),"@type"===a)"@none"===y||(e["@type"]?e["@type"]=[b].concat(e["@type"]):e["@type"]=[b]);else{if(c(e)&&!["@language","@type","@index"].includes(a))throw new n(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${a}".`,"jsonld.SyntaxError",{code:"invalid value object",value:e});u?"@none"!==y&&_(e,u,y,{propertyIsArray:!0,prependValue:!0}):"@none"===y||a in e||(e[a]=b)}p.push(e)}}return p}t.exports=S,S.expand=async({activeCtx:e,activeProperty:t=null,element:r,options:u={},insideList:c=!1,insideIndex:f=!1,typeScopedContext:p=null})=>{if(null==r)return null;if("@default"===t&&(u=Object.assign({},u,{isFrame:!1})),!i(r)&&!o(r))return c||null!==t&&"@graph"!==d(e,t,{vocab:!0},u)?T({activeCtx:e,activeProperty:t,value:r,options:u}):(u.eventHandler&&A({event:{type:["JsonLdEvent"],code:"free-floating scalar",level:"warning",message:"Dropping free-floating scalar not in a list.",details:{value:r}},options:u}),null);if(i(r)){let n=[];const o=h(e,t,"@container")||[];c=c||o.includes("@list");for(let o=0;o<r.length;++o){let s=await S.expand({activeCtx:e,activeProperty:t,element:r[o],options:u,insideIndex:f,typeScopedContext:p});c&&i(s)&&(s={"@list":s}),null!==s&&(i(s)?n=n.concat(s):n.push(s))}return n}const y=d(e,t,{vocab:!0},u),m=h(e,t,"@context");p=p||(e.previousContext?e:null);let x=Object.keys(r).sort(),_=!f;if(_&&p&&x.length<=2&&!x.includes("@context"))for(const t of x){const r=d(p,t,{vocab:!0},u);if("@value"===r){_=!1,e=p;break}if("@id"===r&&1===x.length){_=!1;break}}_&&(e=e.revertToPreviousContext()),l(m)||(e=await v({activeCtx:e,localCtx:m,propagate:!0,overrideProtected:!0,options:u})),"@context"in r&&(e=await v({activeCtx:e,localCtx:r["@context"],options:u})),p=e;let E=null;for(const t of x){if("@type"===d(e,t,{vocab:!0},u)){E=E||t;const n=r[t],i=Array.isArray(n)?n.length>1?n.slice().sort():n:[n];for(const t of i){const r=h(p,t,"@context");l(r)||(e=await v({activeCtx:e,localCtx:r,options:u,propagate:!1}))}}}let F={};await j({activeCtx:e,activeProperty:t,expandedActiveProperty:y,element:r,expandedParent:F,options:u,insideList:c,typeKey:E,typeScopedContext:p}),x=Object.keys(F);let C=x.length;if("@value"in F){if("@type"in F&&("@language"in F||"@direction"in F))throw new n('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:F});let t=C-1;if("@type"in F&&(t-=1),"@index"in F&&(t-=1),"@language"in F&&(t-=1),"@direction"in F&&(t-=1),0!==t)throw new n('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:F});const r=null===F["@value"]?[]:w(F["@value"]),i=k(F,"@type");if(g(e,1.1)&&i.includes("@json")&&1===i.length);else if(0===r.length)u.eventHandler&&A({event:{type:["JsonLdEvent"],code:"null @value value",level:"warning",message:"Dropping null @value value.",details:{value:F}},options:u}),F=null;else{if(!r.every((e=>a(e)||s(e)))&&"@language"in F)throw new n("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:F});if(!i.every((e=>b(e)&&!(a(e)&&0===e.indexOf("_:"))||s(e))))throw new n('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:F})}}else if("@type"in F&&!i(F["@type"]))F["@type"]=[F["@type"]];else if("@set"in F||"@list"in F){if(C>1&&(2!==C||!("@index"in F)))throw new n('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:F});"@set"in F&&(F=F["@set"],x=Object.keys(F),C=x.length)}else 1===C&&"@language"in F&&(u.eventHandler&&A({event:{type:["JsonLdEvent"],code:"object with only @language",level:"warning",message:"Dropping object with only @language.",details:{value:F}},options:u}),F=null);if(o(F)&&!u.keepFreeFloatingNodes&&!c&&(null===t||"@graph"===y)&&(0===C||"@value"in F||"@list"in F||1===C&&"@id"in F)){if(u.eventHandler){let e,t;0===C?(e="empty object",t="Dropping empty object."):"@value"in F?(e="object with only @value",t="Dropping object with only @value."):"@list"in F?(e="object with only @list",t="Dropping object with only @list."):1===C&&"@id"in F&&(e="object with only @id",t="Dropping object with only @id."),A({event:{type:["JsonLdEvent"],code:e,level:"warning",message:t,details:{value:F}},options:u})}F=null}return F}},{"./JsonLdError":28,"./context":35,"./events":37,"./graphTypes":42,"./types":47,"./url":48,"./util":49}],39:[function(e,t,r){"use strict";const{isSubjectReference:n}=e("./graphTypes"),{createMergedNodeMap:i}=e("./nodeMap"),o={};t.exports=o,o.flatten=e=>{const t=i(e),r=[],o=Object.keys(t).sort();for(let e=0;e<o.length;++e){const i=t[o[e]];n(i)||r.push(i)}return r}},{"./graphTypes":42,"./nodeMap":44}],40:[function(e,t,r){"use strict";const{isKeyword:n}=e("./context"),i=e("./graphTypes"),o=e("./types"),s=e("./util"),a=e("./url"),l=e("./JsonLdError"),{createNodeMap:u,mergeNodeMapGraphs:c}=e("./nodeMap"),f={};function p(e){const t={};for(const r in e)void 0!==e[r]&&(t["@"+r]=[e[r]]);return[t]}function d(e,t,r){for(let n=r.length-1;n>=0;--n){const i=r[n];if(i.graph===t&&i.subject["@id"]===e["@id"])return!0}return!1}function h(e,t,r){const n="@"+r;let i=n in e?e[n][0]:t[r];if("embed"===r)if(!0===i)i="@once";else if(!1===i)i="@never";else if("@always"!==i&&"@never"!==i&&"@link"!==i&&"@first"!==i&&"@last"!==i&&"@once"!==i)throw new l("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:e});return i}function y(e){if(!o.isArray(e)||1!==e.length||!o.isObject(e[0]))throw new l("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e});if("@id"in e[0])for(const t of s.asArray(e[0]["@id"]))if(!o.isObject(t)&&!a.isAbsolute(t)||o.isString(t)&&0===t.indexOf("_:"))throw new l("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e});if("@type"in e[0])for(const t of s.asArray(e[0]["@type"]))if(!o.isObject(t)&&!a.isAbsolute(t)||o.isString(t)&&0===t.indexOf("_:"))throw new l("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e})}function v(e,t,r,a){let l=!0,u=!1;for(const c in r){let f=!1;const p=s.getValues(t,c),d=0===s.getValues(r,c).length;if("@id"===c){if(o.isEmptyObject(r["@id"][0]||{})?f=!0:r["@id"].length>=0&&(f=r["@id"].includes(p[0])),!a.requireAll)return f}else if("@type"===c){if(l=!1,d){if(p.length>0)return!1;f=!0}else if(1===r["@type"].length&&o.isEmptyObject(r["@type"][0]))f=p.length>0;else for(const e of r["@type"])f=!(!o.isObject(e)||!("@default"in e))||(f||p.some((t=>t===e)));if(!a.requireAll)return f}else{if(n(c))continue;{const t=s.getValues(r,c)[0];let n=!1;if(t&&(y([t]),n="@default"in t),l=!1,0===p.length&&n)continue;if(p.length>0&&d)return!1;if(void 0===t){if(p.length>0)return!1;f=!0}else if(i.isList(t)){const r=t["@list"][0];if(i.isList(p[0])){const t=p[0]["@list"];i.isValue(r)?f=t.some((e=>_(r,e))):(i.isSubject(r)||i.isSubjectReference(r))&&(f=t.some((t=>x(e,r,t,a))))}}else f=i.isValue(t)?p.some((e=>_(t,e))):i.isSubjectReference(t)?p.some((r=>x(e,t,r,a))):!!o.isObject(t)&&p.length>0}}if(!f&&a.requireAll)return!1;u=u||f}return l||u}function g(e,t){const r=e.uniqueEmbeds[e.graph],n=r[t],i=n.parent,a=n.property,l={"@id":t};if(o.isArray(i)){for(let e=0;e<i.length;++e)if(s.compareValues(i[e],l)){i[e]=l;break}}else{const e=o.isArray(i[a]);s.removeValue(i,a,l,{propertyIsArray:e}),s.addValue(i,a,l,{propertyIsArray:e})}const u=e=>{const t=Object.keys(r);for(const n of t)n in r&&o.isObject(r[n].parent)&&r[n].parent["@id"]===e&&(delete r[n],u(n))};u(t)}
/**
 * Removes the @preserve keywords from expanded result of framing.
 *
 * @param input the framed, framed output.
 * @param options the framing options used.
 *
 * @return the resulting output.
 */function b(e,t){if(o.isArray(e))return e.map((e=>b(e,t)));if(o.isObject(e)){
// remove @preserve
if("@preserve"in e)return e["@preserve"][0];if(i.isValue(e))return e;if(i.isList(e))return e["@list"]=b(e["@list"],t),e;if("@id"in e){const r=e["@id"];if(t.link.hasOwnProperty(r)){const n=t.link[r].indexOf(e);if(-1!==n)return t.link[r][n];t.link[r].push(e)}else t.link[r]=[e]}for(const r in e)"@id"===r&&t.bnodesToClear.includes(e[r])?delete e["@id"]:e[r]=b(e[r],t)}return e}function m(e,t,r){o.isObject(e)?s.addValue(e,t,r,{propertyIsArray:!0}):e.push(r)}function x(e,t,r,n){if(!("@id"in r))return!1;const i=e.subjects[r["@id"]];return i&&v(e,i,t,n)}function _(e,t){const r=t["@value"],n=t["@type"],i=t["@language"],s=e["@value"]?o.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],a=e["@type"]?o.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],l=e["@language"]?o.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===s.length&&0===a.length&&0===l.length||!(!s.includes(r)&&!o.isEmptyObject(s[0]))&&(!!(!n&&0===a.length||a.includes(n)||n&&o.isEmptyObject(a[0]))&&!!(!i&&0===l.length||l.includes(i)||i&&o.isEmptyObject(l[0])))}t.exports=f,f.frameMergedOrDefault=(e,t,r)=>{const n={options:r,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},i=new s.IdentifierIssuer("_:b");u(e,n.graphMap,"@default",i),r.merged&&(n.graphMap["@merged"]=c(n.graphMap),n.graph="@merged"),n.subjects=n.graphMap[n.graph];const o=[];return f.frame(n,Object.keys(n.subjects).sort(),t,o),r.pruneBlankNodeIdentifiers&&(r.bnodesToClear=Object.keys(n.bnodeMap).filter((e=>1===n.bnodeMap[e].length))),
// remove @preserve from results
r.link={},b(o,r)},f.frame=(e,t,r,a,u=null)=>{y(r),r=r[0];const c=e.options,b={embed:h(r,c,"embed"),explicit:h(r,c,"explicit"),requireAll:h(r,c,"requireAll")};e.link.hasOwnProperty(e.graph)||(e.link[e.graph]={});const x=e.link[e.graph],w=function(e,t,r,n){const i={};for(const o of t){const t=e.graphMap[e.graph][o];v(e,t,r,n)&&(i[o]=t)}return i}(e,t,r,b),k=Object.keys(w).sort();for(const y of k){const v=w[y];if(null===u?e.uniqueEmbeds={[e.graph]:{}}:e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{},"@link"===b.embed&&y in x){m(a,u,x[y]);continue}const k={"@id":y};if(0===y.indexOf("_:")&&s.addValue(e.bnodeMap,y,k,{propertyIsArray:!0}),x[y]=k,("@first"===b.embed||"@last"===b.embed)&&e.is11)throw new l("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:r});if(e.embedded||!e.uniqueEmbeds[e.graph].hasOwnProperty(y))if(!e.embedded||"@never"!==b.embed&&!d(v,e.graph,e.subjectStack))if(!e.embedded||"@first"!=b.embed&&"@once"!=b.embed||!e.uniqueEmbeds[e.graph].hasOwnProperty(y)){if("@last"===b.embed&&y in e.uniqueEmbeds[e.graph]&&g(e,y),e.uniqueEmbeds[e.graph][y]={parent:a,property:u},e.subjectStack.push({subject:v,graph:e.graph}),y in e.graphMap){let t=!1,n=null;"@graph"in r?(n=r["@graph"][0],t=!("@merged"===y||"@default"===y),o.isObject(n)||(n={})):(t="@merged"!==e.graph,n={}),t&&f.frame({...e,graph:y,embedded:!1},Object.keys(e.graphMap[y]).sort(),[n],k,"@graph")}"@included"in r&&f.frame({...e,embedded:!1},t,r["@included"],k,"@included");for(const t of Object.keys(v).sort())if(n(t)){if(k[t]=s.clone(v[t]),"@type"===t)for(const t of v["@type"])0===t.indexOf("_:")&&s.addValue(e.bnodeMap,t,k,{propertyIsArray:!0})}else if(!b.explicit||t in r)for(const n of v[t]){const o=t in r?r[t]:p(b);if(i.isList(n)){const o=r[t]&&r[t][0]&&r[t][0]["@list"]?r[t][0]["@list"]:p(b),a={"@list":[]};m(k,t,a);const l=n["@list"];for(const t of l)i.isSubjectReference(t)?f.frame({...e,embedded:!0},[t["@id"]],o,a,"@list"):m(a,"@list",s.clone(t))}else i.isSubjectReference(n)?f.frame({...e,embedded:!0},[n["@id"]],o,k,t):_(o[0],n)&&m(k,t,s.clone(n))}for(const e of Object.keys(r).sort()){if("@type"===e){if(!o.isObject(r[e][0])||!("@default"in r[e][0]))continue}else if(n(e))continue;const t=r[e][0]||{};if(!h(t,c,"omitDefault")&&!(e in k)){let r="@null";"@default"in t&&(r=s.clone(t["@default"])),o.isArray(r)||(r=[r]),k[e]=[{"@preserve":r}]}}for(const t of Object.keys(r["@reverse"]||{}).sort()){const n=r["@reverse"][t];for(const r of Object.keys(e.subjects)){s.getValues(e.subjects[r],t).some((e=>e["@id"]===y))&&(k["@reverse"]=k["@reverse"]||{},s.addValue(k["@reverse"],t,[],{propertyIsArray:!0}),f.frame({...e,embedded:!0},[r],n,k["@reverse"][t],u))}}m(a,u,k),e.subjectStack.pop()}else m(a,u,k);else m(a,u,k)}},f.cleanupNull=(e,t)=>{if(o.isArray(e)){return e.map((e=>f.cleanupNull(e,t))).filter((e=>e))}if("@null"===e)return null;if(o.isObject(e)){if("@id"in e){const r=e["@id"];if(t.link.hasOwnProperty(r)){const n=t.link[r].indexOf(e);if(-1!==n)return t.link[r][n];t.link[r].push(e)}else t.link[r]=[e]}for(const r in e)e[r]=f.cleanupNull(e[r],t)}return e}},{"./JsonLdError":28,"./context":35,"./graphTypes":42,"./nodeMap":44,"./types":47,"./url":48,"./util":49}],41:[function(e,t,r){"use strict";const n=e("./JsonLdError"),i=e("./graphTypes"),o=e("./types"),{REGEX_BCP47:s,addValue:a}=e("./util"),{handleEvent:l}=e("./events"),{RDF_LIST:u,RDF_FIRST:c,RDF_REST:f,RDF_NIL:p,RDF_TYPE:d,RDF_JSON_LITERAL:h,XSD_BOOLEAN:y,XSD_DOUBLE:v,XSD_INTEGER:g,XSD_STRING:b}=e("./constants"),m={};function x(e,t,r,i){if(e.termType.endsWith("Node"))return{"@id":e.value};const a={"@value":e.value};if(e.language)e.language.match(s)||i.eventHandler&&l({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e.language}},options:i}),a["@language"]=e.language;else{let u=e.datatype.value;if(u||(u=b),u===h){u="@json";try{a["@value"]=JSON.parse(a["@value"])}catch(e){throw new n("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:a["@value"],cause:e})}}if(t){if(u===y)"true"===a["@value"]?a["@value"]=!0:"false"===a["@value"]&&(a["@value"]=!1);else if(o.isNumeric(a["@value"]))if(u===g){const e=parseInt(a["@value"],10);e.toFixed(0)===a["@value"]&&(a["@value"]=e)}else u===v&&(a["@value"]=parseFloat(a["@value"]));[y,g,v,b].includes(u)||(a["@type"]=u)}else if("i18n-datatype"===r&&u.startsWith("https://www.w3.org/ns/i18n#")){const[,e,t]=u.split(/[#_]/);e.length>0&&(a["@language"]=e,e.match(s)||i.eventHandler&&l({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:i})),a["@direction"]=t}else u!==b&&(a["@type"]=u)}return a}t.exports=m,m.fromRDF=async(e,t)=>{const r={},n={"@default":r},s={},{useRdfType:l=!1,useNativeTypes:h=!1,rdfDirection:y=null}=t;for(const i of e){const e="DefaultGraph"===i.graph.termType?"@default":i.graph.value;e in n||(n[e]={}),"@default"===e||e in r||(r[e]={"@id":e});const o=n[e],u=i.subject.value,c=i.predicate.value,f=i.object;u in o||(o[u]={"@id":u});const v=o[u],g=f.termType.endsWith("Node");if(g&&!(f.value in o)&&(o[f.value]={"@id":f.value}),c===d&&!l&&g){a(v,"@type",f.value,{propertyIsArray:!0});continue}const b=x(f,h,y,t);if(a(v,c,b,{propertyIsArray:!0}),g)if(f.value===p){const e=o[f.value];"usages"in e||(e.usages=[]),e.usages.push({node:v,property:c,value:b})}else f.value in s?s[f.value]=!1:s[f.value]={node:v,property:c,value:b}}for(const e in n){const t=n[e];if(!(p in t))continue;const r=t[p];if(r.usages){for(let e of r.usages){let r=e.node,n=e.property,a=e.value;const l=[],p=[];let d=Object.keys(r).length;for(;n===f&&o.isObject(s[r["@id"]])&&o.isArray(r[c])&&1===r[c].length&&o.isArray(r[f])&&1===r[f].length&&(3===d||4===d&&o.isArray(r["@type"])&&1===r["@type"].length&&r["@type"][0]===u)&&(l.push(r[c][0]),p.push(r["@id"]),e=s[r["@id"]],r=e.node,n=e.property,a=e.value,d=Object.keys(r).length,i.isBlankNode(r)););delete a["@id"],a["@list"]=l.reverse();for(const e of p)delete t[e]}delete r.usages}}const v=[],g=Object.keys(r).sort();for(const e of g){const t=r[e];if(e in n){const r=t["@graph"]=[],o=n[e],s=Object.keys(o).sort();for(const e of s){const t=o[e];i.isSubjectReference(t)||r.push(t)}}i.isSubjectReference(t)||v.push(t)}return v}},{"./JsonLdError":28,"./constants":34,"./events":37,"./graphTypes":42,"./types":47,"./util":49}],42:[function(e,t,r){"use strict";const n=e("./types"),i={};t.exports=i,i.isSubject=e=>{if(n.isObject(e)&&!("@value"in e||"@set"in e||"@list"in e)){return Object.keys(e).length>1||!("@id"in e)}return!1},i.isSubjectReference=e=>n.isObject(e)&&1===Object.keys(e).length&&"@id"in e,i.isValue=e=>n.isObject(e)&&"@value"in e,i.isList=e=>n.isObject(e)&&"@list"in e,i.isGraph=e=>n.isObject(e)&&"@graph"in e&&1===Object.keys(e).filter((e=>"@id"!==e&&"@index"!==e)).length,i.isSimpleGraph=e=>i.isGraph(e)&&!("@id"in e),i.isBlankNode=e=>{if(n.isObject(e)){if("@id"in e){const t=e["@id"];return!n.isString(t)||0===t.indexOf("_:")}return 0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e)}return!1}},{"./types":47}],43:[function(e,t,r){
/**
 * A JavaScript implementation of the JSON-LD API.
 *
 * @author Dave Longley
 *
 * @license BSD 3-Clause License
 * Copyright (c) 2011-2022 Digital Bazaar, Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 *
 * Neither the name of the Digital Bazaar, Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
 * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
const n=e("rdf-canonize"),i=e("./platform"),o=e("./util"),s=e("./ContextResolver"),a=o.IdentifierIssuer,l=e("./JsonLdError"),u=e("lru-cache"),c=e("./NQuads"),{expand:f}=e("./expand"),{flatten:p}=e("./flatten"),{fromRDF:d}=e("./fromRdf"),{toRDF:h}=e("./toRdf"),{frameMergedOrDefault:y,cleanupNull:v}=e("./frame"),{isArray:g,isObject:b,isString:m}=e("./types"),{isSubjectReference:x}=e("./graphTypes"),{expandIri:_,getInitialContext:w,process:k,processingMode:E}=e("./context"),{compact:A,compactIri:S}=e("./compact"),{createNodeMap:j,createMergedNodeMap:T,mergeNodeMaps:F}=e("./nodeMap"),{logEventHandler:C,logWarningEventHandler:I,safeEventHandler:R,setDefaultEventHandler:N,setupEventHandler:O,strictEventHandler:L,unhandledEventHandler:P}=e("./events"),D=function(t){const r={},D=new u({max:100});function Q(e,{documentLoader:r=t.documentLoader,...n}){if(e&&"compactionMap"in e)throw new l('"compactionMap" not supported.',"jsonld.OptionsError");if(e&&"expansionMap"in e)throw new l('"expansionMap" not supported.',"jsonld.OptionsError");return Object.assign({},{documentLoader:r},n,e,{eventHandler:O({options:e})})}return t.compact=async function(e,r,n){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===r)throw new l("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===e)return null;let i;(n=Q(n,{base:m(e)?e:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new a("_:b"),contextResolver:new s({sharedCache:D})})).link&&(n.skipExpansion=!0),n.compactToRelative||delete n.base,i=n.skipExpansion?e:await t.expand(e,n);const u=await t.processContext(w(n),r,n);let c=await A({activeCtx:u,element:i,options:n});n.compactArrays&&!n.graph&&g(c)?1===c.length?c=c[0]:0===c.length&&(c={}):n.graph&&b(c)&&(c=[c]),b(r)&&"@context"in r&&(r=r["@context"]),r=o.clone(r),g(r)||(r=[r]);const f=r;r=[];for(let e=0;e<f.length;++e)(!b(f[e])||Object.keys(f[e]).length>0)&&r.push(f[e]);const p=r.length>0;if(1===r.length&&(r=r[0]),g(c)){const e=S({activeCtx:u,iri:"@graph",relativeTo:{vocab:!0}}),t=c;c={},p&&(c["@context"]=r),c[e]=t}else if(b(c)&&p){const e=c;c={"@context":r};for(const t in e)c[t]=e[t]}return c},t.expand=async function(e,r){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");const n={},i=[];if("expandContext"in(r=Q(r,{keepFreeFloatingNodes:!1,contextResolver:new s({sharedCache:D})}))){const e=o.clone(r.expandContext);b(e)&&"@context"in e?n.expandContext=e:n.expandContext={"@context":e},i.push(n.expandContext)}let a;if(m(e)){const o=await t.get(e,r);a=o.documentUrl,n.input=o.document,o.contextUrl&&(n.remoteContext={"@context":o.contextUrl},i.push(n.remoteContext))}else n.input=o.clone(e);"base"in r||(r.base=a||"");let l=w(r);for(const e of i)l=await k({activeCtx:l,localCtx:e,options:r});let u=await f({activeCtx:l,element:n.input,options:r});return b(u)&&"@graph"in u&&1===Object.keys(u).length?u=u["@graph"]:null===u&&(u=[]),g(u)||(u=[u]),u},t.flatten=async function(e,r,n){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");r="function"==typeof r?null:r||null,n=Q(n,{base:m(e)?e:"",contextResolver:new s({sharedCache:D})});const i=await t.expand(e,n),o=p(i);if(null===r)return o;n.graph=!0,n.skipExpansion=!0;const a=await t.compact(o,r,n);return a},t.frame=async function(e,r,n){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(n=Q(n,{base:m(e)?e:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new s({sharedCache:D})}),m(r)){const e=await t.get(r,n);if(r=e.document,e.contextUrl){let t=r["@context"];t?g(t)?t.push(e.contextUrl):t=[t,e.contextUrl]:t=e.contextUrl,r["@context"]=t}}const i=r&&r["@context"]||{},o=await t.processContext(w(n),i,n);n.hasOwnProperty("omitGraph")||(n.omitGraph=E(o,1.1)),n.hasOwnProperty("pruneBlankNodeIdentifiers")||(n.pruneBlankNodeIdentifiers=E(o,1.1));const a=await t.expand(e,n),l={...n};l.isFrame=!0,l.keepFreeFloatingNodes=!0;const u=await t.expand(r,l),c=Object.keys(r).map((e=>_(o,e,{vocab:!0})));l.merged=!c.includes("@graph"),l.is11=E(o,1.1);const f=y(a,u,l);l.graph=!n.omitGraph,l.skipExpansion=!0,l.link={},l.framing=!0;let p=await t.compact(f,i,l);return l.link={},p=v(p,l),p},t.link=async function(e,r,n){const i={};return r&&(i["@context"]=r),i["@embed"]="@link",t.frame(e,i,n)},t.normalize=t.canonize=async function(e,r){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(r=Q(r,{base:m(e)?e:null,algorithm:"URDNA2015",skipExpansion:!1,safe:!0,contextResolver:new s({sharedCache:D})}))){if("application/n-quads"!==r.inputFormat&&"application/nquads"!==r.inputFormat)throw new l("Unknown canonicalization input format.","jsonld.CanonizeError");const t=c.parse(e);return n.canonize(t,r)}const i={...r};delete i.format,i.produceGeneralizedRdf=!1;const o=await t.toRDF(e,i);return n.canonize(o,r)},t.fromRDF=async function(e,t){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");t=Q(t,{format:m(e)?"application/n-quads":void 0});const{format:n}=t;let{rdfParser:i}=t;if(n){if(i=i||r[n],!i)throw new l("Unknown input format.","jsonld.UnknownFormat",{format:n})}else i=()=>e;const o=await i(e);return d(o,t)},t.toRDF=async function(e,r){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let n;n=(r=Q(r,{base:m(e)?e:"",skipExpansion:!1,contextResolver:new s({sharedCache:D})})).skipExpansion?e:await t.expand(e,r);const i=h(n,r);if(r.format){if("application/n-quads"===r.format||"application/nquads"===r.format)return c.serialize(i);throw new l("Unknown output format.","jsonld.UnknownFormat",{format:r.format})}return i},t.createNodeMap=async function(e,r){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");r=Q(r,{base:m(e)?e:"",contextResolver:new s({sharedCache:D})});const n=await t.expand(e,r);return T(n,r)},t.merge=async function(e,r,n){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!g(e))throw new TypeError('Could not merge, "docs" must be an array.');r="function"==typeof r?null:r||null,n=Q(n,{contextResolver:new s({sharedCache:D})});const i=await Promise.all(e.map((e=>{const r={...n};return t.expand(e,r)})));let l=!0;"mergeNodes"in n&&(l=n.mergeNodes);const u=n.issuer||new a("_:b"),c={"@default":{}};for(let e=0;e<i.length;++e){const t=o.relabelBlankNodes(i[e],{issuer:new a("_:b"+e+"-")}),r=l||0===e?c:{"@default":{}};if(j(t,r,"@default",u),r!==c)for(const e in r){const t=r[e];if(!(e in c)){c[e]=t;continue}const n=c[e];for(const e in t)e in n||(n[e]=t[e])}}const f=F(c),p=[],d=Object.keys(f).sort();for(let e=0;e<d.length;++e){const t=f[d[e]];x(t)||p.push(t)}if(null===r)return p;n.graph=!0,n.skipExpansion=!0;const h=await t.compact(p,r,n);return h},Object.defineProperty(t,"documentLoader",{get:()=>t._documentLoader,set:e=>t._documentLoader=e}),t.documentLoader=async e=>{throw new l("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})},t.get=async function(e,r){let n;n="function"==typeof r.documentLoader?r.documentLoader:t.documentLoader;const i=await n(e);try{if(!i.document)throw new l("No remote document found at the given URL.","jsonld.NullRemoteDocument");m(i.document)&&(i.document=JSON.parse(i.document))}catch(e){throw new l("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:i})}return i},t.processContext=async function(e,t,r){return r=Q(r,{base:"",contextResolver:new s({sharedCache:D})}),null===t?w(r):(t=o.clone(t),b(t)&&"@context"in t||(t={"@context":t}),k({activeCtx:e,localCtx:t,options:r}))},t.getContextValue=e("./context").getContextValue,t.documentLoaders={},t.useDocumentLoader=function(e){if(!(e in t.documentLoaders))throw new l('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});t.documentLoader=t.documentLoaders[e].apply(t,Array.prototype.slice.call(arguments,1))},t.registerRDFParser=function(e,t){r[e]=t},t.unregisterRDFParser=function(e){delete r[e]},t.registerRDFParser("application/n-quads",c.parse),t.registerRDFParser("application/nquads",c.parse),t.url=e("./url"),t.logEventHandler=C,t.logWarningEventHandler=I,t.safeEventHandler=R,t.setDefaultEventHandler=N,t.strictEventHandler=L,t.unhandledEventHandler=P,t.util=o,Object.assign(t,o),t.promises=t,t.RequestQueue=e("./RequestQueue"),t.JsonLdProcessor=e("./JsonLdProcessor")(t),i.setupGlobals(t),i.setupDocumentLoaders(t),t},Q=function(){return D((function(){return Q()}))};D(Q),t.exports=Q},{"./ContextResolver":27,"./JsonLdError":28,"./JsonLdProcessor":29,"./NQuads":30,"./RequestQueue":31,"./compact":33,"./context":35,"./events":37,"./expand":38,"./flatten":39,"./frame":40,"./fromRdf":41,"./graphTypes":42,"./nodeMap":44,"./platform":45,"./toRdf":46,"./types":47,"./url":48,"./util":49,"lru-cache":50,"rdf-canonize":64}],44:[function(e,t,r){"use strict";const{isKeyword:n}=e("./context"),i=e("./graphTypes"),o=e("./types"),s=e("./util"),a=e("./JsonLdError"),l={};t.exports=l,l.createMergedNodeMap=(e,t)=>{const r=(t=t||{}).issuer||new s.IdentifierIssuer("_:b"),n={"@default":{}};return l.createNodeMap(e,n,"@default",r),l.mergeNodeMaps(n)},l.createNodeMap=(e,t,r,u,c,f)=>{if(o.isArray(e)){for(const n of e)l.createNodeMap(n,t,r,u,void 0,f);return}if(!o.isObject(e))return void(f&&f.push(e));if(i.isValue(e)){if("@type"in e){let t=e["@type"];0===t.indexOf("_:")&&(e["@type"]=t=u.getId(t))}return void(f&&f.push(e))}if(f&&i.isList(e)){const n=[];return l.createNodeMap(e["@list"],t,r,u,c,n),void f.push({"@list":n})}if("@type"in e){const t=e["@type"];for(const e of t)0===e.indexOf("_:")&&u.getId(e)}o.isUndefined(c)&&(c=i.isBlankNode(e)?u.getId(e["@id"]):e["@id"]),f&&f.push({"@id":c});const p=t[r],d=p[c]=p[c]||{};d["@id"]=c;const h=Object.keys(e).sort();for(let o of h){if("@id"===o)continue;if("@reverse"===o){const n={"@id":c},o=e["@reverse"];for(const e in o){const a=o[e];for(const o of a){let a=o["@id"];i.isBlankNode(o)&&(a=u.getId(a)),l.createNodeMap(o,t,r,u,a),s.addValue(p[a],e,n,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===o){c in t||(t[c]={}),l.createNodeMap(e[o],t,c,u);continue}if("@included"===o){l.createNodeMap(e[o],t,r,u);continue}if("@type"!==o&&n(o)){if("@index"===o&&o in d&&(e[o]!==d[o]||e[o]["@id"]!==d[o]["@id"]))throw new a("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:d});d[o]=e[o];continue}const f=e[o];if(0===o.indexOf("_:")&&(o=u.getId(o)),0!==f.length)for(let e of f)if("@type"===o&&(e=0===e.indexOf("_:")?u.getId(e):e),i.isSubject(e)||i.isSubjectReference(e)){if("@id"in e&&!e["@id"])continue;const n=i.isBlankNode(e)?u.getId(e["@id"]):e["@id"];s.addValue(d,o,{"@id":n},{propertyIsArray:!0,allowDuplicate:!1}),l.createNodeMap(e,t,r,u,n)}else if(i.isValue(e))s.addValue(d,o,e,{propertyIsArray:!0,allowDuplicate:!1});else if(i.isList(e)){const n=[];l.createNodeMap(e["@list"],t,r,u,c,n),e={"@list":n},s.addValue(d,o,e,{propertyIsArray:!0,allowDuplicate:!1})}else l.createNodeMap(e,t,r,u,c),s.addValue(d,o,e,{propertyIsArray:!0,allowDuplicate:!1});else s.addValue(d,o,[],{propertyIsArray:!0})}},l.mergeNodeMapGraphs=e=>{const t={};for(const r of Object.keys(e).sort())for(const i of Object.keys(e[r]).sort()){const o=e[r][i];i in t||(t[i]={"@id":i});const a=t[i];for(const e of Object.keys(o).sort())if(n(e)&&"@type"!==e)a[e]=s.clone(o[e]);else for(const t of o[e])s.addValue(a,e,s.clone(t),{propertyIsArray:!0,allowDuplicate:!1})}return t},l.mergeNodeMaps=e=>{const t=e["@default"],r=Object.keys(e).sort();for(const n of r){if("@default"===n)continue;const r=e[n];let o=t[n];o?"@graph"in o||(o["@graph"]=[]):t[n]=o={"@id":n,"@graph":[]};const s=o["@graph"];for(const e of Object.keys(r).sort()){const t=r[e];i.isSubjectReference(t)||s.push(t)}}return t}},{"./JsonLdError":28,"./context":35,"./graphTypes":42,"./types":47,"./util":49}],45:[function(e,t,r){"use strict";const n=e("./documentLoaders/xhr"),i={};t.exports=i,i.setupDocumentLoaders=function(e){"undefined"!=typeof XMLHttpRequest&&(e.documentLoaders.xhr=n,e.useDocumentLoader("xhr"))},i.setupGlobals=function(e){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor})}},{"./documentLoaders/xhr":36}],46:[function(e,t,r){"use strict";const{createNodeMap:n}=e("./nodeMap"),{isKeyword:i}=e("./context"),o=e("./graphTypes"),s=e("canonicalize"),a=e("./types"),l=e("./util"),{handleEvent:u}=e("./events"),{RDF_FIRST:c,RDF_REST:f,RDF_NIL:p,RDF_TYPE:d,RDF_JSON_LITERAL:h,RDF_LANGSTRING:y,XSD_BOOLEAN:v,XSD_DOUBLE:g,XSD_INTEGER:b,XSD_STRING:m}=e("./constants"),{isAbsolute:x}=e("./url"),_={};function w(e,t,r,n,o){const s=Object.keys(t).sort();for(const a of s){const s=t[a],l=Object.keys(s).sort();for(let t of l){const l=s[t];if("@type"===t)t=d;else if(i(t))continue;for(const i of l){const s={termType:a.startsWith("_:")?"BlankNode":"NamedNode",value:a};if(!x(a)){o.eventHandler&&u({event:{type:["JsonLdEvent"],code:"relative subject reference",level:"warning",message:"Relative subject reference found.",details:{subject:a}},options:o});continue}const l={termType:t.startsWith("_:")?"BlankNode":"NamedNode",value:t};if(!x(t)){o.eventHandler&&u({event:{type:["JsonLdEvent"],code:"relative predicate reference",level:"warning",message:"Relative predicate reference found.",details:{predicate:t}},options:o});continue}if("BlankNode"===l.termType&&!o.produceGeneralizedRdf){o.eventHandler&&u({event:{type:["JsonLdEvent"],code:"blank node predicate",level:"warning",message:"Dropping blank node predicate.",details:{property:n.getOldIds().find((e=>n.getId(e)===t))}},options:o});continue}const c=k(i,n,e,r,o.rdfDirection,o);c&&e.push({subject:s,predicate:l,object:c,graph:r})}}}}function k(e,t,r,n,i,l){const d={};if(o.isValue(e)){d.termType="Literal",d.value=void 0,d.datatype={termType:"NamedNode"};let t=e["@value"];const r=e["@type"]||null;if("@json"===r)d.value=s(t),d.datatype.value=h;else if(a.isBoolean(t))d.value=t.toString(),d.datatype.value=r||v;else if(a.isDouble(t)||r===g)a.isDouble(t)||(t=parseFloat(t)),d.value=t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),d.datatype.value=r||g;else if(a.isNumber(t))d.value=t.toFixed(0),d.datatype.value=r||b;else if("i18n-datatype"===i&&"@direction"in e){const r="https://www.w3.org/ns/i18n#"+(e["@language"]||"")+`_${e["@direction"]}`;d.datatype.value=r,d.value=t}else"@language"in e?(d.value=t,d.datatype.value=r||y,d.language=e["@language"]):(d.value=t,d.datatype.value=r||m)}else if(o.isList(e)){const o=function(e,t,r,n,i,o){const s={termType:"NamedNode",value:c},a={termType:"NamedNode",value:f},l={termType:"NamedNode",value:p},u=e.pop(),d=u?{termType:"BlankNode",value:t.getId()}:l;let h=d;for(const l of e){const e=k(l,t,r,n,i,o),u={termType:"BlankNode",value:t.getId()};r.push({subject:h,predicate:s,object:e,graph:n}),r.push({subject:h,predicate:a,object:u,graph:n}),h=u}if(u){const e=k(u,t,r,n,i,o);r.push({subject:h,predicate:s,object:e,graph:n}),r.push({subject:h,predicate:a,object:l,graph:n})}return d}(e["@list"],t,r,n,i,l);d.termType=o.termType,d.value=o.value}else{const t=a.isObject(e)?e["@id"]:e;d.termType=t.startsWith("_:")?"BlankNode":"NamedNode",d.value=t}return"NamedNode"!==d.termType||x(d.value)?d:(l.eventHandler&&u({event:{type:["JsonLdEvent"],code:"relative object reference",level:"warning",message:"Relative object reference found.",details:{object:d.value}},options:l}),null)}t.exports=_,_.toRDF=(e,t)=>{const r=new l.IdentifierIssuer("_:b"),i={"@default":{}};n(e,i,"@default",r);const o=[],s=Object.keys(i).sort();for(const e of s){let n;if("@default"===e)n={termType:"DefaultGraph",value:""};else{if(!x(e)){t.eventHandler&&u({event:{type:["JsonLdEvent"],code:"relative graph reference",level:"warning",message:"Relative graph reference found.",details:{graph:e}},options:t});continue}n=e.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},n.value=e}w(o,i[e],n,r,t)}return o}},{"./constants":34,"./context":35,"./events":37,"./graphTypes":42,"./nodeMap":44,"./types":47,"./url":48,"./util":49,canonicalize:9}],47:[function(e,t,r){"use strict";const n={};t.exports=n,n.isArray=Array.isArray,n.isBoolean=e=>"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e),n.isDouble=e=>n.isNumber(e)&&(-1!==String(e).indexOf(".")||Math.abs(e)>=1e21),n.isEmptyObject=e=>n.isObject(e)&&0===Object.keys(e).length,n.isNumber=e=>"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e),n.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e),n.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),n.isString=e=>"string"==typeof e||"[object String]"===Object.prototype.toString.call(e),n.isUndefined=e=>void 0===e},{}],48:[function(e,t,r){"use strict";const n=e("./types"),i={};t.exports=i,i.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},i.parse=(e,t)=>{const r={},n=i.parsers[t||"full"],o=n.regex.exec(e);let s=n.keys.length;for(;s--;)r[n.keys[s]]=void 0===o[s]?null:o[s];return("https"===r.scheme&&"443"===r.port||"http"===r.scheme&&"80"===r.port)&&(r.href=r.href.replace(":"+r.port,""),r.authority=r.authority.replace(":"+r.port,""),r.port=null),r.normalizedPath=i.removeDotSegments(r.path),r},i.prependBase=(e,t)=>{if(null===e)return t;if(i.isAbsolute(t))return t;e&&!n.isString(e)||(e=i.parse(e||""));const r=i.parse(t),o={protocol:e.protocol||""};if(null!==r.authority)o.authority=r.authority,o.path=r.path,o.query=r.query;else if(o.authority=e.authority,""===r.path)o.path=e.path,null!==r.query?o.query=r.query:o.query=e.query;else{if(0===r.path.indexOf("/"))o.path=r.path;else{let t=e.path;t=t.substr(0,t.lastIndexOf("/")+1),(t.length>0||e.authority)&&"/"!==t.substr(-1)&&(t+="/"),t+=r.path,o.path=t}o.query=r.query}""!==r.path&&(o.path=i.removeDotSegments(o.path));let s=o.protocol;return null!==o.authority&&(s+="//"+o.authority),s+=o.path,null!==o.query&&(s+="?"+o.query),null!==r.fragment&&(s+="#"+r.fragment),""===s&&(s="./"),s},i.removeBase=(e,t)=>{if(null===e)return t;e&&!n.isString(e)||(e=i.parse(e||""));let r="";if(""!==e.href?r+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(r+="//"),0!==t.indexOf(r))return t;const o=i.parse(t.substr(r.length)),s=e.normalizedPath.split("/"),a=o.normalizedPath.split("/"),l=o.fragment||o.query?0:1;for(;s.length>0&&a.length>l&&s[0]===a[0];)s.shift(),a.shift();let u="";if(s.length>0){s.pop();for(let e=0;e<s.length;++e)u+="../"}return u+=a.join("/"),null!==o.query&&(u+="?"+o.query),null!==o.fragment&&(u+="#"+o.fragment),""===u&&(u="./"),u},i.removeDotSegments=e=>{if(0===e.length)return"";const t=e.split("/"),r=[];for(;t.length>0;){const e=t.shift(),n=0===t.length;"."!==e?".."!==e?r.push(e):(r.pop(),n&&r.push("")):n&&r.push("")}return"/"===e[0]&&r.length>0&&""!==r[0]&&r.unshift(""),1===r.length&&""===r[0]?"/":r.join("/")};const o=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;i.isAbsolute=e=>n.isString(e)&&o.test(e),i.isRelative=e=>n.isString(e)},{"./types":47}],49:[function(e,t,r){"use strict";const n=e("./graphTypes"),i=e("./types"),o=e("rdf-canonize").IdentifierIssuer,s=e("./JsonLdError"),a=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,l=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,u=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,c={accept:"application/ld+json, application/json"},f={};function p(e,t){if(i.isArray(t))for(let r=0;r<t.length;++r)t[r]=p(e,t[r]);else if(n.isList(t))t["@list"]=p(e,t["@list"]);else if(i.isObject(t)){n.isBlankNode(t)&&(t["@id"]=e.getId(t["@id"]));const r=Object.keys(t).sort();for(let n=0;n<r.length;++n){const i=r[n];"@id"!==i&&(t[i]=p(e,t[i]))}}return t}t.exports=f,f.IdentifierIssuer=o,f.REGEX_BCP47=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,f.REGEX_KEYWORD=/^@[a-zA-Z]+$/,f.clone=function(e){if(e&&"object"==typeof e){let t;if(i.isArray(e)){t=[];for(let r=0;r<e.length;++r)t[r]=f.clone(e[r])}else if(e instanceof Map){t=new Map;for(const[r,n]of e)t.set(r,f.clone(n))}else if(e instanceof Set){t=new Set;for(const r of e)t.add(f.clone(r))}else if(i.isObject(e)){t={};for(const r in e)t[r]=f.clone(e[r])}else t=e.toString();return t}return e},f.asArray=function(e){return Array.isArray(e)?e:[e]},f.buildHeaders=(e={})=>{if(Object.keys(e).some((e=>"accept"===e.toLowerCase())))throw new RangeError('Accept header may not be specified; only "'+c.accept+'" is supported.');return Object.assign({Accept:c.accept},e)},f.parseLinkHeader=e=>{const t={},r=e.match(a);for(let e=0;e<r.length;++e){let n=r[e].match(l);if(!n)continue;const i={target:n[1]},o=n[2];for(;n=u.exec(o);)i[n[1]]=void 0===n[2]?n[3]:n[2];const s=i.rel||"";Array.isArray(t[s])?t[s].push(i):t.hasOwnProperty(s)?t[s]=[t[s],i]:t[s]=i}return t},f.validateTypeValue=(e,t)=>{if(!(i.isString(e)||i.isArray(e)&&e.every((e=>i.isString(e))))){if(t&&i.isObject(e))switch(Object.keys(e).length){case 0:return;case 1:if("@default"in e&&f.asArray(e["@default"]).every((e=>i.isString(e))))return}throw new s('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}},f.hasProperty=(e,t)=>{if(e.hasOwnProperty(t)){const r=e[t];return!i.isArray(r)||r.length>0}return!1},f.hasValue=(e,t,r)=>{if(f.hasProperty(e,t)){let o=e[t];const s=n.isList(o);if(i.isArray(o)||s){s&&(o=o["@list"]);for(let e=0;e<o.length;++e)if(f.compareValues(r,o[e]))return!0}else if(!i.isArray(r))return f.compareValues(r,o)}return!1},f.addValue=(e,t,r,n)=>{if("propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1),"valueIsArray"in n||(n.valueIsArray=!1),"allowDuplicate"in n||(n.allowDuplicate=!0),"prependValue"in n||(n.prependValue=!1),n.valueIsArray)e[t]=r;else if(i.isArray(r)){0===r.length&&n.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]),n.prependValue&&(r=r.concat(e[t]),e[t]=[]);for(let i=0;i<r.length;++i)f.addValue(e,t,r[i],n)}else if(e.hasOwnProperty(t)){const o=!n.allowDuplicate&&f.hasValue(e,t,r);i.isArray(e[t])||o&&!n.propertyIsArray||(e[t]=[e[t]]),o||(n.prependValue?e[t].unshift(r):e[t].push(r))}else e[t]=n.propertyIsArray?[r]:r},f.getValues=(e,t)=>[].concat(e[t]||[]),f.removeProperty=(e,t)=>{delete e[t]},f.removeValue=(e,t,r,n)=>{"propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1);const i=f.getValues(e,t).filter((e=>!f.compareValues(e,r)));0===i.length?f.removeProperty(e,t):1!==i.length||n.propertyIsArray?e[t]=i:e[t]=i[0]},f.relabelBlankNodes=(e,t)=>p((t=t||{}).issuer||new o("_:b"),e),f.compareValues=(e,t)=>e===t||(!(!n.isValue(e)||!n.isValue(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(i.isObject(e)&&"@id"in e&&i.isObject(t)&&"@id"in t)&&e["@id"]===t["@id"]),f.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1},{"./JsonLdError":28,"./graphTypes":42,"./types":47,"rdf-canonize":64}],50:[function(e,t,r){"use strict";const n=e("yallist"),i=Symbol("max"),o=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),l=Symbol("maxAge"),u=Symbol("dispose"),c=Symbol("noDisposeOnSet"),f=Symbol("lruList"),p=Symbol("cache"),d=Symbol("updateAgeOnGet"),h=()=>1;const y=(e,t,r)=>{const n=e[p].get(t);if(n){const t=n.value;if(v(e,t)){if(b(e,n),!e[a])return}else r&&(e[d]&&(n.value.now=Date.now()),e[f].unshiftNode(n));return t.value}},v=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[l]&&r>e[l]},g=e=>{if(e[o]>e[i])for(let t=e[f].tail;e[o]>e[i]&&null!==t;){const r=t.prev;b(e,t),t=r}},b=(e,t)=>{if(t){const r=t.value;e[u]&&e[u](r.key,r.value),e[o]-=r.length,e[p].delete(r.key),e[f].removeNode(t)}};class m{constructor(e,t,r,n,i){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=i||0}}const x=(e,t,r,n)=>{let i=r.value;v(e,i)&&(b(e,r),e[a]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};t.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||h;if(this[s]="function"!=typeof t?h:t,this[a]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[u]=e.dispose,this[c]=e.noDisposeOnSet||!1,this[d]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,g(this)}get max(){return this[i]}set allowStale(e){this[a]=!!e}get allowStale(){return this[a]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,g(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=h),e!==this[s]&&(this[s]=e,this[o]=0,this[f].forEach((e=>{e.length=this[s](e.value,e.key),this[o]+=e.length}))),g(this)}get lengthCalculator(){return this[s]}get length(){return this[o]}get itemCount(){return this[f].length}rforEach(e,t){t=t||this;for(let r=this[f].tail;null!==r;){const n=r.prev;x(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[f].head;null!==r;){const n=r.next;x(this,e,r,t),r=n}}keys(){return this[f].toArray().map((e=>e.key))}values(){return this[f].toArray().map((e=>e.value))}reset(){this[u]&&this[f]&&this[f].length&&this[f].forEach((e=>this[u](e.key,e.value))),this[p]=new Map,this[f]=new n,this[o]=0}dump(){return this[f].map((e=>!v(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[f]}set(e,t,r){if((r=r||this[l])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,a=this[s](t,e);if(this[p].has(e)){if(a>this[i])return b(this,this[p].get(e)),!1;const s=this[p].get(e).value;return this[u]&&(this[c]||this[u](e,s.value)),s.now=n,s.maxAge=r,s.value=t,this[o]+=a-s.length,s.length=a,this.get(e),g(this),!0}const d=new m(e,t,a,n,r);return d.length>this[i]?(this[u]&&this[u](e,t),!1):(this[o]+=d.length,this[f].unshift(d),this[p].set(e,this[f].head),g(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!v(this,t)}get(e){return y(this,e,!0)}peek(e){return y(this,e,!1)}pop(){const e=this[f].tail;return e?(b(this,e),e.value):null}del(e){b(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const e=i-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[p].forEach(((e,t)=>y(this,t,!1)))}}},{yallist:121}],51:[function(e,t,r){var n=e;e=function(){};r=t.exports={Lexer:e("./lib/N3Lexer"),Parser:e("./lib/N3Parser"),Writer:e("./lib/N3Writer"),Store:e("./lib/N3Store"),StreamParser:e("./lib/N3StreamParser"),StreamWriter:e("./lib/N3StreamWriter"),Util:e("./lib/N3Util")};Object.keys(r).forEach((function(e){Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get:function(){return delete r[e],r[e]=n("./lib/N3"+e)}})}))},{"./lib/N3Lexer":52,"./lib/N3Parser":53,"./lib/N3Store":54,"./lib/N3StreamParser":55,"./lib/N3StreamWriter":56,"./lib/N3Util":57,"./lib/N3Writer":58}],52:[function(e,t,r){(function(e){(function(){var r=String.fromCharCode,n="function"==typeof e?e:function(e){setTimeout(e,0)},i=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,o={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},s=/[\x00-\x20<>\\"\{\}\|\^\`]/;function a(e){if(!(this instanceof a))return new a(e);if((e=e||{}).lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var t=this;this._tokenize=this.tokenize,this.tokenize=function(e,r){this._tokenize(e,(function(e,n){!e&&/^(?:IRI|blank|literal|langcode|typeIRI|\.|eof)$/.test(n.type)?r&&r(e,n):r&&r(e||t._syntaxError(n.type,r=null))}))}}this._n3Mode=!1!==e.n3,this._comments=!!e.comments}a.prototype={_iri:/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,_unescapedString:/^"[^"\\\r\n]+"/,_singleQuotedString:/^"(?:[^"\\\r\n]|\\.)*"(?=[^"])|^'(?:[^'\\\r\n]|\\.)*'(?=[^'])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<]))/,_variable:/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<]))/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/i,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_comment:/#([^\n\r]*)/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(e,t){for(var r=this._input,n=this._comments;;){for(var i,o;i=this._newline.exec(r);)n&&(o=this._comment.exec(i[0]))&&e(null,{line:this._line,type:"comment",value:o[1],prefix:""}),r=r.substr(i[0].length,r.length),this._line++;if((i=this._whitespace.exec(r))&&(r=r.substr(i[0].length,r.length)),this._endOfFile.test(r))return t&&(n&&(o=this._comment.exec(r))&&e(null,{line:this._line,type:"comment",value:o[1],prefix:""}),e(r=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=r;var a,l=this._line,u="",c="",f="",p=r[0],d=null,h=0,y=!1;switch(p){case"^":if(r.length<3)break;if("^"!==r[1]){this._n3Mode&&(h=1,u="^");break}if(this._previousMarker="^^","<"!==(r=r.substr(2))[0]){y=!0;break}case"<":if(d=this._unescapedIri.exec(r))u="IRI",c=d[1];else if(d=this._iri.exec(r)){if(null===(a=this._unescape(d[1]))||s.test(a))return g(this);u="IRI",c=a}else this._n3Mode&&r.length>1&&"="===r[1]&&(u="inverse",h=2,c="http://www.w3.org/2000/10/swap/log#implies");break;case"_":((d=this._blank.exec(r))||t&&(d=this._blank.exec(r+" ")))&&(u="blank",f="_",c=d[1]);break;case'"':case"'":if(d=this._unescapedString.exec(r))u="literal",c=d[0];else if(d=this._singleQuotedString.exec(r)){if(null===(a=this._unescape(d[0])))return g(this);u="literal",c=a.replace(/^'|'$/g,'"')}else if(d=this._tripleQuotedString.exec(r)){if(a=d[1]||d[2],this._line+=a.split(/\r\n|\r|\n/).length-1,null===(a=this._unescape(a)))return g(this);u="literal",c=a.replace(/^'|'$/g,'"')}break;case"?":this._n3Mode&&(d=this._variable.exec(r))&&(u="var",c=d[0]);break;case"@":"literal"===this._previousMarker&&(d=this._langcode.exec(r))?(u="langcode",c=d[1]):(d=this._keyword.exec(r))&&(u=d[0]);break;case".":if(1===r.length?t:r[1]<"0"||r[1]>"9"){u=".",h=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(d=this._number.exec(r)||t&&(d=this._number.exec(r+" ")))&&(u="literal",c='"'+d[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(d[1]?"double":/^[+\-]?\d+$/.test(d[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(d=this._sparqlKeyword.exec(r))?u=d[0].toUpperCase():y=!0;break;case"f":case"t":(d=this._boolean.exec(r))?(u="literal",c='"'+d[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):y=!0;break;case"a":(d=this._shortPredicates.exec(r))?(u="abbreviation",c="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):y=!0;break;case"=":this._n3Mode&&r.length>1&&(u="abbreviation",">"!==r[1]?(h=1,c="http://www.w3.org/2002/07/owl#sameAs"):(h=2,c="http://www.w3.org/2000/10/swap/log#implies"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":h=1,u=p;break;default:y=!0}if(y&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(d=this._prefix.exec(r))?((d=this._prefixed.exec(r))||t&&(d=this._prefixed.exec(r+" ")))&&(u="prefixed",f=d[1]||"",c=this._unescape(d[2])):(u="prefix",c=d[1]||"")),"^^"===this._previousMarker)switch(u){case"prefixed":u="type";break;case"IRI":u="typeIRI";break;default:u=""}if(!u)return t||!/^'''|^"""/.test(r)&&/\n|\r/.test(r)?g(this):this._input=r;var v={line:l,type:u,value:c,prefix:f};e(null,v),this.previousToken=v,this._previousMarker=u,r=r.substr(h||d[0].length,r.length)}function g(t){e(t._syntaxError(/^\S*/.exec(r)[0]))}},_unescape:function(e){try{return e.replace(i,(function(e,t,n,i){var s;if(t){if(s=parseInt(t,16),isNaN(s))throw new Error;return r(s)}if(n){if(s=parseInt(n,16),isNaN(s))throw new Error;return s<=65535?r(s):r(55296+(s-=65536)/1024,56320+(1023&s))}var a=o[i];if(!a)throw new Error;return a}))}catch(e){return null}},_syntaxError:function(e){this._input=null;var t=new Error('Unexpected "'+e+'" on line '+this._line+".");return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t},tokenize:function(e,t){var r=this;if(this._line=1,"string"==typeof e){if(this._input=e,"function"!=typeof t){var i,o=[];if(this._tokenizeToEnd((function(e,t){e?i=e:o.push(t)}),!0),i)throw i;return o}n((function(){r._tokenizeToEnd(t,!0)}))}else this._input="","function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",(function(e){null!==r._input&&(r._input+=e,r._tokenizeToEnd(t,!1))})),e.on("end",(function(){null!==r._input&&r._tokenizeToEnd(t,!0)})),e.on("error",t)}},t.exports=a}).call(this)}).call(this,e("timers").setImmediate)},{timers:111}],53:[function(e,t,r){var n=e("./N3Lexer"),i="http://www.w3.org/1999/02/22-rdf-syntax-ns#",o=i+"nil",s=i+"first",a=i+"rest",l="urn:n3:quantifiers",u=/^[a-z][a-z0-9+.-]*:/i,c=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,f=/(?:^|\/)\.\.?(?:$|[\/#?])/,p=0,d=0;function h(e){if(!(this instanceof h))return new h(e);this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.documentIRI);var t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",r="turtle"===t,i="trig"===t,o=/triple/.test(t),s=/quad/.test(t),a=this._n3Mode=/n3/.test(t),l=o||s;(this._supportsNamedGraphs=!(r||a))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||i||o||a),l&&(this._base="",this._resolveIRI=function(e){return this._error("Disallowed relative IRI",e),this._callback=y,this._subject=null}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":"_:"+e.blankNodePrefix.replace(/^_:/,""),this._lexer=e.lexer||new n({lineMode:l,n3:a}),this._explicitQuantifiers=!!e.explicitQuantifiers}function y(){}h._resetBlankNodeIds=function(){p=d=0},h.prototype={_setBase:function(e){if(e){var t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(c),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base=null},_saveContext:function(e,t,r,n,i){var o=this._n3Mode;this._contextStack.push({subject:r,predicate:n,object:i,graph:t,type:e,inverse:!!o&&this._inversePredicate,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph+".",this._quantified=Object.create(this._quantified))},_restoreContext:function(){var e=this._contextStack.pop(),t=this._n3Mode;this._subject=e.subject,this._predicate=e.predicate,this._object=e.object,this._graph=e.graph,t&&(this._inversePredicate=e.inverse,this._prefixes._=e.blankPrefix,this._quantified=e.quantified)},_readInTopContext:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}},_readEntity:function(e,t){var r;switch(e.type){case"IRI":case"typeIRI":r=null===this._base||u.test(e.value)?e.value:this._resolveIRI(e);break;case"type":case"blank":case"prefixed":var n=this._prefixes[e.prefix];if(void 0===n)return this._error('Undefined prefix "'+e.prefix+':"',e);r=n+e.value;break;case"var":return e.value;default:return this._error("Expected entity but got "+e.type,e)}return!t&&this._n3Mode&&r in this._quantified&&(r=this._quantified[r]),r},_readSubject:function(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject="_:b"+d++,null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,o,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph="_:b"+d++,null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forSome",this._quantifiedPrefix="_:b",this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forAll",this._quantifiedPrefix="?b-",this._readQuantifierList):this._error('Unexpected "@forAll"',e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph},_readPredicate:function(e){var t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=e.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject},_readObject:function(e){switch(e.type){case"literal":return this._object=e.value,this._readDataTypeOrLang;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject="_:b"+d++),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,o),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph="_:b"+d++),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()},_readPredicateOrNamedGraph:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)},_readGraph:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))},_readBlankNodeTail:function(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph);var t=null===this._predicate;return this._restoreContext(),null===this._object?t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()},_readPredicateAfterBlank:function(e){return"."!==e.type||this._contextStack.length?this._readPredicate(e):(this._subject=null,this._readPunctuation(e))},_readListItem:function(e){var t=null,r=null,n=this._subject,i=this._contextStack,l=i[i.length-1],u=this._readListItem,c=!0;switch(e.type){case"[":this._saveContext("blank",this._graph,r="_:b"+d++,s,this._subject=t="_:b"+d++),u=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,r="_:b"+d++,s,o),this._subject=null;break;case")":if(this._restoreContext(),0!==i.length&&"list"===i[i.length-1].type&&this._triple(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(u=this._readPredicate,this._subject===o)return u}else if(u=this._getContextEndReader(),this._object===o)return u;r=o;break;case"literal":t=e.value,c=!1,u=this._readListItemDataTypeOrLang;break;default:if(void 0===(t=this._readEntity(e)))return}if(null===r&&(this._subject=r="_:b"+d++),null===n?null===l.predicate?l.subject=r:l.object=r:this._triple(n,a,r,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,r,s,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);c?this._triple(r,s,t,this._graph):this._object=t}return u},_readDataTypeOrLang:function(e){return this._completeLiteral(e,!1)},_readListItemDataTypeOrLang:function(e){return this._completeLiteral(e,!0)},_completeLiteral:function(e,t){var r=!1;switch(e.type){case"type":case"typeIRI":var n=this._readEntity(e);if(void 0===n)return;r=!0,this._object+="^^"+n;break;case"langcode":r=!0,this._object+="@"+e.value.toLowerCase()}return t&&this._triple(this._subject,s,this._object,this._graph),r?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(e))},_readFormulaTail:function(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())},_readPunctuation:function(e){var t,r=this._subject,n=this._graph,i=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error('Expected punctuation to follow "'+this._object+'"',e)}if(null!==r){var o=this._predicate,s=this._object;i?this._triple(s,o,r,n):this._triple(r,o,s,n)}return t},_readBlankNodePunctuation:function(e){var t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return this._triple(this._subject,this._predicate,this._object,this._graph),t},_readQuadPunctuation:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)},_readPrefixIRI:function(e){if("IRI"!==e.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',e);var t=this._readEntity(e);return this._prefixes[this._prefix]=t,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation},_readBaseIRI:function(e){return"IRI"!==e.type?this._error("Expected IRI to follow base declaration",e):(this._setBase(null===this._base||u.test(e.value)?e.value:this._resolveIRI(e)),this._readDeclarationPunctuation)},_readNamedGraphLabel:function(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}},_readNamedGraphBlankLabel:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject="_:b"+d++,this._readGraph)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_readQuantifierList:function(e){var t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error("Unexpected "+e.type,e)}return this._explicitQuantifiers?(null===this._subject?this._triple(this._graph||"",this._predicate,this._subject="_:b"+d++,l):this._triple(this._subject,a,this._subject="_:b"+d++,l),this._triple(this._subject,s,t,l)):this._quantified[t]=this._quantifiedPrefix+d++,this._readQuantifierPunctuation},_readQuantifierPunctuation:function(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._triple(this._subject,a,o,l),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))},_getPathReader:function(e){return this._afterPath=e,this._readPath},_readPath:function(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:var t=this._contextStack,r=t.length&&t[t.length-1];if(r&&"item"===r.type){var n=this._subject;this._restoreContext(),this._triple(this._subject,s,n,this._graph)}return this._afterPath(e)}},_readForwardPath:function(e){var t,r,n="_:b"+d++;if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=n):(t=this._object,this._object=n),this._triple(t,r,n,this._graph),this._readPath},_readBackwardPath:function(e){var t,r,n="_:b"+d++;if(void 0!==(t=this._readEntity(e)))return null===this._predicate?(r=this._subject,this._subject=n):(r=this._object,this._object=n),this._triple(n,t,r,this._graph),this._readPath},_getContextEndReader:function(){var e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail}},_triple:function(e,t,r,n){this._callback(null,{subject:e,predicate:t,object:r,graph:n||""})},_error:function(e,t){var r=new Error(e+" on line "+t.line+".");r.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(r),this._callback=y},_resolveIRI:function(e){var t=e.value;switch(t[0]){case void 0:return this._base;case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return("/"===t[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return this._removeDotSegments(this._basePath+t)}},_removeDotSegments:function(e){if(!f.test(e))return e;for(var t="",r=e.length,n=-1,i=-1,o=0,s="/";n<r;){switch(s){case":":if(i<0&&"/"===e[++n]&&"/"===e[++n])for(;(i=n+1)<r&&"/"!==e[i];)n=i;break;case"?":case"#":n=r;break;case"/":if("."===e[n+1])switch(s=e[1+ ++n]){case"/":t+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return t+e.substring(o,n)+e.substr(n+1);case".":if(void 0===(s=e[1+ ++n])||"/"===s||"?"===s||"#"===s){if((o=(t+=e.substring(o,n-2)).lastIndexOf("/"))>=i&&(t=t.substr(0,o)),"/"!==s)return t+"/"+e.substr(n+1);o=n+1}}}s=e[++n]}return t+e.substring(o)},parse:function(e,t,r){var n=this;if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+p+++"_",this._prefixCallback=r||y,this._inversePredicate=!1,this._quantified=Object.create(null),!t){var i,o=[];if(this._callback=function(e,t){e?i=e:t&&o.push(t)},this._lexer.tokenize(e).every((function(e){return n._readCallback=n._readCallback(e)})),i)throw i;return o}this._callback=t,this._lexer.tokenize(e,(function(e,t){null!==e?(n._callback(e),n._callback=y):n._readCallback&&(n._readCallback=n._readCallback(t))}))}},t.exports=h},{"./N3Lexer":52}],54:[function(e,t,r){var n=e("./N3Util").expandPrefixedName;function i(e,t){if(!(this instanceof i))return new i(e,t);this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._prefixes=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),e&&this.addTriples(e)}function o(e){return"string"==typeof e||e instanceof String}i.prototype={get size(){var e=this._size;if(null!==e)return e;e=0;var t,r,n=this._graphs;for(var i in n)for(var o in t=n[i].subjects)for(var s in r=t[o])e+=Object.keys(r[s]).length;return this._size=e},_addToIndex:function(e,t,r,n){var i=e[t]||(e[t]={}),o=i[r]||(i[r]={}),s=n in o;return s||(o[n]=null),!s},_removeFromIndex:function(e,t,r,n){var i,o=e[t],s=o[r];for(i in delete s[n],s)return;for(i in delete o[r],o)return;delete e[t]},_findInIndex:function(e,t,r,n,i,o,s,a,l,u){var c,f,p,d=!t+!r+!n>1?Object.keys(this._ids):this._entities;for(var h in t&&((c=e,e={})[t]=c[t]),e){var y=d[h];if(f=e[h])for(var v in r&&((c=f,f={})[r]=c[r]),f){var g=d[v];if(p=f[v])for(var b=(n?n in p?[n]:[]:Object.keys(p)),m=b.length-1;m>=0;m--){var x={subject:"",predicate:"",object:"",graph:a};if(x[i]=y,x[o]=g,x[s]=d[b[m]],u)u.push(x);else if(l(x))return!0}}}return u},_loop:function(e,t){for(var r in e)t(r)},_loopByKey0:function(e,t,r){var n,i;if(n=e[t])for(i in n)r(i)},_loopByKey1:function(e,t,r){var n;for(n in e)e[n][t]&&r(n)},_loopBy2Keys:function(e,t,r,n){var i,o,s;if((i=e[t])&&(o=i[r]))for(s in o)n(s)},_countInIndex:function(e,t,r,n){var i,o,s,a=0;for(var l in t&&((i=e,e={})[t]=i[t]),e)if(o=e[l])for(var u in r&&((i=o,o={})[r]=i[r]),o)(s=o[u])&&(n?n in s&&a++:a+=Object.keys(s).length);return a},_getGraphs:function(e){if(!o(e))return this._graphs;var t={};return t[e]=this._graphs[e],t},_uniqueEntities:function(e){var t=Object.create(null),r=this._entities;return function(n){n in t||(t[n]=!0,e(r[n]))}},addTriple:function(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),n=n||"";var i=this._graphs[n];i||(i=this._graphs[n]={subjects:{},predicates:{},objects:{}},Object.freeze(i));var o=this._ids,s=this._entities;e=o[e]||(o[s[++this._id]=e]=this._id),t=o[t]||(o[s[++this._id]=t]=this._id),r=o[r]||(o[s[++this._id]=r]=this._id);var a=this._addToIndex(i.subjects,e,t,r);return this._addToIndex(i.predicates,t,r,e),this._addToIndex(i.objects,r,e,t),this._size=null,a},addTriples:function(e){for(var t=e.length-1;t>=0;t--)this.addTriple(e[t])},addPrefix:function(e,t){this._prefixes[e]=t},addPrefixes:function(e){for(var t in e)this.addPrefix(t,e[t])},removeTriple:function(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),n=n||"";var i,o,s,a=this._ids,l=this._graphs;if(!((e=a[e])&&(t=a[t])&&(r=a[r])&&(i=l[n])&&(o=i.subjects[e])&&(s=o[t])&&r in s))return!1;for(e in this._removeFromIndex(i.subjects,e,t,r),this._removeFromIndex(i.predicates,t,r,e),this._removeFromIndex(i.objects,r,e,t),null!==this._size&&this._size--,i.subjects)return!0;return delete l[n],!0},removeTriples:function(e){for(var t=e.length-1;t>=0;t--)this.removeTriple(e[t])},getTriples:function(e,t,r,i){var o=this._prefixes;return this.getTriplesByIRI(n(e,o),n(t,o),n(r,o),n(i,o))},getTriplesByIRI:function(e,t,r,n){var i,s,a,l,u=[],c=this._getGraphs(n),f=this._ids;if(o(e)&&!(s=f[e])||o(t)&&!(a=f[t])||o(r)&&!(l=f[r]))return u;for(var p in c)(i=c[p])&&(s?l?this._findInIndex(i.objects,l,s,a,"object","subject","predicate",p,null,u):this._findInIndex(i.subjects,s,a,null,"subject","predicate","object",p,null,u):a?this._findInIndex(i.predicates,a,l,null,"predicate","object","subject",p,null,u):l?this._findInIndex(i.objects,l,null,null,"object","subject","predicate",p,null,u):this._findInIndex(i.subjects,null,null,null,"subject","predicate","object",p,null,u));return u},countTriples:function(e,t,r,i){var o=this._prefixes;return this.countTriplesByIRI(n(e,o),n(t,o),n(r,o),n(i,o))},countTriplesByIRI:function(e,t,r,n){var i,s,a,l,u=0,c=this._getGraphs(n),f=this._ids;if(o(e)&&!(s=f[e])||o(t)&&!(a=f[t])||o(r)&&!(l=f[r]))return 0;for(var p in c)(i=c[p])&&(u+=e?r?this._countInIndex(i.objects,l,s,a):this._countInIndex(i.subjects,s,a,l):t?this._countInIndex(i.predicates,a,l,s):this._countInIndex(i.objects,l,s,a));return u},forEach:function(e,t,r,i,o){var s=this._prefixes;this.forEachByIRI(e,n(t,s),n(r,s),n(i,s),n(o,s))},forEachByIRI:function(e,t,r,n,i){this.someByIRI((function(t){return e(t),!1}),t,r,n,i)},every:function(e,t,r,i,o){var s=this._prefixes;return this.everyByIRI(e,n(t,s),n(r,s),n(i,s),n(o,s))},everyByIRI:function(e,t,r,n,i){var o=!1,s=!this.someByIRI((function(t){return o=!0,!e(t)}),t,r,n,i);return o&&s},some:function(e,t,r,i,o){var s=this._prefixes;return this.someByIRI(e,n(t,s),n(r,s),n(i,s),n(o,s))},someByIRI:function(e,t,r,n,i){var s,a,l,u,c=this._getGraphs(i),f=this._ids;if(o(t)&&!(a=f[t])||o(r)&&!(l=f[r])||o(n)&&!(u=f[n]))return!1;for(var p in c)if(s=c[p])if(a){if(u){if(this._findInIndex(s.objects,u,a,l,"object","subject","predicate",p,e,null))return!0}else if(this._findInIndex(s.subjects,a,l,null,"subject","predicate","object",p,e,null))return!0}else if(l){if(this._findInIndex(s.predicates,l,u,null,"predicate","object","subject",p,e,null))return!0}else if(u){if(this._findInIndex(s.objects,u,null,null,"object","subject","predicate",p,e,null))return!0}else if(this._findInIndex(s.subjects,null,null,null,"subject","predicate","object",p,e,null))return!0;return!1},getSubjects:function(e,t,r){var i=this._prefixes;return this.getSubjectsByIRI(n(e,i),n(t,i),n(r,i))},getSubjectsByIRI:function(e,t,r){var n=[];return this.forSubjectsByIRI((function(e){n.push(e)}),e,t,r),n},forSubjects:function(e,t,r,i){var o=this._prefixes;this.forSubjectsByIRI(e,n(t,o),n(r,o),n(i,o))},forSubjectsByIRI:function(e,t,r,n){var i,s,a,l=this._ids,u=this._getGraphs(n);if(e=this._uniqueEntities(e),!(o(t)&&!(s=l[t])||o(r)&&!(a=l[r])))for(n in u)(i=u[n])&&(s?a?this._loopBy2Keys(i.predicates,s,a,e):this._loopByKey1(i.subjects,s,e):a?this._loopByKey0(i.objects,a,e):this._loop(i.subjects,e))},getPredicates:function(e,t,r){var i=this._prefixes;return this.getPredicatesByIRI(n(e,i),n(t,i),n(r,i))},getPredicatesByIRI:function(e,t,r){var n=[];return this.forPredicatesByIRI((function(e){n.push(e)}),e,t,r),n},forPredicates:function(e,t,r,i){var o=this._prefixes;this.forPredicatesByIRI(e,n(t,o),n(r,o),n(i,o))},forPredicatesByIRI:function(e,t,r,n){var i,s,a,l=this._ids,u=this._getGraphs(n);if(e=this._uniqueEntities(e),!(o(t)&&!(s=l[t])||o(r)&&!(a=l[r])))for(n in u)(i=u[n])&&(s?a?this._loopBy2Keys(i.objects,a,s,e):this._loopByKey0(i.subjects,s,e):a?this._loopByKey1(i.predicates,a,e):this._loop(i.predicates,e))},getObjects:function(e,t,r){var i=this._prefixes;return this.getObjectsByIRI(n(e,i),n(t,i),n(r,i))},getObjectsByIRI:function(e,t,r){var n=[];return this.forObjectsByIRI((function(e){n.push(e)}),e,t,r),n},forObjects:function(e,t,r,i){var o=this._prefixes;this.forObjectsByIRI(e,n(t,o),n(r,o),n(i,o))},forObjectsByIRI:function(e,t,r,n){var i,s,a,l=this._ids,u=this._getGraphs(n);if(e=this._uniqueEntities(e),!(o(t)&&!(s=l[t])||o(r)&&!(a=l[r])))for(n in u)(i=u[n])&&(s?a?this._loopBy2Keys(i.subjects,s,a,e):this._loopByKey1(i.objects,s,e):a?this._loopByKey0(i.predicates,a,e):this._loop(i.objects,e))},getGraphs:function(e,t,r){var i=this._prefixes;return this.getGraphsByIRI(n(e,i),n(t,i),n(r,i))},getGraphsByIRI:function(e,t,r){var n=[];return this.forGraphsByIRI((function(e){n.push(e)}),e,t,r),n},forGraphs:function(e,t,r,i){var o=this._prefixes;this.forGraphsByIRI(e,n(t,o),n(r,o),n(i,o))},forGraphsByIRI:function(e,t,r,n){for(var i in this._graphs)this.someByIRI((function(t){return e(t.graph),!0}),t,r,n,i)},createBlankNode:function(e){var t,r;if(e)for(t=e="_:"+e,r=1;this._ids[t];)t=e+r++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,t}},t.exports=i},{"./N3Util":57}],55:[function(e,t,r){var n=e("stream").Transform,i=e("util"),o=e("./N3Parser.js");function s(e){if(!(this instanceof s))return new s(e);n.call(this,{decodeStrings:!0}),this._readableState.objectMode=!0;var t,r,i=this;new o(e).parse({on:function(e,n){switch(e){case"data":t=n;break;case"end":r=n}}},(function(e,t){e&&i.emit("error",e)||t&&i.push(t)}),(function(e,t){i.emit("prefix",e,t)})),this._transform=function(e,r,n){t(e),n()},this._flush=function(e){r(),e()}}i.inherits(s,n),t.exports=s},{"./N3Parser.js":53,stream:76,util:117}],56:[function(e,t,r){var n=e("stream").Transform,i=e("util"),o=e("./N3Writer.js");function s(e){if(!(this instanceof s))return new s(e);n.call(this,{encoding:"utf8"}),this._writableState.objectMode=!0;var t=this,r=new o({write:function(e,r,n){t.push(e),n&&n()},end:function(e){t.push(null),e&&e()}},e);this._transform=function(e,t,n){r.addTriple(e,n)},this._flush=function(e){r.end(e)}}i.inherits(s,n),t.exports=s},{"./N3Writer.js":58,stream:76,util:117}],57:[function(e,t,r){var n="http://www.w3.org/2001/XMLSchema#",i=n+"string",o=n+"integer",s=n+"double",a=n+"boolean",l={isIRI:function(e){if("string"!=typeof e)return!1;if(0===e.length)return!0;var t=e[0];return'"'!==t&&"_"!==t},isLiteral:function(e){return"string"==typeof e&&'"'===e[0]},isBlank:function(e){return"string"==typeof e&&"_:"===e.substr(0,2)},isDefaultGraph:function(e){return!e},inDefaultGraph:function(e){return!e.graph},getLiteralValue:function(e){var t=/^"([^]*)"/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]},getLiteralType:function(e){var t=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]||(t[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":i)},getLiteralLanguage:function(e){var t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""},isPrefixedName:function(e){return"string"==typeof e&&/^[^:\/"']*:[^:\/"']+$/.test(e)},expandPrefixedName:function(e,t){var r,n,i,o=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(e);return o&&(n=t[r=o[1]],i=o.index),void 0===n?e:0===i?n+e.substr(r.length+1):e.substr(0,i+3)+n+e.substr(i+r.length+4)},createIRI:function(e){return e&&'"'===e[0]?l.getLiteralValue(e):e},createLiteral:function(e,t){if(!t)switch(typeof e){case"boolean":t=a;break;case"number":isFinite(e)?t=e%1==0?o:s:(t=s,isNaN(e)||(e=e>0?"INF":"-INF"));break;default:return'"'+e+'"'}return'"'+e+(/^[a-z]+(-[a-z0-9]+)*$/i.test(t)?'"@'+t.toLowerCase():'"^^'+t)},prefix:function(e){return l.prefixes({"":e})("")},prefixes:function(e){var t=Object.create(null);for(var r in e)n(r,e[r]);function n(e,r){if(r||!(e in t)){var n=Object.create(null);r=r||"",t[e]=function(e){return n[e]||(n[e]=r+e)}}return t[e]}return n}};t.exports=l},{}],58:[function(e,t,r){var n=/^"([^]*)"(?:\^\^(.+)|@([a-z]+(?:-[a-z0-9]+)*))?$/i,i=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,o=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,s={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};function a(e,t){if(!(this instanceof a))return new a(e,t);if(e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var r="";this._outputStream={write:function(e,t,n){r+=e,n&&n()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}function l(e){var t=s[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}a.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeTriple:function(e,t,r,n,i){try{this._graph!==n&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(n?this._encodeIriOrBlankNode(n)+" {\n":"")),this._subject=null,this._graph="["!==n[0]?n:"]"),this._subject===e?this._predicate===t?this._write(", "+this._encodeObject(r),i):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),i):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),i)}catch(e){i&&i(e)}},_writeTripleLine:function(e,t,r,n,i){delete this._prefixMatch;try{this._write(this.tripleToString(e,t,r,n),i)}catch(e){i&&i(e)}},tripleToString:function(e,t,r,n){return this._encodeIriOrBlankNode(e)+" "+this._encodeIriOrBlankNode(t)+" "+this._encodeObject(r)+(n?" "+this._encodeIriOrBlankNode(n)+".\n":".\n")},triplesToString:function(e){return e.map((function(e){return this.tripleToString(e.subject,e.predicate,e.object,e.graph)}),this).join("")},_encodeIriOrBlankNode:function(e){var t=e[0];if("["===t||"("===t||"_"===t&&":"===e[1])return e;i.test(e)&&(e=e.replace(o,l));var r=this._prefixRegex.exec(e);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:e:"<"+e+">"},_encodeLiteral:function(e,t,r){return i.test(e)&&(e=e.replace(o,l)),r?'"'+e+'"@'+r:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeSubject:function(e){if('"'===e[0])throw new Error("A literal as subject is not allowed: "+e);return"["===e[0]&&(this._subject="]"),this._encodeIriOrBlankNode(e)},_encodePredicate:function(e){if('"'===e[0])throw new Error("A literal as predicate is not allowed: "+e);return"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?"a":this._encodeIriOrBlankNode(e)},_encodeObject:function(e){if('"'!==e[0])return this._encodeIriOrBlankNode(e);var t=n.exec(e);if(!t)throw new Error("Invalid literal: "+e);return this._encodeLiteral(t[1],t[2],t[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(e,t,r,n,i){void 0===r?this._writeTriple(e.subject,e.predicate,e.object,e.graph||"",t):"string"!=typeof n?this._writeTriple(e,t,r,"",n):this._writeTriple(e,t,r,n,i)},addTriples:function(e){for(var t=0;t<e.length;t++)this.addTriple(e[t])},addPrefix:function(e,t,r){var n={};n[e]=t,this.addPrefixes(n,r)},addPrefixes:function(e,t){var r=this._prefixIRIs,n=!1;for(var i in e){var o=e[i];/[#\/]$/.test(o)&&r[o]!==(i+=":")&&(n=!0,r[o]=i,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+i+" <"+o+">.\n"))}if(n){var s="",a="";for(var l in r)s+=s?"|"+l:l,a+=(a?"|":"")+r[l];s=s.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+a+")[^/]*$|^("+s+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(n?"\n":"",t)},blank:function(e,t){var r,n,i=e;switch(void 0===e?i=[]:"string"==typeof e?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),n=i.length){case 0:return"[]";case 1:if("["!==(r=i[0]).object[0])return"[ "+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object)+" ]";default:for(var o="[",s=0;s<n;s++)(r=i[s]).predicate===e?o+=", "+this._encodeObject(r.object):(o+=(s?";\n  ":"\n  ")+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object),e=r.predicate);return o+"\n]"}},list:function(e){for(var t=e&&e.length||0,r=new Array(t),n=0;n<t;n++)r[n]=this._encodeObject(e[n]);return"("+r.join(" ")+")"},_prefixRegex:/$0^/,end:function(e){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var t=e&&function(r,n){t=null,e(r,n)};if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}},t.exports=a},{}],59:[function(e,t,r){var n,i,o=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var u,c=[],f=!1,p=-1;function d(){f&&u&&(f=!1,u.length?c=u.concat(c):p=-1,c.length&&h())}function h(){if(!f){var e=l(d);f=!0;for(var t=c.length;t;){for(u=c,c=[];++p<t;)u&&u[p].run();p=-1,t=c.length}u=null,f=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function y(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new y(e,t)),1!==c.length||f||l(h)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],60:[function(e,t,r){(function(e){(function(){!function(n){var i="object"==typeof r&&r&&!r.nodeType&&r,o="object"==typeof t&&t&&!t.nodeType&&t,s="object"==typeof e&&e;s.global!==s&&s.window!==s&&s.self!==s||(n=s);var a,l,u=2147483647,c=36,f=/^xn--/,p=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=Math.floor,v=String.fromCharCode;function g(e){throw new RangeError(h[e])}function b(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function m(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+b((e=e.replace(d,".")).split("."),t).join(".")}function x(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function _(e){return b(e,(function(e){var t="";return e>65535&&(t+=v((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=v(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function k(e,t,r){var n=0;for(e=r?y(e/700):e>>1,e+=y(e/t);e>455;n+=c)e=y(e/35);return y(n+36*e/(e+38))}function E(e){var t,r,n,i,o,s,a,l,f,p,d,h=[],v=e.length,b=0,m=128,x=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&g("not-basic"),h.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<v;){for(o=b,s=1,a=c;i>=v&&g("invalid-input"),((l=(d=e.charCodeAt(i++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:c)>=c||l>y((u-b)/s))&&g("overflow"),b+=l*s,!(l<(f=a<=x?1:a>=x+26?26:a-x));a+=c)s>y(u/(p=c-f))&&g("overflow"),s*=p;x=k(b-o,t=h.length+1,0==o),y(b/t)>u-m&&g("overflow"),m+=y(b/t),b%=t,h.splice(b++,0,m)}return _(h)}function A(e){var t,r,n,i,o,s,a,l,f,p,d,h,b,m,_,E=[];for(h=(e=x(e)).length,t=128,r=0,o=72,s=0;s<h;++s)(d=e[s])<128&&E.push(v(d));for(n=i=E.length,i&&E.push("-");n<h;){for(a=u,s=0;s<h;++s)(d=e[s])>=t&&d<a&&(a=d);for(a-t>y((u-r)/(b=n+1))&&g("overflow"),r+=(a-t)*b,t=a,s=0;s<h;++s)if((d=e[s])<t&&++r>u&&g("overflow"),d==t){for(l=r,f=c;!(l<(p=f<=o?1:f>=o+26?26:f-o));f+=c)_=l-p,m=c-p,E.push(v(w(p+_%m,0))),l=y(_/m);E.push(v(w(l,0))),o=k(r,b,n==i),r=0,++n}++r,++t}return E.join("")}if(a={version:"1.4.1",ucs2:{decode:x,encode:_},decode:E,encode:A,toASCII:function(e){return m(e,(function(e){return p.test(e)?"xn--"+A(e):e}))},toUnicode:function(e){return m(e,(function(e){return f.test(e)?E(e.slice(4).toLowerCase()):e}))}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",(function(){return a}));else if(i&&o)if(t.exports==i)o.exports=a;else for(l in a)a.hasOwnProperty(l)&&(i[l]=a[l]);else n.punycode=a}(this)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],61:[function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,o){t=t||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var u=e.length;l>0&&u>l&&(u=l);for(var c=0;c<u;++c){var f,p,d,h,y=e[c].replace(a,"%20"),v=y.indexOf(r);v>=0?(f=y.substr(0,v),p=y.substr(v+1)):(f=y,p=""),d=decodeURIComponent(f),h=decodeURIComponent(p),n(s,d)?i(s[d])?s[d].push(h):s[d]=[s[d],h]:s[d]=h}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],62:[function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,a){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?o(s(e),(function(s){var a=encodeURIComponent(n(s))+r;return i(e[s])?o(e[s],(function(e){return a+encodeURIComponent(n(e))})).join(t):a+encodeURIComponent(n(e[s]))})).join(t):a?encodeURIComponent(n(a))+r+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],63:[function(e,t,r){"use strict";r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":61,"./encode":62}],64:[function(e,t,r){t.exports=e("./lib")},{"./lib":73}],65:[function(e,t,r){"use strict";t.exports=class e{constructor(e,t=new Map,r=0){this.prefix=e,this._existing=t,this.counter=r}clone(){const{prefix:t,_existing:r,counter:n}=this;return new e(t,new Map(r),n)}getId(e){const t=e&&this._existing.get(e);if(t)return t;const r=this.prefix+this.counter;return this.counter++,e&&this._existing.set(e,r),r}hasId(e){return this._existing.has(e)}getOldIds(){return[...this._existing.keys()]}}},{}],66:[function(e,t,r){
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */
"use strict";e("setimmediate");const n=self.crypto||self.msCrypto;t.exports=class{constructor(e){if(!n||!n.subtle)throw new Error("crypto.subtle not found.");if("sha256"===e)this.algorithm={name:"SHA-256"};else{if("sha1"!==e)throw new Error(`Unsupported algorithm "${e}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(e){this._content+=e}async digest(){const e=(new TextEncoder).encode(this._content),t=new Uint8Array(await n.subtle.digest(this.algorithm,e));let r="";for(let e=0;e<t.length;++e)r+=t[e].toString(16).padStart(2,"0");return r}}},{setimmediate:75}],67:[function(e,t,r){
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */
"use strict";const n="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",i="http://www.w3.org/2001/XMLSchema#string",o="NamedNode",s="BlankNode",a="Literal",l="DefaultGraph",u={};function c(e,t){return e.subject.termType===t.subject.termType&&e.object.termType===t.object.termType&&(e.subject.value===t.subject.value&&e.predicate.value===t.predicate.value&&e.object.value===t.object.value&&(e.object.termType!==a||e.object.datatype.termType===t.object.datatype.termType&&e.object.language===t.object.language&&e.object.datatype.value===t.object.datatype.value))}(()=>{const e="(?:<([^:]+:[^>]*)>)",t="A-Za-z-----------_",r=t+"0-9---",n="(_:(?:["+t+"0-9])(?:(?:["+r+".])*(?:["+r+"]))?)",i="[ \\t]+",o="[ \\t]*",s="(?:"+e+"|"+n+")"+i,a=e+i,l="(?:"+e+"|"+n+"|"+('(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:'+("(?:\\^\\^"+e+")")+"|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?)")+")"+o,c="(?:\\.|(?:(?:"+e+"|"+n+")"+o+"\\.))";u.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,u.empty=new RegExp("^"+o+"$"),u.quad=new RegExp("^"+o+s+a+l+c+o+"$")})(),t.exports=class e{static parse(e){const t=[],r={},f=e.split(u.eoln);let d=0;for(const e of f){if(d++,u.empty.test(e))continue;const f=e.match(u.quad);if(null===f)throw new Error("N-Quads parse error on line "+d+".");const h={subject:null,predicate:null,object:null,graph:null};if(void 0!==f[1]?h.subject={termType:o,value:f[1]}:h.subject={termType:s,value:f[2]},h.predicate={termType:o,value:f[3]},void 0!==f[4]?h.object={termType:o,value:f[4]}:void 0!==f[5]?h.object={termType:s,value:f[5]}:(h.object={termType:a,value:void 0,datatype:{termType:o}},void 0!==f[7]?h.object.datatype.value=f[7]:void 0!==f[8]?(h.object.datatype.value=n,h.object.language=f[8]):h.object.datatype.value=i,h.object.value=f[6].replace(p,(function(e,t,r,n){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(r)return String.fromCharCode(parseInt(r,16));if(n)throw new Error("Unsupported U escape")}))),void 0!==f[9]?h.graph={termType:o,value:f[9]}:void 0!==f[10]?h.graph={termType:s,value:f[10]}:h.graph={termType:l,value:""},h.graph.value in r){let e=!0;const n=r[h.graph.value];for(const t of n)if(c(t,h)){e=!1;break}e&&(n.push(h),t.push(h))}else r[h.graph.value]=[h],t.push(h)}return t}static serialize(t){Array.isArray(t)||(t=e.legacyDatasetToQuads(t));const r=[];for(const n of t)r.push(e.serializeQuad(n));return r.sort().join("")}static serializeQuadComponents(e,t,r,a){let l="";return e.termType===o?l+=`<${e.value}>`:l+=`${e.value}`,l+=` <${t.value}> `,r.termType===o?l+=`<${r.value}>`:r.termType===s?l+=r.value:(l+=`"${function(e){return e.replace(f,(function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}}))}(r.value)}"`,r.datatype.value===n?r.language&&(l+=`@${r.language}`):r.datatype.value!==i&&(l+=`^^<${r.datatype.value}>`)),a.termType===o?l+=` <${a.value}>`:a.termType===s&&(l+=` ${a.value}`),l+=" .\n",l}static serializeQuad(t){return e.serializeQuadComponents(t.subject,t.predicate,t.object,t.graph)}static legacyDatasetToQuads(e){const t=[],r={"blank node":s,IRI:o,literal:a};for(const u in e){e[u].forEach((e=>{const c={};for(const t in e){const s=e[t],l={termType:r[s.type],value:s.value};l.termType===a&&(l.datatype={termType:o},"datatype"in s&&(l.datatype.value=s.datatype),"language"in s?("datatype"in s||(l.datatype.value=n),l.language=s.language):"datatype"in s||(l.datatype.value=i)),c[t]=l}c.graph="@default"===u?{termType:l,value:""}:{termType:u.startsWith("_:")?s:o,value:u},t.push(c)}))}return t}};const f=/["\\\n\r]/g;const p=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],68:[function(e,t,r){
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */
"use strict";t.exports=class{constructor(e){this.current=e.sort(),this.done=!1,this.dir=new Map;for(let t=0;t<e.length;++t)this.dir.set(e[t],!0)}hasNext(){return!this.done}next(){const{current:e,dir:t}=this,r=e.slice();let n=null,i=0;const o=e.length;for(let r=0;r<o;++r){const s=e[r],a=t.get(s);(null===n||s>n)&&(a&&r>0&&s>e[r-1]||!a&&r<o-1&&s>e[r+1])&&(n=s,i=r)}if(null===n)this.done=!0;else{const r=t.get(n)?i-1:i+1;e[i]=e[r],e[r]=n;for(const r of e)r>n&&t.set(r,!t.get(r))}return r}}},{}],69:[function(e,t,r){(function(r){(function(){
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */
"use strict";const n=e("./IdentifierIssuer"),i=e("./MessageDigest"),o=e("./Permuter"),s=e("./NQuads");function a(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}t.exports=class{constructor({createMessageDigest:e=(()=>new i("sha256")),maxDeepIterations:t=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new n("_:c14n"),this.createMessageDigest=e,this.maxDeepIterations=t,this.quads=null,this.deepIterations=null}async main(e){this.deepIterations=new Map,this.quads=e;for(const t of e)this._addBlankNodeQuadInfo({quad:t,component:t.subject}),this._addBlankNodeQuadInfo({quad:t,component:t.object}),this._addBlankNodeQuadInfo({quad:t,component:t.graph});const t=new Map,r=[...this.blankNodeInfo.keys()];let i=0;for(const e of r)++i%100==0&&await this._yield(),await this._hashAndTrackBlankNode({id:e,hashToBlankNodes:t});const o=[...t.keys()].sort(),l=[];for(const e of o){const r=t.get(e);if(r.length>1){l.push(r);continue}const n=r[0];this.canonicalIssuer.getId(n)}for(const e of l){const t=[];for(const r of e){if(this.canonicalIssuer.hasId(r))continue;const e=new n("_:b");e.getId(r);const i=await this.hashNDegreeQuads(r,e);t.push(i)}t.sort(a);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const u=[];for(const e of this.quads){const t=s.serializeQuadComponents(this._componentWithCanonicalId(e.subject),e.predicate,this._componentWithCanonicalId(e.object),this._componentWithCanonicalId(e.graph));u.push(t)}return u.sort(),u.join("")}async hashFirstDegreeQuads(e){const t=[],r=this.blankNodeInfo.get(e),n=r.quads;for(const r of n){const n={subject:null,predicate:r.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(e,r.subject,"subject"),n.object=this.modifyFirstDegreeComponent(e,r.object,"object"),n.graph=this.modifyFirstDegreeComponent(e,r.graph,"graph"),t.push(s.serializeQuad(n))}t.sort();const i=this.createMessageDigest();for(const e of t)i.update(e);return r.hash=await i.digest(),r.hash}async hashRelatedBlankNode(e,t,r,n){let i;i=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):r.hasId(e)?r.getId(e):this.blankNodeInfo.get(e).hash;const o=this.createMessageDigest();return o.update(n),"g"!==n&&o.update(this.getRelatedPredicate(t)),o.update(i),o.digest()}async hashNDegreeQuads(e,t){const r=this.deepIterations.get(e)||0;if(r>this.maxDeepIterations)throw new Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(e,r+1);const n=this.createMessageDigest(),i=await this.createHashToRelated(e,t),s=[...i.keys()].sort();for(const e of s){n.update(e);let r,s="";const a=new o(i.get(e));let l=0;for(;a.hasNext();){const e=a.next();++l%3==0&&await this._yield();let n=t.clone(),i="";const o=[];let u=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?i+=this.canonicalIssuer.getId(t):(n.hasId(t)||o.push(t),i+=n.getId(t)),0!==s.length&&i>s){u=!0;break}if(!u){for(const e of o){const t=await this.hashNDegreeQuads(e,n);if(i+=n.getId(e),i+=`<${t.hash}>`,n=t.issuer,0!==s.length&&i>s){u=!0;break}}u||(0===s.length||i<s)&&(s=i,r=n)}}n.update(s),t=r}return{hash:await n.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}async createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;let i=0;for(const o of n)++i%100==0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:o,component:o.subject,position:"s",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:o,component:o.object,position:"o",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:o,component:o.graph,position:"g",id:e,issuer:t,hashToRelated:r})]);return r}async _hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const r=await this.hashFirstDegreeQuads(e),n=t.get(r);n?n.push(e):t.set(r,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const r=t.value,n=this.blankNodeInfo.get(r);n?n.quads.add(e):this.blankNodeInfo.set(r,{quads:new Set([e]),hash:null})}async _addRelatedBlankNodeHash({quad:e,component:t,position:r,id:n,issuer:i,hashToRelated:o}){if("BlankNode"!==t.termType||t.value===n)return;const s=t.value,a=await this.hashRelatedBlankNode(s,e,i,r),l=o.get(a);l?l.push(s):o.set(a,[s])}_componentWithCanonicalId(e){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}async _yield(){return new Promise((e=>r(e)))}}}).call(this)}).call(this,e("timers").setImmediate)},{"./IdentifierIssuer":65,"./MessageDigest":66,"./NQuads":67,"./Permuter":68,timers:111}],70:[function(e,t,r){
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */
"use strict";const n=e("./IdentifierIssuer"),i=e("./MessageDigest"),o=e("./Permuter"),s=e("./NQuads");function a(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}t.exports=class{constructor({createMessageDigest:e=(()=>new i("sha256")),maxDeepIterations:t=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new n("_:c14n"),this.createMessageDigest=e,this.maxDeepIterations=t,this.quads=null,this.deepIterations=null}main(e){this.deepIterations=new Map,this.quads=e;for(const t of e)this._addBlankNodeQuadInfo({quad:t,component:t.subject}),this._addBlankNodeQuadInfo({quad:t,component:t.object}),this._addBlankNodeQuadInfo({quad:t,component:t.graph});const t=new Map,r=[...this.blankNodeInfo.keys()];for(const e of r)this._hashAndTrackBlankNode({id:e,hashToBlankNodes:t});const i=[...t.keys()].sort(),o=[];for(const e of i){const r=t.get(e);if(r.length>1){o.push(r);continue}const n=r[0];this.canonicalIssuer.getId(n)}for(const e of o){const t=[];for(const r of e){if(this.canonicalIssuer.hasId(r))continue;const e=new n("_:b");e.getId(r);const i=this.hashNDegreeQuads(r,e);t.push(i)}t.sort(a);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const l=[];for(const e of this.quads){const t=s.serializeQuadComponents(this._componentWithCanonicalId({component:e.subject}),e.predicate,this._componentWithCanonicalId({component:e.object}),this._componentWithCanonicalId({component:e.graph}));l.push(t)}return l.sort(),l.join("")}hashFirstDegreeQuads(e){const t=[],r=this.blankNodeInfo.get(e),n=r.quads;for(const r of n){const n={subject:null,predicate:r.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(e,r.subject,"subject"),n.object=this.modifyFirstDegreeComponent(e,r.object,"object"),n.graph=this.modifyFirstDegreeComponent(e,r.graph,"graph"),t.push(s.serializeQuad(n))}t.sort();const i=this.createMessageDigest();for(const e of t)i.update(e);return r.hash=i.digest(),r.hash}hashRelatedBlankNode(e,t,r,n){let i;i=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):r.hasId(e)?r.getId(e):this.blankNodeInfo.get(e).hash;const o=this.createMessageDigest();return o.update(n),"g"!==n&&o.update(this.getRelatedPredicate(t)),o.update(i),o.digest()}hashNDegreeQuads(e,t){const r=this.deepIterations.get(e)||0;if(r>this.maxDeepIterations)throw new Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(e,r+1);const n=this.createMessageDigest(),i=this.createHashToRelated(e,t),s=[...i.keys()].sort();for(const e of s){n.update(e);let r,s="";const a=new o(i.get(e));for(;a.hasNext();){const e=a.next();let n=t.clone(),i="";const o=[];let l=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?i+=this.canonicalIssuer.getId(t):(n.hasId(t)||o.push(t),i+=n.getId(t)),0!==s.length&&i>s){l=!0;break}if(!l){for(const e of o){const t=this.hashNDegreeQuads(e,n);if(i+=n.getId(e),i+=`<${t.hash}>`,n=t.issuer,0!==s.length&&i>s){l=!0;break}}l||(0===s.length||i<s)&&(s=i,r=n)}}n.update(s),t=r}return{hash:n.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;for(const i of n)this._addRelatedBlankNodeHash({quad:i,component:i.subject,position:"s",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:i,component:i.object,position:"o",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:i,component:i.graph,position:"g",id:e,issuer:t,hashToRelated:r});return r}_hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const r=this.hashFirstDegreeQuads(e),n=t.get(r);n?n.push(e):t.set(r,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const r=t.value,n=this.blankNodeInfo.get(r);n?n.quads.add(e):this.blankNodeInfo.set(r,{quads:new Set([e]),hash:null})}_addRelatedBlankNodeHash({quad:e,component:t,position:r,id:n,issuer:i,hashToRelated:o}){if("BlankNode"!==t.termType||t.value===n)return;const s=t.value,a=this.hashRelatedBlankNode(s,e,i,r),l=o.get(a);l?l.push(s):o.set(a,[s])}_componentWithCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}}},{"./IdentifierIssuer":65,"./MessageDigest":66,"./NQuads":67,"./Permuter":68}],71:[function(e,t,r){
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */
"use strict";const n=e("./MessageDigest"),i=e("./URDNA2015");t.exports=class extends i{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new n("sha1")}modifyFirstDegreeComponent(e,t,r){return"BlankNode"!==t.termType?t:"graph"===r?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}async createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;let i=0;for(const o of n){let n,s;if("BlankNode"===o.subject.termType&&o.subject.value!==e)s=o.subject.value,n="p";else{if("BlankNode"!==o.object.termType||o.object.value===e)continue;s=o.object.value,n="r"}++i%100==0&&await this._yield();const a=await this.hashRelatedBlankNode(s,o,t,n),l=r.get(a);l?l.push(s):r.set(a,[s])}return r}}},{"./MessageDigest":66,"./URDNA2015":69}],72:[function(e,t,r){
/*!
 * Copyright (c) 2016-2021 Digital Bazaar, Inc. All rights reserved.
 */
"use strict";const n=e("./MessageDigest"),i=e("./URDNA2015Sync");t.exports=class extends i{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new n("sha1")}modifyFirstDegreeComponent(e,t,r){return"BlankNode"!==t.termType?t:"graph"===r?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;for(const i of n){let n,o;if("BlankNode"===i.subject.termType&&i.subject.value!==e)o=i.subject.value,n="p";else{if("BlankNode"!==i.object.termType||i.object.value===e)continue;o=i.object.value,n="r"}const s=this.hashRelatedBlankNode(o,i,t,n),a=r.get(s);a?a.push(o):r.set(s,[o])}return r}}},{"./MessageDigest":66,"./URDNA2015Sync":70}],73:[function(e,t,r){"use strict";const n=e("./URDNA2015"),i=e("./URGNA2012"),o=e("./URDNA2015Sync"),s=e("./URGNA2012Sync");let a;try{a=e("rdf-canonize-native")}catch(e){}r.NQuads=e("./NQuads"),r.IdentifierIssuer=e("./IdentifierIssuer"),r._rdfCanonizeNative=function(e){return e&&(a=e),a},r.canonize=async function(e,t){if(Array.isArray(e)||(e=r.NQuads.legacyDatasetToQuads(e)),t.useNative){if(!a)throw new Error("rdf-canonize-native not available");if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return new Promise(((r,n)=>a.canonize(e,t,((e,t)=>e?n(e):r(t)))))}if("URDNA2015"===t.algorithm)return new n(t).main(e);if("URGNA2012"===t.algorithm){if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new i(t).main(e)}if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)},r._canonizeSync=function(e,t){if(Array.isArray(e)||(e=r.NQuads.legacyDatasetToQuads(e)),t.useNative){if(!a)throw new Error("rdf-canonize-native not available");if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return a.canonizeSync(e,t)}if("URDNA2015"===t.algorithm)return new o(t).main(e);if("URGNA2012"===t.algorithm){if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new s(t).main(e)}if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)}},{"./IdentifierIssuer":65,"./NQuads":67,"./URDNA2015":69,"./URDNA2015Sync":70,"./URGNA2012":71,"./URGNA2012Sync":72,"rdf-canonize-native":3}],74:[function(e,t,r){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var n=e("buffer"),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(o(n,r),r.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:5}],75:[function(e,t,r){(function(e,t){(function(){!function(t,r){"use strict";if(!t.setImmediate){var n,i,o,s,a,l=1,u={},c=!1,f=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick((function(){h(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){h(e.data)},n=function(e){o.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(i=f.documentElement,n=function(e){var t=f.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):n=function(e){setTimeout(h,0,e)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&h(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),n=function(e){t.postMessage(s+e,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return u[l]=i,n(l),l++},p.clearImmediate=d}function d(e){delete u[e]}function h(e){if(c)setTimeout(h,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{d(e),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:59}],76:[function(e,t,r){t.exports=i;var n=e("events").EventEmitter;function i(){n.call(this)}e("inherits")(i,n),i.Readable=e("readable-stream/lib/_stream_readable.js"),i.Writable=e("readable-stream/lib/_stream_writable.js"),i.Duplex=e("readable-stream/lib/_stream_duplex.js"),i.Transform=e("readable-stream/lib/_stream_transform.js"),i.PassThrough=e("readable-stream/lib/_stream_passthrough.js"),i.finished=e("readable-stream/lib/internal/streams/end-of-stream.js"),i.pipeline=e("readable-stream/lib/internal/streams/pipeline.js"),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",l));var s=!1;function a(){s||(s=!0,e.end())}function l(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===n.listenerCount(this,"error"))throw e}function c(){r.removeListener("data",i),e.removeListener("drain",o),r.removeListener("end",a),r.removeListener("close",l),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return r.on("error",u),e.on("error",u),r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e}},{events:11,inherits:22,"readable-stream/lib/_stream_duplex.js":78,"readable-stream/lib/_stream_passthrough.js":79,"readable-stream/lib/_stream_readable.js":80,"readable-stream/lib/_stream_transform.js":81,"readable-stream/lib/_stream_writable.js":82,"readable-stream/lib/internal/streams/end-of-stream.js":86,"readable-stream/lib/internal/streams/pipeline.js":88}],77:[function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"==typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function o(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,s,a;if("string"==typeof t&&(i="not ",t.substr(!s||s<0?0:+s,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))a="The ".concat(e," ").concat(n," ").concat(o(t,"type"));else{var l=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(l," ").concat(n," ").concat(o(t,"type"))}return a+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n},{}],78:[function(e,t,r){(function(r){(function(){"use strict";var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=u;var i=e("./_stream_readable"),o=e("./_stream_writable");e("inherits")(u,i);for(var s=n(o.prototype),a=0;a<s.length;a++){var l=s[a];u.prototype[l]||(u.prototype[l]=o.prototype[l])}function u(e){if(!(this instanceof u))return new u(e);i.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":80,"./_stream_writable":82,_process:59,inherits:22}],79:[function(e,t,r){"use strict";t.exports=i;var n=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}e("inherits")(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":81,inherits:22}],80:[function(e,t,r){(function(r,n){(function(){"use strict";var i;t.exports=A,A.ReadableState=E;e("events").EventEmitter;var o=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),a=e("buffer").Buffer,l=n.Uint8Array||function(){};var u,c=e("util");u=c&&c.debuglog?c.debuglog("stream"):function(){};var f,p,d,h=e("./internal/streams/buffer_list"),y=e("./internal/streams/destroy"),v=e("./internal/streams/state").getHighWaterMark,g=e("../errors").codes,b=g.ERR_INVALID_ARG_TYPE,m=g.ERR_STREAM_PUSH_AFTER_EOF,x=g.ERR_METHOD_NOT_IMPLEMENTED,_=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(A,s);var w=y.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(t,r,n){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof n&&(n=r instanceof i),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=v(this,t,"readableHighWaterMark",n),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(f||(f=e("string_decoder/").StringDecoder),this.decoder=new f(t.encoding),this.encoding=t.encoding)}function A(t){if(i=i||e("./_stream_duplex"),!(this instanceof A))return new A(t);var r=this instanceof i;this._readableState=new E(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function S(e,t,r,n,i){u("readableAddChunk",t);var o,s=e._readableState;if(null===t)s.reading=!1,function(e,t){if(u("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?C(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,I(e)))}(e,s);else if(i||(o=function(e,t){var r;n=t,a.isBuffer(n)||n instanceof l||"string"==typeof t||void 0===t||e.objectMode||(r=new b("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(s,t)),o)w(e,o);else if(s.objectMode||t&&t.length>0)if("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),n)s.endEmitted?w(e,new _):j(e,s,t,!0);else if(s.ended)w(e,new m);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?j(e,s,t,!1):R(e,s)):j(e,s,t,!1)}else n||(s.reading=!1,R(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function j(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&C(e)),R(e,t)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),A.prototype.destroy=y.destroy,A.prototype._undestroy=y.undestroy,A.prototype._destroy=function(e,t){t(e)},A.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=a.from(e,t),t=""),r=!0),S(this,e,t,!1,r)},A.prototype.unshift=function(e){return S(this,e,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(t){f||(f=e("string_decoder/").StringDecoder);var r=new f(t);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=r.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var T=1073741824;function F(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=T?e=T:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function C(e){var t=e._readableState;u("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(u("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(I,e))}function I(e){var t=e._readableState;u("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,D(e)}function R(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(N,e,t))}function N(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(u("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function O(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function L(e){u("readable nexttick read 0"),e.read(0)}function P(e,t){u("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function Q(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function M(e){var t=e._readableState;u("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(B,t,e))}function B(e,t){if(u("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}A.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?M(this):C(this),null;if(0===(e=F(e,t))&&t.ended)return 0===t.length&&M(this),null;var n,i=t.needReadable;return u("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",i=!0),t.ended||t.reading?u("reading or ended",i=!1):i&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=F(r,t))),null===(n=e>0?Q(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&M(this)),null!==n&&this.emit("data",n),n},A.prototype._read=function(e){w(this,new x("_read()"))},A.prototype.pipe=function(e,t){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,u("pipe count=%d opts=%j",i.pipesCount,t);var s=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:v;function a(t,r){u("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,u("cleanup"),e.removeListener("close",h),e.removeListener("finish",y),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",a),n.removeListener("end",l),n.removeListener("end",v),n.removeListener("data",p),f=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function l(){u("onend"),e.end()}i.endEmitted?r.nextTick(s):n.once("end",s),e.on("unpipe",a);var c=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,D(e))}}(n);e.on("drain",c);var f=!1;function p(t){u("ondata");var r=e.write(t);u("dest.write",r),!1===r&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!f&&(u("false write response, pause",i.awaitDrain),i.awaitDrain++),n.pause())}function d(t){u("onerror",t),v(),e.removeListener("error",d),0===o(e,"error")&&w(e,t)}function h(){e.removeListener("finish",y),v()}function y(){u("onfinish"),e.removeListener("close",h),v()}function v(){u("unpipe"),n.unpipe(e)}return n.on("data",p),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",h),e.once("finish",y),e.emit("pipe",n),i.flowing||(u("pipe resume"),n.resume()),e},A.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=U(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},A.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,u("on readable",i.length,i.reading),i.length?C(this):i.reading||r.nextTick(L,this))),n},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(O,this),n},A.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(O,this),t},A.prototype.resume=function(){var e=this._readableState;return e.flowing||(u("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(P,e,t))}(this,e)),e.paused=!1,this},A.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(u("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(u("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<k.length;o++)e.on(k[o],this.emit.bind(this,k[o]));return this._read=function(t){u("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===p&&(p=e("./internal/streams/async_iterator")),p(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),A._fromList=Q,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(t,r){return void 0===d&&(d=e("./internal/streams/from")),d(A,t,r)})}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":77,"./_stream_duplex":78,"./internal/streams/async_iterator":83,"./internal/streams/buffer_list":84,"./internal/streams/destroy":85,"./internal/streams/from":87,"./internal/streams/state":89,"./internal/streams/stream":90,_process:59,buffer:5,events:11,inherits:22,"string_decoder/":110,util:3}],81:[function(e,t,r){"use strict";t.exports=c;var n=e("../errors").codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,o=n.ERR_MULTIPLE_CALLBACK,s=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,l=e("./_stream_duplex");function u(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new o);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);l.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f)}function f(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?p(this,null,null):this._flush((function(t,r){p(e,t,r)}))}function p(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new s;return e.push(null)}e("inherits")(c,l),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},{"../errors":77,"./_stream_duplex":78,inherits:22}],82:[function(e,t,r){(function(r,n){(function(){"use strict";function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var o;t.exports=A,A.WritableState=E;var s={deprecate:e("util-deprecate")},a=e("./internal/streams/stream"),l=e("buffer").Buffer,u=n.Uint8Array||function(){};var c,f=e("./internal/streams/destroy"),p=e("./internal/streams/state").getHighWaterMark,d=e("../errors").codes,h=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,g=d.ERR_STREAM_CANNOT_PIPE,b=d.ERR_STREAM_DESTROYED,m=d.ERR_STREAM_NULL_VALUES,x=d.ERR_STREAM_WRITE_AFTER_END,_=d.ERR_UNKNOWN_ENCODING,w=f.errorOrDestroy;function k(){}function E(t,n,s){o=o||e("./_stream_duplex"),t=t||{},"boolean"!=typeof s&&(s=n instanceof o),this.objectMode=!!t.objectMode,s&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=p(this,t,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,o=n.writecb;if("function"!=typeof o)throw new v;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,o){--t.pendingcb,n?(r.nextTick(o,i),r.nextTick(I,e,t),e._writableState.errorEmitted=!0,w(e,i)):(o(i),e._writableState.errorEmitted=!0,w(e,i),I(e,t))}(e,n,i,t,o);else{var s=F(n)||e.destroyed;s||n.corked||n.bufferProcessing||!n.bufferedRequest||T(e,n),i?r.nextTick(j,e,n,s,o):j(e,n,s,o)}}(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function A(t){var r=this instanceof(o=o||e("./_stream_duplex"));if(!r&&!c.call(A,this))return new A(t);this._writableState=new E(t,this,r),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),a.call(this)}function S(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new b("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function j(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),I(e,t)}function T(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,o=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var a=0,l=!0;r;)o[a]=r,r.isBuf||(l=!1),r=r.next,a+=1;o.allBuffers=l,S(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,c=r.encoding,f=r.callback;if(S(e,t,!1,t.objectMode?1:u.length,u,c,f),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function F(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(e,t){e._final((function(r){t.pendingcb--,r&&w(e,r),t.prefinished=!0,e.emit("prefinish"),I(e,t)}))}function I(e,t){var n=F(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(C,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return n}e("inherits")(A,a),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===A&&(e&&e._writableState instanceof E)}})):c=function(e){return e instanceof this},A.prototype.pipe=function(){w(this,new g)},A.prototype.write=function(e,t,n){var i,o=this._writableState,s=!1,a=!o.objectMode&&(i=e,l.isBuffer(i)||i instanceof u);return a&&!l.isBuffer(e)&&(e=function(e){return l.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=k),o.ending?function(e,t){var n=new x;w(e,n),r.nextTick(t,n)}(this,n):(a||function(e,t,n,i){var o;return null===n?o=new m:"string"==typeof n||t.objectMode||(o=new h("chunk",["string","Buffer"],n)),!o||(w(e,o),r.nextTick(i,o),!1)}(this,o,e,n))&&(o.pendingcb++,s=function(e,t,r,n,i,o){if(!r){var s=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,r));return t}(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else S(e,t,!1,a,n,i,o);return u}(this,o,a,e,t,n)),s},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||T(this,e))},A.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(e,t,r){r(new y("_write()"))},A.prototype._writev=null,A.prototype.end=function(e,t,n){var i=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,n){t.ending=!0,I(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),A.prototype.destroy=f.destroy,A.prototype._undestroy=f.undestroy,A.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":77,"./_stream_duplex":78,"./internal/streams/destroy":85,"./internal/streams/state":89,"./internal/streams/stream":90,_process:59,buffer:5,inherits:22,"util-deprecate":114}],83:[function(e,t,r){(function(r){(function(){"use strict";var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e("./end-of-stream"),s=Symbol("lastResolve"),a=Symbol("lastReject"),l=Symbol("error"),u=Symbol("ended"),c=Symbol("lastPromise"),f=Symbol("handlePromise"),p=Symbol("stream");function d(e,t){return{value:e,done:t}}function h(e){var t=e[s];if(null!==t){var r=e[p].read();null!==r&&(e[c]=null,e[s]=null,e[a]=null,t(d(r,!1)))}}function y(e){r.nextTick(h,e)}var v=Object.getPrototypeOf((function(){})),g=Object.setPrototypeOf((i(n={get stream(){return this[p]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(d(void 0,!0));if(this[p].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[l]?n(e[l]):t(d(void 0,!0))}))}));var n,i=this[c];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[u]?r(d(void 0,!0)):t[f](r,n)}),n)}}(i,this));else{var o=this[p].read();if(null!==o)return Promise.resolve(d(o,!1));n=new Promise(this[f])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[p].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),n),v);t.exports=function(e){var t,r=Object.create(g,(i(t={},p,{value:e,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,u,{value:e._readableState.endEmitted,writable:!0}),i(t,f,{value:function(e,t){var n=r[p].read();n?(r[c]=null,r[s]=null,r[a]=null,e(d(n,!1))):(r[s]=e,r[a]=t)},writable:!0}),t));return r[c]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[a];return null!==t&&(r[c]=null,r[s]=null,r[a]=null,t(e)),void(r[l]=e)}var n=r[s];null!==n&&(r[c]=null,r[s]=null,r[a]=null,n(d(void 0,!0))),r[u]=!0})),e.on("readable",y.bind(null,r)),r}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":86,_process:59}],84:[function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=e("buffer").Buffer,a=e("util").inspect,l=a&&a.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,u;return t=e,r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,r,n,i=s.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,r=i,n=a,s.prototype.copy.call(t,r,n),a+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?n+=i:n+=i.slice(0,e),0==(e-=o)){o===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(o));break}++n}return this.length-=n,t}},{key:l,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],r&&o(t.prototype,r),u&&o(t,u),e}()},{buffer:5,util:3}],85:[function(e,t,r){(function(e){(function(){"use strict";function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,o){var s=this,a=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return a||l?(o?o(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!o&&t?s._writableState?s._writableState.errorEmitted?e.nextTick(n,s):(s._writableState.errorEmitted=!0,e.nextTick(r,s,t)):e.nextTick(r,s,t):o?(e.nextTick(n,s),o(t)):e.nextTick(n,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))},{_process:59}],86:[function(e,t,r){"use strict";var n=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,r,o){if("function"==typeof r)return e(t,null,r);r||(r={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(o||i);var s=r.readable||!1!==r.readable&&t.readable,a=r.writable||!1!==r.writable&&t.writable,l=function(){t.writable||c()},u=t._writableState&&t._writableState.finished,c=function(){a=!1,u=!0,s||o.call(t)},f=t._readableState&&t._readableState.endEmitted,p=function(){s=!1,f=!0,a||o.call(t)},d=function(e){o.call(t,e)},h=function(){var e;return s&&!f?(t._readableState&&t._readableState.ended||(e=new n),o.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new n),o.call(t,e)):void 0},y=function(){t.req.on("finish",c)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",l),t.on("close",l)):(t.on("complete",c),t.on("abort",h),t.req?y():t.on("request",y)),t.on("end",p),t.on("finish",c),!1!==r.error&&t.on("error",d),t.on("close",h),function(){t.removeListener("complete",c),t.removeListener("abort",h),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",c),t.removeListener("end",p),t.removeListener("error",d),t.removeListener("close",h)}}},{"../../../errors":77}],87:[function(e,t,r){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],88:[function(e,t,r){"use strict";var n;var i=e("../../../errors").codes,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function l(t,r,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;t.on("close",(function(){a=!0})),void 0===n&&(n=e("./end-of-stream")),n(t,{readable:r,writable:i},(function(e){if(e)return o(e);a=!0,o()}));var l=!1;return function(e){if(!a&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void o(e||new s("pipe"))}}function u(e){e()}function c(e,t){return e.pipe(t)}function f(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}t.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=f(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var s=t.map((function(e,r){var o=r<t.length-1;return l(e,o,r>0,(function(e){n||(n=e),e&&s.forEach(u),o||(s.forEach(u),i(n))}))}));return t.reduce(c)}},{"../../../errors":77,"./end-of-stream":86}],89:[function(e,t,r){"use strict";var n=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,r,i){var o=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new n(i?r:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},{"../../../errors":77}],90:[function(e,t,r){t.exports=e("events").EventEmitter},{events:11}],91:[function(e,t,r){(function(t){(function(){var n=e("./lib/request"),i=e("./lib/response"),o=e("xtend"),s=e("builtin-status-codes"),a=e("url"),l=r;l.request=function(e,r){e="string"==typeof e?a.parse(e):o(e);var i=-1===t.location.protocol.search(/^https?:$/)?"http:":"",s=e.protocol||i,l=e.hostname||e.host,u=e.port,c=e.path||"/";l&&-1!==l.indexOf(":")&&(l="["+l+"]"),e.url=(l?s+"//"+l:"")+(u?":"+u:"")+c,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var f=new n(e);return r&&f.on("response",r),f},l.get=function(e,t){var r=l.request(e,t);return r.end(),r},l.ClientRequest=n,l.IncomingMessage=i.IncomingMessage,l.Agent=function(){},l.Agent.defaultMaxSockets=4,l.globalAgent=new l.Agent,l.STATUS_CODES=s,l.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":93,"./lib/response":94,"builtin-status-codes":6,url:112,xtend:119}],92:[function(e,t,r){(function(e){(function(){var t;function n(){if(void 0!==t)return t;if(e.XMLHttpRequest){t=new e.XMLHttpRequest;try{t.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(e){t=null}}else t=null;return t}function i(e){var t=n();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}function o(e){return"function"==typeof e}r.fetch=o(e.fetch)&&o(e.ReadableStream),r.writableStream=o(e.WritableStream),r.abortController=o(e.AbortController),r.arraybuffer=r.fetch||i("arraybuffer"),r.msstream=!r.fetch&&i("ms-stream"),r.mozchunkedarraybuffer=!r.fetch&&i("moz-chunked-arraybuffer"),r.overrideMimeType=r.fetch||!!n()&&o(n().overrideMimeType),t=null}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],93:[function(e,t,r){(function(r,n,i){(function(){var o=e("./capability"),s=e("inherits"),a=e("./response"),l=e("readable-stream"),u=a.IncomingMessage,c=a.readyStates;var f=t.exports=function(e){var t,r=this;l.Writable.call(r),r._opts=e,r._body=[],r._headers={},e.auth&&r.setHeader("Authorization","Basic "+i.from(e.auth).toString("base64")),Object.keys(e.headers).forEach((function(t){r.setHeader(t,e.headers[t])}));var n=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!o.abortController)n=!1,t=!0;else if("prefer-streaming"===e.mode)t=!1;else if("allow-wrong-content-type"===e.mode)t=!o.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");t=!0}r._mode=function(e,t){return o.fetch&&t?"fetch":o.mozchunkedarraybuffer?"moz-chunked-arraybuffer":o.msstream?"ms-stream":o.arraybuffer&&e?"arraybuffer":"text"}(t,n),r._fetchTimer=null,r._socketTimeout=null,r._socketTimer=null,r.on("finish",(function(){r._onFinish()}))};s(f,l.Writable),f.prototype.setHeader=function(e,t){var r=e.toLowerCase();-1===p.indexOf(r)&&(this._headers[r]={name:e,value:t})},f.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},f.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},f.prototype._onFinish=function(){var e=this;if(!e._destroyed){var t=e._opts;"timeout"in t&&0!==t.timeout&&e.setTimeout(t.timeout);var i=e._headers,s=null;"GET"!==t.method&&"HEAD"!==t.method&&(s=new Blob(e._body,{type:(i["content-type"]||{}).value||""}));var a=[];if(Object.keys(i).forEach((function(e){var t=i[e].name,r=i[e].value;Array.isArray(r)?r.forEach((function(e){a.push([t,e])})):a.push([t,r])})),"fetch"===e._mode){var l=null;if(o.abortController){var u=new AbortController;l=u.signal,e._fetchAbortController=u,"requestTimeout"in t&&0!==t.requestTimeout&&(e._fetchTimer=n.setTimeout((function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()}),t.requestTimeout))}n.fetch(e._opts.url,{method:e._opts.method,headers:a,body:s||void 0,mode:"cors",credentials:t.withCredentials?"include":"same-origin",signal:l}).then((function(t){e._fetchResponse=t,e._resetTimers(!1),e._connect()}),(function(t){e._resetTimers(!0),e._destroyed||e.emit("error",t)}))}else{var f=e._xhr=new n.XMLHttpRequest;try{f.open(e._opts.method,e._opts.url,!0)}catch(t){return void r.nextTick((function(){e.emit("error",t)}))}"responseType"in f&&(f.responseType=e._mode),"withCredentials"in f&&(f.withCredentials=!!t.withCredentials),"text"===e._mode&&"overrideMimeType"in f&&f.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in t&&(f.timeout=t.requestTimeout,f.ontimeout=function(){e.emit("requestTimeout")}),a.forEach((function(e){f.setRequestHeader(e[0],e[1])})),e._response=null,f.onreadystatechange=function(){switch(f.readyState){case c.LOADING:case c.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(f.onprogress=function(){e._onXHRProgress()}),f.onerror=function(){e._destroyed||(e._resetTimers(!0),e.emit("error",new Error("XHR error")))};try{f.send(s)}catch(t){return void r.nextTick((function(){e.emit("error",t)}))}}}},f.prototype._onXHRProgress=function(){var e=this;e._resetTimers(!1),function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}}(e._xhr)&&!e._destroyed&&(e._response||e._connect(),e._response._onXHRProgress(e._resetTimers.bind(e)))},f.prototype._connect=function(){var e=this;e._destroyed||(e._response=new u(e._xhr,e._fetchResponse,e._mode,e._resetTimers.bind(e)),e._response.on("error",(function(t){e.emit("error",t)})),e.emit("response",e._response))},f.prototype._write=function(e,t,r){this._body.push(e),r()},f.prototype._resetTimers=function(e){var t=this;n.clearTimeout(t._socketTimer),t._socketTimer=null,e?(n.clearTimeout(t._fetchTimer),t._fetchTimer=null):t._socketTimeout&&(t._socketTimer=n.setTimeout((function(){t.emit("timeout")}),t._socketTimeout))},f.prototype.abort=f.prototype.destroy=function(e){var t=this;t._destroyed=!0,t._resetTimers(!0),t._response&&(t._response._destroyed=!0),t._xhr?t._xhr.abort():t._fetchAbortController&&t._fetchAbortController.abort(),e&&t.emit("error",e)},f.prototype.end=function(e,t,r){"function"==typeof e&&(r=e,e=void 0),l.Writable.prototype.end.call(this,e,t,r)},f.prototype.setTimeout=function(e,t){var r=this;t&&r.once("timeout",t),r._socketTimeout=e,r._resetTimers(!1)},f.prototype.flushHeaders=function(){},f.prototype.setNoDelay=function(){},f.prototype.setSocketKeepAlive=function(){};var p=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"./capability":92,"./response":94,_process:59,buffer:5,inherits:22,"readable-stream":109}],94:[function(e,t,r){(function(t,n,i){(function(){var o=e("./capability"),s=e("inherits"),a=e("readable-stream"),l=r.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},u=r.IncomingMessage=function(e,r,n,s){var l=this;if(a.Readable.call(l),l._mode=n,l.headers={},l.rawHeaders=[],l.trailers={},l.rawTrailers=[],l.on("end",(function(){t.nextTick((function(){l.emit("close")}))})),"fetch"===n){if(l._fetchResponse=r,l.url=r.url,l.statusCode=r.status,l.statusMessage=r.statusText,r.headers.forEach((function(e,t){l.headers[t.toLowerCase()]=e,l.rawHeaders.push(t,e)})),o.writableStream){var u=new WritableStream({write:function(e){return s(!1),new Promise((function(t,r){l._destroyed?r():l.push(i.from(e))?t():l._resumeFetch=t}))},close:function(){s(!0),l._destroyed||l.push(null)},abort:function(e){s(!0),l._destroyed||l.emit("error",e)}});try{return void r.body.pipeTo(u).catch((function(e){s(!0),l._destroyed||l.emit("error",e)}))}catch(e){}}var c=r.body.getReader();!function e(){c.read().then((function(t){l._destroyed||(s(t.done),t.done?l.push(null):(l.push(i.from(t.value)),e()))})).catch((function(e){s(!0),l._destroyed||l.emit("error",e)}))}()}else{if(l._xhr=e,l._pos=0,l.url=e.responseURL,l.statusCode=e.status,l.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach((function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var r=t[1].toLowerCase();"set-cookie"===r?(void 0===l.headers[r]&&(l.headers[r]=[]),l.headers[r].push(t[2])):void 0!==l.headers[r]?l.headers[r]+=", "+t[2]:l.headers[r]=t[2],l.rawHeaders.push(t[1],t[2])}})),l._charset="x-user-defined",!o.overrideMimeType){var f=l.rawHeaders["mime-type"];if(f){var p=f.match(/;\s*charset=([^;])(;|$)/);p&&(l._charset=p[1].toLowerCase())}l._charset||(l._charset="utf-8")}}};s(u,a.Readable),u.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},u.prototype._onXHRProgress=function(e){var t=this,r=t._xhr,o=null;switch(t._mode){case"text":if((o=r.responseText).length>t._pos){var s=o.substr(t._pos);if("x-user-defined"===t._charset){for(var a=i.alloc(s.length),u=0;u<s.length;u++)a[u]=255&s.charCodeAt(u);t.push(a)}else t.push(s,t._charset);t._pos=o.length}break;case"arraybuffer":if(r.readyState!==l.DONE||!r.response)break;o=r.response,t.push(i.from(new Uint8Array(o)));break;case"moz-chunked-arraybuffer":if(o=r.response,r.readyState!==l.LOADING||!o)break;t.push(i.from(new Uint8Array(o)));break;case"ms-stream":if(o=r.response,r.readyState!==l.LOADING)break;var c=new n.MSStreamReader;c.onprogress=function(){c.result.byteLength>t._pos&&(t.push(i.from(new Uint8Array(c.result.slice(t._pos)))),t._pos=c.result.byteLength)},c.onload=function(){e(!0),t.push(null)},c.readAsArrayBuffer(o)}t._xhr.readyState===l.DONE&&"ms-stream"!==t._mode&&(e(!0),t.push(null))}}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"./capability":92,_process:59,buffer:5,inherits:22,"readable-stream":109}],95:[function(e,t,r){arguments[4][77][0].apply(r,arguments)},{dup:77}],96:[function(e,t,r){arguments[4][78][0].apply(r,arguments)},{"./_stream_readable":98,"./_stream_writable":100,_process:59,dup:78,inherits:22}],97:[function(e,t,r){arguments[4][79][0].apply(r,arguments)},{"./_stream_transform":99,dup:79,inherits:22}],98:[function(e,t,r){arguments[4][80][0].apply(r,arguments)},{"../errors":95,"./_stream_duplex":96,"./internal/streams/async_iterator":101,"./internal/streams/buffer_list":102,"./internal/streams/destroy":103,"./internal/streams/from":105,"./internal/streams/state":107,"./internal/streams/stream":108,_process:59,buffer:5,dup:80,events:11,inherits:22,"string_decoder/":110,util:3}],99:[function(e,t,r){arguments[4][81][0].apply(r,arguments)},{"../errors":95,"./_stream_duplex":96,dup:81,inherits:22}],100:[function(e,t,r){arguments[4][82][0].apply(r,arguments)},{"../errors":95,"./_stream_duplex":96,"./internal/streams/destroy":103,"./internal/streams/state":107,"./internal/streams/stream":108,_process:59,buffer:5,dup:82,inherits:22,"util-deprecate":114}],101:[function(e,t,r){arguments[4][83][0].apply(r,arguments)},{"./end-of-stream":104,_process:59,dup:83}],102:[function(e,t,r){arguments[4][84][0].apply(r,arguments)},{buffer:5,dup:84,util:3}],103:[function(e,t,r){arguments[4][85][0].apply(r,arguments)},{_process:59,dup:85}],104:[function(e,t,r){arguments[4][86][0].apply(r,arguments)},{"../../../errors":95,dup:86}],105:[function(e,t,r){arguments[4][87][0].apply(r,arguments)},{dup:87}],106:[function(e,t,r){arguments[4][88][0].apply(r,arguments)},{"../../../errors":95,"./end-of-stream":104,dup:88}],107:[function(e,t,r){arguments[4][89][0].apply(r,arguments)},{"../../../errors":95,dup:89}],108:[function(e,t,r){arguments[4][90][0].apply(r,arguments)},{dup:90,events:11}],109:[function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),r.finished=e("./lib/internal/streams/end-of-stream.js"),r.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":96,"./lib/_stream_passthrough.js":97,"./lib/_stream_readable.js":98,"./lib/_stream_transform.js":99,"./lib/_stream_writable.js":100,"./lib/internal/streams/end-of-stream.js":104,"./lib/internal/streams/pipeline.js":106}],110:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=c,this.end=f,t=3;break;default:return this.write=p,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function c(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}r.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if(i=s(t[n]),i>=0)return i>0&&(e.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if(i=s(t[n]),i>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":74}],111:[function(e,t,r){(function(t,n){(function(){var i=e("process/browser.js").nextTick,o=Function.prototype.apply,s=Array.prototype.slice,a={},l=0;function u(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new u(o.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new u(o.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r.setImmediate="function"==typeof t?t:function(e){var t=l++,n=!(arguments.length<2)&&s.call(arguments,1);return a[t]=!0,i((function(){a[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))})),t},r.clearImmediate="function"==typeof n?n:function(e){delete a[e]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":59,timers:111}],112:[function(e,t,r){"use strict";var n=e("punycode"),i=e("./util");function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}r.parse=m,r.resolve=function(e,t){return m(e,!1,!0).resolve(t)},r.resolveObject=function(e,t){return e?m(e,!1,!0).resolveObject(t):t},r.format=function(e){i.isString(e)&&(e=m(e));return e instanceof o?e.format():o.prototype.format.call(e)},r.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(u),f=["%","/","?",";","#"].concat(c),p=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=e("querystring");function m(e,t,r){if(e&&i.isObject(e)&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",u=e.split(a);u[0]=u[0].replace(/\\/g,"/");var m=e=u.join(a);if(m=m.trim(),!r&&1===e.split("#").length){var x=l.exec(m);if(x)return this.path=m,this.href=m,this.pathname=x[1],x[2]?(this.search=x[2],this.query=t?b.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var _=s.exec(m);if(_){var w=(_=_[0]).toLowerCase();this.protocol=w,m=m.substr(_.length)}if(r||_||m.match(/^\/\/[^@\/]+@[^@\/]+/)){var k="//"===m.substr(0,2);!k||_&&v[_]||(m=m.substr(2),this.slashes=!0)}if(!v[_]&&(k||_&&!g[_])){for(var E,A,S=-1,j=0;j<p.length;j++){-1!==(T=m.indexOf(p[j]))&&(-1===S||T<S)&&(S=T)}-1!==(A=-1===S?m.lastIndexOf("@"):m.lastIndexOf("@",S))&&(E=m.slice(0,A),m=m.slice(A+1),this.auth=decodeURIComponent(E)),S=-1;for(j=0;j<f.length;j++){var T;-1!==(T=m.indexOf(f[j]))&&(-1===S||T<S)&&(S=T)}-1===S&&(S=m.length),this.host=m.slice(0,S),m=m.slice(S),this.parseHost(),this.hostname=this.hostname||"";var F="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!F)for(var C=this.hostname.split(/\./),I=(j=0,C.length);j<I;j++){var R=C[j];if(R&&!R.match(d)){for(var N="",O=0,L=R.length;O<L;O++)R.charCodeAt(O)>127?N+="x":N+=R[O];if(!N.match(d)){var P=C.slice(0,j),D=C.slice(j+1),Q=R.match(h);Q&&(P.push(Q[1]),D.unshift(Q[2])),D.length&&(m="/"+D.join(".")+m),this.hostname=P.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),F||(this.hostname=n.toASCII(this.hostname));var M=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+M,this.href+=this.host,F&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==m[0]&&(m="/"+m))}if(!y[w])for(j=0,I=c.length;j<I;j++){var U=c[j];if(-1!==m.indexOf(U)){var G=encodeURIComponent(U);G===U&&(G=escape(U)),m=m.split(U).join(G)}}var q=m.indexOf("#");-1!==q&&(this.hash=m.substr(q),m=m.slice(0,q));var H=m.indexOf("?");if(-1!==H?(this.search=m.substr(H),this.query=m.substr(H+1),t&&(this.query=b.parse(this.query)),m=m.slice(0,H)):t&&(this.search="",this.query={}),m&&(this.pathname=m),g[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){M=this.pathname||"";var J=this.search||"";this.path=M+J}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,s="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=b.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+o+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(m(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),s=0;s<n.length;s++){var a=n[s];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),u=0;u<l.length;u++){var c=l[u];"protocol"!==c&&(r[c]=e[c])}return g[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){for(var f=Object.keys(e),p=0;p<f.length;p++){var d=f[p];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||v[e.protocol])r.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),r.pathname=h.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var y=r.pathname||"",b=r.search||"";r.path=y+b}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var m=r.pathname&&"/"===r.pathname.charAt(0),x=e.host||e.pathname&&"/"===e.pathname.charAt(0),_=x||m||r.host&&e.pathname,w=_,k=r.pathname&&r.pathname.split("/")||[],E=(h=e.pathname&&e.pathname.split("/")||[],r.protocol&&!g[r.protocol]);if(E&&(r.hostname="",r.port=null,r.host&&(""===k[0]?k[0]=r.host:k.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),_=_&&(""===h[0]||""===k[0])),x)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,k=h;else if(h.length)k||(k=[]),k.pop(),k=k.concat(h),r.search=e.search,r.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(E)r.hostname=r.host=k.shift(),(F=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=F.shift(),r.host=r.hostname=F.shift());return r.search=e.search,r.query=e.query,i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!k.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var A=k.slice(-1)[0],S=(r.host||e.host||k.length>1)&&("."===A||".."===A)||""===A,j=0,T=k.length;T>=0;T--)"."===(A=k[T])?k.splice(T,1):".."===A?(k.splice(T,1),j++):j&&(k.splice(T,1),j--);if(!_&&!w)for(;j--;j)k.unshift("..");!_||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),S&&"/"!==k.join("/").substr(-1)&&k.push("");var F,C=""===k[0]||k[0]&&"/"===k[0].charAt(0);E&&(r.hostname=r.host=C?"":k.length?k.shift():"",(F=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=F.shift(),r.host=r.hostname=F.shift()));return(_=_||r.host&&k.length)&&!C&&k.unshift(""),k.length?r.pathname=k.join("/"):(r.pathname=null,r.path=null),i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":113,punycode:60,querystring:63}],113:[function(e,t,r){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],114:[function(e,t,r){(function(e){(function(){function r(t){try{if(!e.localStorage)return!1}catch(e){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}t.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],115:[function(e,t,r){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],116:[function(e,t,r){"use strict";var n=e("is-arguments"),i=e("is-generator-function"),o=e("which-typed-array"),s=e("is-typed-array");function a(e){return e.call.bind(e)}var l="undefined"!=typeof BigInt,u="undefined"!=typeof Symbol,c=a(Object.prototype.toString),f=a(Number.prototype.valueOf),p=a(String.prototype.valueOf),d=a(Boolean.prototype.valueOf);if(l)var h=a(BigInt.prototype.valueOf);if(u)var y=a(Symbol.prototype.valueOf);function v(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function g(e){return"[object Map]"===c(e)}function b(e){return"[object Set]"===c(e)}function m(e){return"[object WeakMap]"===c(e)}function x(e){return"[object WeakSet]"===c(e)}function _(e){return"[object ArrayBuffer]"===c(e)}function w(e){return"undefined"!=typeof ArrayBuffer&&(_.working?_(e):e instanceof ArrayBuffer)}function k(e){return"[object DataView]"===c(e)}function E(e){return"undefined"!=typeof DataView&&(k.working?k(e):e instanceof DataView)}r.isArgumentsObject=n,r.isGeneratorFunction=i,r.isTypedArray=s,r.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},r.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||E(e)},r.isUint8Array=function(e){return"Uint8Array"===o(e)},r.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===o(e)},r.isUint16Array=function(e){return"Uint16Array"===o(e)},r.isUint32Array=function(e){return"Uint32Array"===o(e)},r.isInt8Array=function(e){return"Int8Array"===o(e)},r.isInt16Array=function(e){return"Int16Array"===o(e)},r.isInt32Array=function(e){return"Int32Array"===o(e)},r.isFloat32Array=function(e){return"Float32Array"===o(e)},r.isFloat64Array=function(e){return"Float64Array"===o(e)},r.isBigInt64Array=function(e){return"BigInt64Array"===o(e)},r.isBigUint64Array=function(e){return"BigUint64Array"===o(e)},g.working="undefined"!=typeof Map&&g(new Map),r.isMap=function(e){return"undefined"!=typeof Map&&(g.working?g(e):e instanceof Map)},b.working="undefined"!=typeof Set&&b(new Set),r.isSet=function(e){return"undefined"!=typeof Set&&(b.working?b(e):e instanceof Set)},m.working="undefined"!=typeof WeakMap&&m(new WeakMap),r.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(m.working?m(e):e instanceof WeakMap)},x.working="undefined"!=typeof WeakSet&&x(new WeakSet),r.isWeakSet=function(e){return x(e)},_.working="undefined"!=typeof ArrayBuffer&&_(new ArrayBuffer),r.isArrayBuffer=w,k.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&k(new DataView(new ArrayBuffer(1),0,1)),r.isDataView=E;var A="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function S(e){return"[object SharedArrayBuffer]"===c(e)}function j(e){return void 0!==A&&(void 0===S.working&&(S.working=S(new A)),S.working?S(e):e instanceof A)}function T(e){return v(e,f)}function F(e){return v(e,p)}function C(e){return v(e,d)}function I(e){return l&&v(e,h)}function R(e){return u&&v(e,y)}r.isSharedArrayBuffer=j,r.isAsyncFunction=function(e){return"[object AsyncFunction]"===c(e)},r.isMapIterator=function(e){return"[object Map Iterator]"===c(e)},r.isSetIterator=function(e){return"[object Set Iterator]"===c(e)},r.isGeneratorObject=function(e){return"[object Generator]"===c(e)},r.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===c(e)},r.isNumberObject=T,r.isStringObject=F,r.isBooleanObject=C,r.isBigIntObject=I,r.isSymbolObject=R,r.isBoxedPrimitive=function(e){return T(e)||F(e)||C(e)||I(e)||R(e)},r.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(w(e)||j(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(r,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},{"is-arguments":23,"is-generator-function":25,"is-typed-array":26,"which-typed-array":118}],117:[function(e,t,r){(function(t){(function(){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;r.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(l(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),a=n[r];r<o;a=n[++r])v(a)||!_(a)?s+=" "+a:s+=" "+l(a);return s},r.deprecate=function(e,n){if(void 0!==t&&!0===t.noDeprecation)return e;if(void 0===t)return function(){return r.deprecate(e,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),i=!0}return e.apply(this,arguments)}};var o={},s=/^$/;if(t.env.NODE_DEBUG){var a=t.env.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+a+"$","i")}function l(e,t){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(t)?n.showHidden=t:t&&r._extend(n,t),m(n.showHidden)&&(n.showHidden=!1),m(n.depth)&&(n.depth=2),m(n.colors)&&(n.colors=!1),m(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),f(n,e,n.depth)}function u(e,t){var r=l.styles[t];return r?"["+l.colors[r][0]+"m"+e+"["+l.colors[r][1]+"m":e}function c(e,t){return e}function f(e,t,n){if(e.customInspect&&t&&E(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return b(i)||(i=f(e,i,n)),i}var o=function(e,t){if(m(t))return e.stylize("undefined","undefined");if(b(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(g(t))return e.stylize(""+t,"number");if(y(t))return e.stylize(""+t,"boolean");if(v(t))return e.stylize("null","null")}(e,t);if(o)return o;var s=Object.keys(t),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),k(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return p(t);if(0===s.length){if(E(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(x(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(w(t))return e.stylize(Date.prototype.toString.call(t),"date");if(k(t))return p(t)}var u,c="",_=!1,A=["{","}"];(h(t)&&(_=!0,A=["[","]"]),E(t))&&(c=" [Function"+(t.name?": "+t.name:"")+"]");return x(t)&&(c=" "+RegExp.prototype.toString.call(t)),w(t)&&(c=" "+Date.prototype.toUTCString.call(t)),k(t)&&(c=" "+p(t)),0!==s.length||_&&0!=t.length?n<0?x(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=_?function(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)F(t,String(s))?o.push(d(e,t,r,n,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,r,n,i,!0))})),o}(e,t,n,a,s):s.map((function(r){return d(e,t,n,a,r,_)})),e.seen.pop(),function(e,t,r){var n=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,c,A)):A[0]+c+A[1]}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,i,o){var s,a,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(a=e.stylize("[Setter]","special")),F(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(l.value)<0?(a=v(r)?f(e,l.value,null):f(e,l.value,r-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),m(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function h(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function v(e){return null===e}function g(e){return"number"==typeof e}function b(e){return"string"==typeof e}function m(e){return void 0===e}function x(e){return _(e)&&"[object RegExp]"===A(e)}function _(e){return"object"==typeof e&&null!==e}function w(e){return _(e)&&"[object Date]"===A(e)}function k(e){return _(e)&&("[object Error]"===A(e)||e instanceof Error)}function E(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}r.debuglog=function(e){if(e=e.toUpperCase(),!o[e])if(s.test(e)){var n=t.pid;o[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else o[e]=function(){};return o[e]},r.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.types=e("./support/types"),r.isArray=h,r.isBoolean=y,r.isNull=v,r.isNullOrUndefined=function(e){return null==e},r.isNumber=g,r.isString=b,r.isSymbol=function(e){return"symbol"==typeof e},r.isUndefined=m,r.isRegExp=x,r.types.isRegExp=x,r.isObject=_,r.isDate=w,r.types.isDate=w,r.isError=k,r.types.isNativeError=k,r.isFunction=E,r.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},r.isBuffer=e("./support/isBuffer");var j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),j[e.getMonth()],t].join(" ")}function F(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.log=function(){console.log("%s - %s",T(),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!_(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var C="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function I(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}r.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(C&&e[C]){var t;if("function"!=typeof(t=e[C]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),C&&Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},r.promisify.custom=C,r.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var i=r.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};e.apply(this,r).then((function(e){t.nextTick(s.bind(null,null,e))}),(function(e){t.nextTick(I.bind(null,e,s))}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.defineProperties(r,n(e)),r}}).call(this)}).call(this,e("_process"))},{"./support/isBuffer":115,"./support/types":116,_process:59,inherits:22}],118:[function(e,t,r){(function(r){(function(){"use strict";var n=e("for-each"),i=e("available-typed-arrays"),o=e("call-bind/callBound"),s=o("Object.prototype.toString"),a=e("has-tostringtag/shams")(),l="undefined"==typeof globalThis?r:globalThis,u=i(),c=o("String.prototype.slice"),f={},p=e("es-abstract/helpers/getOwnPropertyDescriptor"),d=Object.getPrototypeOf;a&&p&&d&&n(u,(function(e){if("function"==typeof l[e]){var t=new l[e];if(Symbol.toStringTag in t){var r=d(t),n=p(r,Symbol.toStringTag);if(!n){var i=d(r);n=p(i,Symbol.toStringTag)}f[e]=n.get}}}));var h=e("is-typed-array");t.exports=function(e){return!!h(e)&&(a&&Symbol.toStringTag in e?function(e){var t=!1;return n(f,(function(r,n){if(!t)try{var i=r.call(e);i===n&&(t=i)}catch(e){}})),t}(e):c(s(e),8,-1))}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"available-typed-arrays":1,"call-bind/callBound":7,"es-abstract/helpers/getOwnPropertyDescriptor":10,"for-each":12,"has-tostringtag/shams":18,"is-typed-array":26}],119:[function(e,t,r){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty},{}],120:[function(e,t,r){"use strict";t.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},{}],121:[function(e,t,r){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)t.push(arguments[r]);return t}function i(e,t,r){var n=t===e.head?new a(r,null,t,e):new a(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function o(e,t){e.tail=new a(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function s(e,t){e.head=new a(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function a(e,t,r,n){if(!(this instanceof a))return new a(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}t.exports=n,n.Node=a,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,i=this.head;null!==i;)r.push(e.call(t,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,i=this.tail;null!==i;)r.push(e.call(t,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)r.push(o.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)r.push(o.value);return r},n.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,o=this.head;null!==o&&n<e;n++)o=o.next;var s=[];for(n=0;o&&n<t;n++)s.push(o.value),o=this.removeNode(o);null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(n=0;n<r.length;n++)o=i(this,o,r[n]);return s},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{e("./iterator.js")(n)}catch(e){}},{"./iterator.js":120}],122:[function(e,t,r){var n=e("./parser"),i=e("./utils"),o=i;function s(e,t){this.name="NonSupportedSparqlFeatureError",this.feature=e,this.message=t||"SPARQL feature "+e+" non supported"}function a(e){this.name=ParserError,this.message=e||"Error parsing SPARQL query"}s.prototype=new Error,s.constructor=s,a.prototype=new Error,a.constructor=a,AbstractQueryTree=function(){},AbstractQueryTree.prototype.parseQueryString=function(e){return n.parse(e)},AbstractQueryTree.prototype.parseExecutableUnit=function(e){if("select"===e.kind)return this.parseSelect(e);if("ask"===e.kind)return this.parseSelect(e);if("modify"===e.kind)return this.parseSelect(e);if("construct"===e.kind)return this.parseSelect(e);if("insertdata"===e.kind)return this.parseInsertData(e);if("deletedata"===e.kind)return this.parseInsertData(e);if("load"===e.kind)return e;if("clear"===e.kind)return e;if("drop"===e.kind)return e;if("create"===e.kind)return e;throw new Error("unknown executable unit: "+e.kind)},AbstractQueryTree.prototype.parseSelect=function(e){if(null==e)return console.log("error parsing query"),null;return e.pattern=this.build(e.pattern,{freshCounter:0}),e},AbstractQueryTree.prototype.parseInsertData=function(e){return null==e?(console.log("error parsing query"),null):e},AbstractQueryTree.prototype.build=function(e,t){if("groupgraphpattern"===e.token)return this._buildGroupGraphPattern(e,t);if("basicgraphpattern"===e.token){var r={kind:"BGP",value:e.triplesContext};return r=AbstractQueryTree.translatePathExpressionsInBGP(r,t)}if("graphunionpattern"===e.token)return{kind:"UNION",value:[this.build(e.value[0],t),this.build(e.value[1],t)]};if("graphgraphpattern"===e.token)return{kind:"GRAPH",value:this.build(e.value,t),graph:e.graph};throw null!=e.token?new s(e.token,"Non implemented SPARQL graph pattern: '"+e.token+"'"):new a("Error parsing graph pattern: '"+JSON.stringify(e)+"'")},AbstractQueryTree.translatePathExpressionsInBGP=function(e,t){for(var r,n,i,s=[],a=0;a<e.value.length;a++)if(e.value[a].predicate&&"path"===e.value[a].predicate.token){r=e.value[a],n=e.value.slice(a+1);var l=AbstractQueryTree.translatePathExpression(r,t),u=null;if("BGP"!==l.kind){if("ZERO_OR_MORE_PATH"===l.kind||"ONE_OR_MORE_PATH"===l.kind){if(i=s.length>0?{kind:"JOIN",lvalue:{kind:"BGP",value:s},rvalue:l}:l,"ZERO_OR_MORE_PATH"===l.kind)if("var"===l.y.token&&0===l.y.value.indexOf("fresh:")&&"var"===l.x.token&&0===l.x.value.indexOf("fresh:"))for(var c=0;c<e.value.length;c++)e.value[c].object&&"var"===e.value[c].object.token&&e.value[c].object.value===l.x.value&&((u=o.clone(e.value[c],!0)).object=l.y);else if("var"===l.y.token&&0===l.y.value.indexOf("fresh:"))for(c=0;c<e.value.length;c++)e.value[c].subject&&"var"===e.value[c].subject.token&&e.value[c].subject.value===l.y.value&&((u=o.clone(e.value[c],!0)).subject=l.x);if(n.length>0){var f=AbstractQueryTree.translatePathExpressionsInBGP({kind:"BGP",value:n},t);return null!=u?{kind:"UNION",value:[{kind:"JOIN",lvalue:i,rvalue:f},{kind:"BGP",value:s.concat([u]).concat(n)}]}:{kind:"JOIN",lvalue:i,rvalue:f}}return i}return l}s=s.concat(l.value)}else s.push(e.value[a]);return e.value=s,e},AbstractQueryTree.translatePathExpression=function(e,t){if("element"===e.predicate.kind)return"+"===e.predicate.modifier?(e.predicate.modifier=null,{kind:"ONE_OR_MORE_PATH",path:AbstractQueryTree.translatePathExpression(e,t),x:e.subject,y:e.object}):"*"===e.predicate.modifier?(e.predicate.modifier=null,{kind:"ZERO_OR_MORE_PATH",path:AbstractQueryTree.translatePathExpression(e,t),x:e.subject,y:e.object}):(e.predicate=e.predicate.value,{kind:"BGP",value:[e]});if("sequence"===e.predicate.kind){for(var r,n,i=e.subject,a=e.object,l=e.graph,u=[],c=0;c<e.predicate.value.length;c++)c!=e.predicate.value.length-1?(r={token:"var",value:"fresh:"+t.freshCounter},t.freshCounter++):r=a,n={subject:i,predicate:e.predicate.value[c],object:r},null!=l&&(n.graph=o.clone(l,!0)),u.push(n),c!=e.predicate.value.length-1&&(i=o.clone(r,!0));var f={kind:"BGP",value:u};return AbstractQueryTree.translatePathExpressionsInBGP(f,t)}throw new s("Non supported path expression "+e.predicate.kind)},AbstractQueryTree.prototype._buildGroupGraphPattern=function(e,t){for(var r=e.filters||[],n=e.binds||[],i={kind:"EMPTY_PATTERN"},o=0;o<e.patterns.length;o++){var s=e.patterns[o];if("optionalgraphpattern"===s.token){i="FILTER"===(a=this.build(s.value,t)).kind?{kind:"LEFT_JOIN",lvalue:i,rvalue:a.value,filter:a.filter}:{kind:"LEFT_JOIN",lvalue:i,rvalue:a,filter:!0}}else{var a=this.build(s,t);i="EMPTY_PATTERN"==i.kind?a:{kind:"JOIN",lvalue:i,rvalue:a}}}if(i.binds=n,0!=r.length){if("EMPTY_PATTERN"===i.kind)return{kind:"FILTER",filter:r,value:i};if("LEFT_JOIN"===i.kind&&!0===i.filter)return{kind:"FILTER",filter:r,value:i};if("LEFT_JOIN"===i.kind)return{kind:"FILTER",filter:r,value:i};if("JOIN"===i.kind)return{kind:"FILTER",filter:r,value:i};if("UNION"===i.kind)return{kind:"FILTER",filter:r,value:i};if("GRAPH"===i.kind)return{kind:"FILTER",filter:r,value:i};if("BGP"===i.kind)return{kind:"FILTER",filter:r,value:i};throw new Error("Unknow kind of algebra expression: "+i.kind)}return i},AbstractQueryTree.prototype.collectBasicTriples=function(e,t){if(null==t&&(t=[]),"select"===e.kind)t=this.collectBasicTriples(e.pattern,t);else if("BGP"===e.kind)t=t.concat(e.value);else if("ZERO_OR_MORE_PATH"===e.kind)t=this.collectBasicTriples(e.path);else if("UNION"===e.kind)t=this.collectBasicTriples(e.value[0],t),t=this.collectBasicTriples(e.value[1],t);else if("GRAPH"===e.kind)t=this.collectBasicTriples(e.value,t);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)t=this.collectBasicTriples(e.lvalue,t),t=this.collectBasicTriples(e.rvalue,t);else if("FILTER"===e.kind)t=this.collectBasicTriples(e.value,t);else if("construct"===e.kind)t=this.collectBasicTriples(e.pattern,t);else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return t},AbstractQueryTree.prototype.bind=function(e,t){if(null!=e.graph&&e.graph.token&&"var"===e.graph.token&&null!=t[e.graph.value]&&(e.graph=t[e.graph.value]),null!=e.filter){for(var r=[],n=0;n<e.filter.length;n++)e.filter[n].value=this._bindFilter(e.filter[n].value,t),r.push(e.filter[n]);e.filter=r}if("select"===e.kind)e.pattern=this.bind(e.pattern,t);else if("BGP"===e.kind)e.value=this._bindTripleContext(e.value,t);else if("ZERO_OR_MORE_PATH"===e.kind)e.path=this._bindTripleContext(e.path,t),e.x&&"var"===e.x.token&&null!=t[e.x.value]&&(e.x=t[e.x.value]),e.y&&"var"===e.y.token&&null!=t[e.y.value]&&(e.y=t[e.y.value]);else if("UNION"===e.kind)e.value[0]=this.bind(e.value[0],t),e.value[1]=this.bind(e.value[1],t);else if("GRAPH"===e.kind)e.value=this.bind(e.value,t);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)e.lvalue=this.bind(e.lvalue,t),e.rvalue=this.bind(e.rvalue,t);else if("FILTER"===e.kind){var i=this;e.value=this.bind(e.value,t),e.filter=e.filter.map((function(e){return{token:"filter",value:i._bindFilter(e.value,t)}}))}else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return e},AbstractQueryTree.prototype._bindTripleContext=function(e,t){for(var r=0;r<e.length;r++)for(var n in delete e[r].graph,delete e[r].variables,e[r]){var i=e[r][n];"var"===i.token&&null!=t[i.value]&&(e[r][n]=t[i.value])}return e},AbstractQueryTree.prototype._bindFilter=function(e,t){if(null!=e.expressionType){var r=e.expressionType;if("relationalexpression"==r)e.op1=this._bindFilter(e.op1,t),e.op2=this._bindFilter(e.op2,t);else if("conditionalor"==r||"conditionaland"==r)for(var n=0;n<e.operands.length;n++)e.operands[n]=this._bindFilter(e.operands[n],t);else if("additiveexpression"==r){e.summand=this._bindFilter(e.summand,t);for(n=0;n<e.summands.length;n++)e.summands[n].expression=this._bindFilter(e.summands[n].expression,t)}else if("builtincall"==r)for(n=0;n<e.args.length;n++)e.args[n]=this._bindFilter(e.args[n],t);else if("multiplicativeexpression"==r){e.factor=this._bindFilter(e.factor,t);for(n=0;n<e.factors.length;n++)e.factors[n].expression=this._bindFilter(e.factors[n].expression,t)}else if("unaryexpression"==r)e.expression=this._bindFilter(e.expression,t);else if("irireforfunction"==r)for(n=0;n<e.factors.args;n++)e.args[n]=this._bindFilter(e.args[n],t);else if("atomic"==r&&"var"==e.primaryexpression&&null!=t[e.value.value]){var i=t[e.value.value];"uri"===i.token?e.primaryexpression="iri":e.primaryexpression="literal",e.value=i}}return e},AbstractQueryTree.prototype.replace=function(e,t,r,n){if(null!=e.graph&&e.graph.token&&e.graph.token===t.token&&e.graph.value==t.value&&(e.graph=o.clone(r,!0)),null!=e.filter){for(var i=[],s=0;s<e.filter.length;s++)e.filter[s].value=this._replaceFilter(e.filter[s].value,t,r,n),i.push(e.filter[s]);e.filter=i}if("select"===e.kind)e.pattern=this.replace(e.pattern,t,r,n);else if("BGP"===e.kind)e.value=this._replaceTripleContext(e.value,t,r,n);else if("ZERO_OR_MORE_PATH"===e.kind)e.path=this._replaceTripleContext(e.path,t,r,n),e.x&&e.x.token===t.token&&e.value===t.value&&(e.x=o.clone(r,!0)),e.y&&e.y.token===t.token&&e.value===t.value&&(e.y=o.clone(r,!0));else if("UNION"===e.kind)e.value[0]=this.replace(e.value[0],t,r,n),e.value[1]=this.replace(e.value[1],t,r,n);else if("GRAPH"===e.kind)e.value=this.replace(e.value,t,r);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)e.lvalue=this.replace(e.lvalue,t,r,n),e.rvalue=this.replace(e.rvalue,t,r,n);else if("FILTER"===e.kind)e.value=this._replaceFilter(e.value,t,r,n);else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return e},AbstractQueryTree.prototype._replaceTripleContext=function(e,t,r,n){for(var o=0;o<e.length;o++)for(var s in e[o]){var a=e[o][s];"var"===a.token&&"var"===t.token&&a.value===t.value||"blank"===a.token&&"blank"===t.token&&a.value===t.value?e[o][s]=r:"literal"!==a.token&&"uri"!==a.token||"literal"!==t.token&&"uri"!==t.token||a.token!==t.token||i.lexicalFormTerm(a,n)[a.token]!==i.lexicalFormTerm(t,n)[a.token]||(e[o][s]=r)}return e},AbstractQueryTree.prototype._replaceFilter=function(e,t,r,n){if(null!=e.expressionType){var i=e.expressionType;if("relationalexpression"==i)e.op1=this._replaceFilter(e.op1,t,r,n),e.op2=this._replaceFilter(e.op2,t,r,n);else if("conditionalor"==i||"conditionaland"==i)for(var o=0;o<e.operands.length;o++)e.operands[o]=this._replaceFilter(e.operands[o],t,r,n);else if("additiveexpression"==i){e.summand=this._replaceFilter(e.summand,t,r,n);for(o=0;o<e.summands.length;o++)e.summands[o].expression=this._replaceFilter(e.summands[o].expression,t,r,n)}else if("builtincall"==i)for(o=0;o<e.args.length;o++)e.args[o]=this._replaceFilter(e.args[o],t,r,n);else if("multiplicativeexpression"==i){e.factor=this._replaceFilter(e.factor,t,r,n);for(o=0;o<e.factors.length;o++)e.factors[o].expression=this._replaceFilter(e.factors[o].expression,t,r,n)}else if("unaryexpression"==i)e.expression=this._replaceFilter(e.expression,t,r,n);else if("irireforfunction"==i)for(o=0;o<e.factors.args;o++)e.args[o]=this._replaceFilter(e.args[o],t,r,n);else if("atomic"==i){var s=null;(e.primaryexpression==t.token&&e.value==t.value||"iri"==e.primaryexpression&&"uri"==t.token&&e.value==t.value)&&(s=r.value),null!=s&&("uri"===r.token?e.primaryexpression="iri":e.primaryexpression=r.token,e.value=s)}}return e},AbstractQueryTree.prototype.treeWithUnion=function(e){if(null==e)return!1;if(null==e.kind)return!1;if("select"===e.kind)return this.treeWithUnion(e.pattern);if("BGP"===e.kind)return this.treeWithUnion(e.value);if("ZERO_OR_MORE_PATH"===e.kind)return!1;if("UNION"===e.kind){if(null==e.value[0].value||null==e.value[0].value.variables||null==e.value[1].value||null==e.value[1].value.variables)return!0;if(e.value[0].variables.join("/")===e.values[1].variables.join("/"))return!!this.treeWithUnion(e.value[0])||this.treeWithUnion(e.value[1])}else{if("GRAPH"===e.kind)return!1;if("LEFT_JOIN"!==e.kind&&"JOIN"!==e.kind)return"FILTER"===e.kind||e.kind,!1;if(this.treeWithUnion(e.lvalue))return!0;this.treeWithUnion(e.rvalue)}},t.exports={AbstractQueryTree:AbstractQueryTree,NonSupportedSparqlFeatureError:s,SparqlParserError:a}},{"./parser":128,"./utils":140}],123:[function(e,t,r){"use strict";var n=e("./utils"),i=n,o=n.nextTick,s=function(e,t){if(0!=arguments.length){this.order=e,this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0;var r=this;this._diskWrite(this.root,(function(e){r.root=e,r._updateRootNode(r.root,(function(e){r.comparator=function(e,t){return e<t?-1:e>t?1:0},r.merger=null,null!=t&&t(r)}))}))}};s.prototype._allocateNode=function(){return new a},s.prototype._diskWrite=function(e,t){o((function(){t(e)}))},s.prototype._diskRead=function(e,t){o((function(){t(e)}))},s.prototype._diskDelete=function(e,t){o((function(){t()}))},s.prototype._updateRootNode=function(e,t){t(e)},s.prototype.search=function(e,t,r){var n=this.root;this.__search(this,e,n,t,r)},s.prototype.__search=function(e,t,r,n,i){for(var o=0;o<r.numberActives&&1===e.comparator(t,r.keys[o].key);)o++;o<r.numberActives&&0===e.comparator(r.keys[o].key,t)?n(null!=i&&1==i||r.keys[o].data):!0===r.isLeaf?n(null):e._diskRead(r.children[o],(function(r){e.__search(e,t,r,n,i)}))},s.prototype.walk=function(e,t){this.__walk(this,this.root,e,t)},s.prototype.__walk=function(e,t,r,n){var o=t.numberActives,s=0;if(t.isLeaf){for(s=0;s<t.numberActives;s++)r(t.keys[s]);return n()}i.whilst((function(){return s<o}),(function(n){e._diskRead(t.children[s],(function(i){e.__walk(e,i,r,(function(){e._diskRead(t.keys[s],(function(e){r(e),s++,n()}))}))}))}),(function(){e._diskRead(t.children[o],(function(t){e.__walk(e,t,r,(function(){n()}))}))}))},s.prototype.walkNodes=function(e){this.__walkNodes(this,root,e,(function(){}))},s.prototype.__walkNodes=function(e,t,r,n){if(t.isLeaf)return r(t),n();r(t);var o=t.numberActives,s=0;i.whilst((function(){return s<o}),(function(n){e._diskRead(t.children[s],(function(t){e.__walkNodes(e,t,r,(function(){s++,n()}))}))}),(function(){e._diskRead(t.children[o],(function(t){e.__walkNodes(e,t,r,(function(){}))}))}))},s.prototype._splitChild=function(e,t,r,n){var i=this._allocateNode();i.isLeaf=r.isLeaf,i.level=r.level,i.numberActives=this.order-1;var o=r.keys[this.order-1];r.keys[this.order-1]=null;for(var s=0;s<this.order-1;s++)i.keys[s]=r.keys[s+this.order],r.keys[s+this.order]=null,r.isLeaf||(i.children[s]=r.children[s+this.order],r.children[s+this.order]=null);for(r.isLeaf||(i.children[s]=r.children[s+this.order],r.children[s+this.order]=null),r.numberActives=this.order-1,s=e.numberActives+1;s>t+1;s--)e.children[s]=e.children[s-1];for(e.children[t+1]=i,s=e.numberActives;s>t;s--)e.keys[s]=e.keys[s-1];e.keys[t]=o,e.numberActives++;var a=this;this._diskWrite(i,(function(i){a._diskWrite(e,(function(e){e.children[t+1]=i,a._diskWrite(r,(function(t){return n(e)}))}))}))},s.prototype.insert=function(e,t,r){if(this.root.numberActives===2*this.order-1){var n=this._allocateNode();n.isLeaf=!1,n.level=this.root.level+1,n.numberActives=0,n.children[0]=this.root;var i=this;this._splitChild(n,0,this.root,(function(o){n=o,i.root=n,i._updateRootNode(n,(function(n){i._insertNonFull(n,e,t,r)}))}))}else this._insertNonFull(this.root,e,t,r)},s.prototype._insertNonFull=function(e,t,r,n){var i=e.numberActives-1;this.__insertNonFull(this,e,i,t,r,n)},s.prototype.__insertNonFull=function(e,t,r,n,i,o){if(t.isLeaf){for(;r>=0&&-1===e.comparator(n,t.keys[r].key);)t.keys[r+1]=t.keys[r],r--;r>=0&&0===e.comparator(n,t.keys[r].key)?t.keys[r]={key:n,data:i}:(t.keys[r+1]={key:n,data:i},t.numberActives++),e._diskWrite(t,(function(e){return o(e)}))}else{for(;r>=0&&-1===e.comparator(n,t.keys[r].key);)r--;r++;var s=e;e._diskRead(t.children[r],(function(a){a.numberActives===2*s.order-1?s._splitChild(t,r,a,(function(){1===s.comparator(n,t.keys[r].key)&&r++,s._diskRead(t.children[r],(function(t){r=t.numberActives-1,s.__insertNonFull(e,t,r,n,i,o)}))})):s._diskRead(t.children[r],(function(t){r=t.numberActives-1,s.__insertNonFull(e,t,r,n,i,o)}))}))}},s.prototype.delete=function(e,t){var r=this.root;s.prototype.__deleteSearchNode(this,e,r,t)},s.prototype.__deleteSearchNode=function(e,t,r,n){var i=0;if(0===r.numberActives)return n(!1);for(;i<r.numberActives&&1===e.comparator(t,r.keys[i].key);)i++;var o=i;if(i<r.numberActives&&0===e.comparator(t,r.keys[i].key))return e.__deleteNodeFound(e,o,t,r,n);if(!0===r.isLeaf)return n(!1);var s=r;e._diskRead(r.children[i],(function(r){if(null===r)return n(!1);var a=!1,l=!1,u=null,c=null;o===s.numberActives?(l=!0,c=s.children[o-1],u=s.children[o-1]):0===o?(a=!0,u=s.children[1],c=s.children[1]):(c=s.children[o-1],u=s.children[o+1]),e._diskRead(c,(function(o){e._diskRead(u,(function(u){!0===l&&(u=null),!0===a&&(o=null),r.numberActives===e.order-1&&null!=s?null!=u&&u.numberActives>e.order-1?e._moveKey(s,i,-1,(function(i){e.__deleteSearchNode(e,t,r,n)})):null!=o&&o.numberActives>e.order-1?e._moveKey(s,i,1,(function(i){e.__deleteSearchNode(e,t,r,n)})):null!=o&&o.numberActives===e.order-1?e._mergeSiblings(s,i,-1,(function(r){e.__deleteSearchNode(e,t,r,n)})):null!=u&&u.numberActives===e.order-1&&e._mergeSiblings(s,i,1,(function(r){e.__deleteSearchNode(e,t,r,n)})):e.__deleteSearchNode(e,t,r,n)}))}))}))},s.prototype.__deleteNodeFound=function(e,t,r,n,i){return n.isLeaf&&n.numberActives>e.order-1||n.isLeaf&&n===e.root?(e._deleteKeyFromNode(n,t,(function(){i(!0)})),!0):(!1===n.isLeaf&&e._diskRead(n.children[t],(function(o){o.numberActives>e.order-1?e._getMaxKeyPos(e,o,(function(s){r=s.node.keys[s.index],n.keys[t]=r,e._diskWrite(n,(function(t){t=o,r=r.key,e.__deleteSearchNode(e,r,t,i)}))})):e._diskRead(n.children[t+1],(function(s){s.numberActives>e.order-1?e._getMinKeyPos(e,s,(function(o){r=o.node.keys[o.index],n.keys[t]=r,e._diskWrite(n,(function(t){t=s,r=r.key,e.__deleteSearchNode(e,r,t,i)}))})):o.numberActives===e.order-1&&s.numberActives===e.order-1&&e._mergeNodes(o,n.keys[t],s,(function(o){n.children[t]=o;for(var s=++t;s<n.numberActives;s++)n.children[s]=n.children[s+1],n.keys[s-1]=n.keys[s];n.children[s]=null,n.keys[s-1]=null,n.numberActives--,0===n.numberActives&&e.root===n&&(e.root=o),e._diskWrite(n,(function(t){e.__deleteSearchNode(e,r,o,i)}))}))}))})),void(n.isLeaf&&n.numberActives>e.order-1&&e._deleteKeyFromNode(n,t,(function(t){e.__deleteSearchNode(e,r,t,i)}))))},s.prototype._moveKey=function(e,t,r,n){1===r&&t--;var i=this;i._diskRead(e.children[t],(function(o){i._diskRead(e.children[t+1],(function(s){if(-1==r){o.keys[o.numberActives]=e.keys[t],o.children[o.numberActives+1]=s.children[0],s.children[0]=null,o.numberActives++,e.keys[t]=s.keys[0];for(var a=1;a<s.numberActives;a++)s.keys[a-1]=s.keys[a],s.children[a-1]=s.children[a];s.children[s.numberActives-1]=s.children[s.numberActives],s.numberActives--}else{s.children[s.numberActives+1]=s.children[s.numberActives];for(a=s.numberActives;a>0;a--)s.children[a]=s.children[a-1],s.keys[a]=s.keys[a-1];s.keys[0]=null,s.children[0]=null,s.children[0]=o.children[o.numberActives],s.keys[0]=e.keys[t],s.numberActives++,o.children[o.numberActives]=null,e.keys[t]=o.keys[o.numberActives-1],o.keys[o.numberActives-1]=null,o.numberActives--}i._diskWrite(o,(function(t){i._diskWrite(s,(function(t){i._diskWrite(e,(function(e){return n(e)}))}))}))}))}))},s.prototype._mergeSiblings=function(e,t,r,n){var i,o,s,a;t===e.numberActives?(t--,s=e.children[e.numberActives-1],a=e.children[e.numberActives]):(s=e.children[t],a=e.children[t+1]);var l=this;l._diskRead(s,(function(r){l._diskRead(a,(function(s){var a=l._allocateNode();for(a.isLeaf=r.isLeaf,a.level=r.level,o=0;o<l.order-1;o++)a.keys[o]=r.keys[o],a.children[o]=r.children[o];for(a.keys[l.order-1]=e.keys[t],a.children[l.order-1]=r.children[l.order-1],o=0;o<l.order-1;o++)a.keys[o+l.order]=s.keys[o],a.children[o+l.order]=s.children[o];for(a.children[2*l.order-1]=s.children[l.order-1],e.children[t]=a,o=t;o<e.numberActives;o++)e.keys[o]=e.keys[o+1],e.children[o+1]=e.children[o+2];for(a.numberActives=r.numberActives+s.numberActives+1,e.numberActives--,i=e.numberActives;i<2*l.order-1;i++)e.keys[i]=null;0===e.numberActives&&l.root===e&&(l.root=a,a.level?a.isLeaf=!1:a.isLeaf=!0),l._diskWrite(a,(function(t){l._diskWrite(e,(function(e){l._diskDelete(r,(function(){l._diskDelete(s,(function(){if(l.root!==t)return n(t);l._updateRootNode(l.root,(function(){return n(t)}))}))}))}))}))}))}))},s.prototype._deleteKeyFromNode=function(e,t,r){var n,i=2*this.order-1;if(e.numberActives<i&&(i=e.numberActives),!1===e.isLeaf)return!1;e.keys[t];for(n=t;n<i-1;n++)e.keys[n]=e.keys[n+1];e.keys.pop(),e.numberActives--,this._diskWrite(e,(function(e){return r(e)}))},s.prototype._mergeNodes=function(e,t,r,n){var i,o;for((i=this._allocateNode()).isLeaf=!0,o=0;o<e.numberActives;o++)i.keys[o]=e.keys[o],i.children[o]=e.children[o];for(i.children[e.numberActives]=e.children[e.numberActives],i.keys[e.numberActives]=t,o=0;o<r.numberActives;o++)i.keys[o+e.numberActives+1]=r.keys[o],i.children[o+e.numberActives+1]=r.children[o];i.children[2*this.order-1]=r.children[r.numberActives],i.numberActives=e.numberActives+r.numberActives+1,i.isLeaf=e.isLeaf,i.level=e.level;var s=this;this._diskWrite(i,(function(t){s._diskDelete(e,(function(){s._diskDelete(r,(function(){return n(t)}))}))}))},s.prototype.audit=function(e){var t=[],r=[],n=this,i=function(i){for(var o=0;o<r.length;o++)if(0===n.comparator(r[o],i)){var s=" !!! duplicated key "+i;!0===e&&console.log(s),t.push(s)}},o=null;n=this;return this.walkNodes((function(s){!0===e&&(console.log("--- Node at "+s.level+" level"),console.log(" - leaf? "+s.isLeaf),console.log(" - num actives? "+s.numberActives),console.log(" - keys: "));for(var a=s.numberActives;a<s.keys.length;a++)null!=s.keys[a]&&!0===e&&(console.log(" * warning : redundant key data"),t.push(" * warning : redundant key data"));for(a=s.numberActives+1;a<s.children.length;a++)null!=s.children[a]&&!0===e&&(console.log(" * warning : redundant children data"),t.push(" * warning : redundant key data"));if(!1===s.isLeaf)for(a=0;a<s.numberActives;a++){var l=this._diskRead(s.children[a]).keys[this._diskRead(s.children[a]).numberActives-1].key,u=this._diskRead(s.children[a+1]).keys[0].key;if(!0===e&&console.log("   "+s.keys[a].key+"("+l+","+u+")"),-1===n.comparator(s.keys[a].key,l)){var c=" !!! value max left "+l+" > key "+s.keys[a].key;!0===e&&console.log(c),t.push(c)}if(1===n.comparator(s.keys[a].key,u)){c=" !!! value min right "+u+" < key "+s.keys[a].key;!0===e&&console.log(c),t.push(c)}i(s.keys[a].key),r.push(s.keys[a].key)}else{if(null===o)o=s.level;else if(o!=s.level){c=" !!! Leaf node with wrong level value";!0===e&&console.log(c),t.push(c)}for(a=0;a<s.numberActives;a++)!0===e&&console.log(" "+s.keys[a].key),i(s.keys[a].key),r.push(s.keys[a].key)}if(s!=n.root){if(s.numberActives>2*n.order-1){if(!0===e)c=" !!!! MAX num keys restriction violated ";console.log(c),t.push(c)}if(s.numberActives<n.order-1){if(!0===e)c=" !!!! MIN num keys restriction violated ";console.log(c),t.push(c)}}})),t},s.prototype._getMaxKeyPos=function(e,t,r){var n={};return null===t?r(null):!0===t.isLeaf?(n.node=t,n.index=t.numberActives-1,r(n)):(n.node=t,n.index=t.numberActives-1,void e._diskRead(t.children[t.numberActives],(function(t){return e._getMaxKeyPos(e,t,r)})))},s.prototype._getMinKeyPos=function(e,t,r){var n={};if(null===t&&r(null),!0===t.isLeaf)return n.node=t,n.index=0,r(n);n.node=t,n.index=0,e._diskRead(t.children[0],(function(t){return e._getMinKeyPos(e,t,r)}))};var a=function(){this.numberActives=0,this.isLeaf=null,this.keys=[],this.children=[],this.level=0};t.exports={Tree:s,Node:a}},{"./utils":140}],124:[function(e,t,r){var n=e("./utils"),i=e("./utils"),o=(e("./quad_index").QuadIndex,e("./quad_index").Pattern),s=e("./rdf_model"),a=e("./abstract_query_tree").AbstractQueryTree;Callbacks={},Callbacks.ANYTHING={token:"var",value:"_"},Callbacks.added="added",Callbacks.deleted="deleted",Callbacks.eventsFlushed="eventsFlushed",Callbacks.CallbacksBackend=function(){this.aqt=new a,this.engine=arguments[0],this.indexMap={},this.observersMap={},this.queriesIndexMap={},this.emptyNotificationsMap={},this.queriesList=[],this.pendingQueries=[],this.matchedQueries=[],this.updateInProgress=null,this.indices=["SPOG","GP","OGS","POG","GSP","OS"],this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},this.callbackCounter=0,this.callbacksMap={},this.callbacksInverseMap={},this.queryCounter=0,this.queriesMap={},this.queriesCallbacksMap={},this.queriesInverseMap={};for(var e=0;e<this.indices.length;e++){var t=this.indices[e];this.indexMap[t]={},this.queriesIndexMap[t]={}}},Callbacks.CallbacksBackend.prototype.startGraphModification=function(){!0!==this.ongoingModification&&(this.pendingQueries=[].concat(this.queriesList),this.matchedQueries=[],null==this.updateInProgress&&(this.updateInProgress={},this.updateInProgress[Callbacks.added]=[],this.updateInProgress[Callbacks.deleted]=[]))},Callbacks.CallbacksBackend.prototype.nextGraphModification=function(e,t){this.updateInProgress[e].push(t)},Callbacks.CallbacksBackend.prototype.endGraphModification=function(e){if(!0!==this.ongoingModification){var t=this;if(null!=this.updateInProgress){var r=t.updateInProgress;t.updateInProgress=null,this.sendNotification(Callbacks.deleted,r[Callbacks.deleted],(function(){t.sendNotification(Callbacks.added,r[Callbacks.added],(function(){t.sendEmptyNotification(Callbacks.eventsFlushed,null,(function(){t.dispatchQueries((function(){e(!0)}))}))}))}))}else e(!0)}else e(!0)},Callbacks.CallbacksBackend.prototype.cancelGraphModification=function(){!0!==this.ongoingModification&&(this.updateInProgress=null)},Callbacks.CallbacksBackend.prototype.sendNotification=function(e,t,r){for(var n={},i=0;i<t.length;i++){var o=t[i];for(var s in this.indexMap){var a=this.indexMap[s],l=this.componentOrders[s];this._searchCallbacksInIndex(a,l,e,o,n),0!=this.pendingQueries.length&&(a=this.queriesIndexMap[s],this._searchQueriesInIndex(a,l,o))}}this.dispatchNotifications(n),null!=r&&r(!0)},Callbacks.CallbacksBackend.prototype.sendEmptyNotification=function(e,t,r){for(var n=this.emptyNotificationsMap[e]||[],i=0;i<n.length;i++)n[i](e,t);r()},Callbacks.CallbacksBackend.prototype.dispatchNotifications=function(e){for(var t in e){var r=this.callbacksMap[t],n=e[t][Callbacks.deleted];if(null!=n)try{r(Callbacks.deleted,n)}catch(e){}for(var i in e[t])if(i!=Callbacks.deleted)try{r(i,e[t][i])}catch(e){}}},Callbacks.CallbacksBackend.prototype._searchCallbacksInIndex=function(e,t,r,n,i){for(var o=n[1],s=(n=n[0],0);s<t.length+1;s++){for(var a=e._||[],l=[],u=0;u<a.length;u++){var c=a[u];null!=this.callbacksMap[c]&&(i[c]=i[c]||{},i[c][r]=i[c][r]||[],i[c][r].push(n),l.push(c))}e._=l;var f=t[s];if(null==e[""+o[f]])break;e=e[""+o[f]]}},Callbacks.CallbacksBackend.prototype.subscribeEmpty=function(e,t){var r=this.emptyNotificationsMap[e]||[];r.push(t),this.emptyNotificationsMap[e]=r},Callbacks.CallbacksBackend.prototype.unsubscribeEmpty=function(e,t){var r=this.emptyNotificationsMap[e];null!=r&&(r=n.reject(r,(function(e){return e===t}))),this.emptyNotificationsMap[e]=r},Callbacks.CallbacksBackend.prototype.subscribe=function(e,t,r,n,i,s){var a=this._tokenizeComponents(e,t,r,n),l={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,l);var u=this;this.engine.normalizeQuad(a,l,!0,(function(e){for(var t=new o(e),r=u._indexForPattern(t),n=u.componentOrders[r],a=u.indexMap[r],l=0;l<n.length;l++){var c=e[n[l]];if("_"===c){null==a._&&(a._=[]),u.callbackCounter++,a._.push(u.callbackCounter),u.callbacksMap[u.callbackCounter]=i,u.callbacksInverseMap[i]=u.callbackCounter;break}l===n.length-1?(a[c]=a[c]||{_:[]},u.callbackCounter++,a[c]._.push(u.callbackCounter),u.callbacksMap[u.callbackCounter]=i,u.callbacksInverseMap[i]=u.callbackCounter):(a[c]=a[c]||{},a=a[c])}null!=s&&s(!0)}))},Callbacks.CallbacksBackend.prototype.unsubscribe=function(e){var t=this.callbacksInverseMap[e];null!=t&&(delete this.callbacksInverseMap[e],delete this.callbacksMap[t])},Callbacks.CallbacksBackend.prototype._tokenizeComponents=function(e,t,r,n){var i={};return null==e?i.subject=Callbacks.ANYTHING:0==e.indexOf("_:")?i.subject={token:"blank",value:e}:i.subject={token:"uri",value:e},i.predicate=null==t?Callbacks.ANYTHING:{token:"uri",value:t},i.object=null==r?Callbacks.ANYTHING:{token:"uri",value:r},i.graph=null==n?Callbacks.ANYTHING:{token:"uri",value:n},i},Callbacks.CallbacksBackend.prototype._indexForPattern=function(e){for(var t=e.indexKey,r=this.indices,i=0;i<r.length;i++)for(var o=r[i],s=this.componentOrders[o],a=0;a<s.length&&!1!==n.include(t,s[a]);a++)if(a==t.length-1)return o;return"SPOG"},Callbacks.CallbacksBackend.prototype.observeNode=function(){var e,t,r,n;4===arguments.length?(e=arguments[0],t=arguments[1],r=arguments[2],n=arguments[3]):(e=arguments[0],t=this.engine.lexicon.defaultGraphUri,r=arguments[1],n=arguments[2]);var i="CONSTRUCT { <"+e+"> ?p ?o } WHERE { GRAPH <"+t+"> { <"+e+"> ?p ?o } }",o=this,a={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,a);var l=[];this.engine.execute(i,(function(t,i){if(t)n&&n(!1);else{var u=i,c=!1,f=function(e,t){if("eventsFlushed"===e&&c){c=!1;try{r(u)}catch(e){}}else if("eventsFlushed"!==e){c=!0;for(var n=0;n<t.length;n++){var i=t[n],f=s.buildRDFResource(i.subject,l,o.engine,a),p=s.buildRDFResource(i.predicate,l,o.engine,a),d=s.buildRDFResource(i.object,l,o.engine,a);null!=f&&null!=p&&null!=d&&(i=new s.Triple(f,p,d),e===Callbacks.added?u.add(i):e===Callbacks.deleted&&u.remove(i))}}};o.observersMap[r]=f,o.subscribeEmpty(Callbacks.eventsFlushed,f),o.subscribe(e,null,null,null,f,(function(){try{r(u)}catch(e){}n&&n(!0)}))}}))},Callbacks.CallbacksBackend.prototype.stopObservingNode=function(e){var t=this.observersMap[e];return!!t&&(this.unsubscribe(t),this.unsubscribeEmpty(Callbacks.eventsFlushed,t),!0)},Callbacks.CallbacksBackend.prototype.observeQuery=function(e,t,r){var n=this.aqt.parseQueryString(e),s=this.aqt.parseSelect(n.units[0]),a=this.aqt.collectBasicTriples(s),l=this,u={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,u);var c=this.queryCounter;this.queryCounter++,this.queriesMap[c]=e,this.queriesInverseMap[e]=c,this.queriesList.push(c),this.queriesCallbacksMap[c]=t,i.eachSeries(a,(function(e,t){null==e.graph&&(e.graph=l.engine.lexicon.defaultGraphUriTerm),l.engine.normalizeQuad(e,u,!0,(function(e){for(var r=new o(e),n=l._indexForPattern(r),i=l.componentOrders[n],s=l.queriesIndexMap[n],a=0;a<i.length;a++){var u=e[i[a]];if("string"==typeof u){null==s._&&(s._=[]),s._.push(c);break}a===i.length-1?(s[u]=s[u]||{_:[]},s[u]._.push(c)):(s[u]=s[u]||{},s=s[u])}t()}))}),(function(){l.engine.execute(e,(function(e,r){e?console.log("ERROR in query callback "+r):t(r)})),null!=r&&r()}))},Callbacks.CallbacksBackend.prototype.stopObservingQuery=function(e){var t=this.queriesInverseMap[e];null!=t&&(delete this.queriesInverseMap[e],delete this.queriesMap[t],this.queriesList=n.reject(this.queriesList,(function(e){return e===t})))},Callbacks.CallbacksBackend.prototype._searchQueriesInIndex=function(e,t,r){for(var i=r[1],o=(r=r[0],0);o<t.length+1;o++){for(var s=e._||[],a=[],l=0;l<s.length;l++){var u=s[l];n.include(this.pendingQueries,u)&&(n.remove(this.pendingQueries,(function(e){return e===u})),this.matchedQueries.push(u)),null!=this.queriesMap[u]&&a.push(u)}e._=a;var c=t[o];if(null==e[""+i[c]])break;e=e[""+i[c]]}},Callbacks.CallbacksBackend.prototype.dispatchQueries=function(e){var t,r,n=this,o={};i.eachSeries(this.matchedQueries,(function(e,i){null==o[e]?(o[e]=!0,t=n.queriesMap[e],r=n.queriesCallbacksMap[e],n.engine.execute(t,(function(e,t){if(!e)try{r(t)}catch(e){}i()}))):i()}),(function(){e()}))},Callbacks.CallbacksBackend.added=Callbacks.added,Callbacks.CallbacksBackend.deleted=Callbacks.deleted,Callbacks.CallbacksBackend.eventsFlushed=Callbacks.eventsFlushed,t.exports=Callbacks},{"./abstract_query_tree":122,"./quad_index":132,"./rdf_model":137,"./utils":140}],125:[function(e,t,r){var n=e("jsonld");r.JSONLDParser={};var i=r.JSONLDParser;i.parser={async:!0,parse:function(e,t,r,i){try{"string"==typeof e&&(e=JSON.parse(e)),async function(e,t,r){var i=null;const o=await n.toRDF(e,{});var s=function(e){return"BlankNode"===e.termType?{blank:e.value}:"NamedNode"===e.termType?{token:"uri",value:e.value}:"Literal"===e.termType?null!=e.language?{literal:'"'+e.value+'"@'+e.language}:null!==e.datatype?{literal:'"'+e.value+'"^^<'+e.datatype.value+">"}:{literal:'"'+e.value+'"'}:void 0};i=[];for(var a=function(e,r,n){i.push({subject:s(e),predicate:s(r),object:s(n),graph:t})},l=o,u=0;u<l.length;u++){var c=l[u];a(c.subject,c.predicate,c.object)}r(null,i)}(e,t,i)}catch(e){i(e)}}},t.exports={JSONLDParser:i}},{jsonld:43}],126:[function(e,t,r){var n=e("./utils"),i=e("./btree").Tree;Lexicon=function(e){var t=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,n.seq((function(e){new i(2,(function(r){t.uris=r,e()}))}),(function(e){new i(2,(function(r){t.literals=r,e()}))}),(function(e){new i(2,(function(r){t.knownGraphs=r,e()}))}),(function(e){new i(2,(function(r){t.oidUris=r,e()}))}),(function(e){new i(2,(function(r){t.oidLiterals=r,e()}))}),(function(e){new i(2,(function(r){t.oidBlanks=r,e()}))}))((function(){null!=e&&e(t)}))},Lexicon.prototype.registerGraph=function(e,t,r){e!=this.defaultGraphOid?this.knownGraphs.insert(e,t,(function(){r()})):r()},Lexicon.prototype.registeredGraphs=function(e,t){var r=[];this.knownGraphs.walk((function(t){!0===e?r.push(t.data):r.push(t.key)}),(function(){t(r)}))},Lexicon.prototype.registerUri=function(e,t){var r=this;e===this.defaultGraphUri?t(this.defaultGraphOid):this.uris.search(e,(function(i){if(null==i){var o=r.oidCounter,s="u"+o;r.oidCounter++,n.seq((function(t){r.uris.insert(e,[o,0],(function(){t()}))}),(function(t){r.oidUris.insert(s,e,(function(){t()}))}))((function(){t(o)}))}else o=i[0],i[1]=i[1]+1,t(o)}))},Lexicon.prototype.resolveUri=function(e,t){e===this.defaultGraphUri?t(this.defaultGraphOid):this.uris.search(e,(function(e){t(null!=e?e[0]:-1)}))},Lexicon.prototype.resolveUriCost=function(e,t){e===this.defaultGraphUri?t(0):this.uris.search(e,(function(e){t(null!=e?e[1]:-1)}))},Lexicon.prototype.registerBlank=function(e){var t=this.oidCounter;this.oidCounter++;var r=""+t;this.oidBlanks.insert(r,r,(function(){e(t)}))},Lexicon.prototype.resolveBlank=function(e,t){var r=this;this.oidBlanks.search(e,(function(e){if(null!=e)t(e);else{var n=r.oidCounter;this.oidCounter++,t(""+n)}}))},Lexicon.prototype.resolveBlankCost=function(e,t){t(0)},Lexicon.prototype.registerLiteral=function(e,t){var r=this;this.literals.search(e,(function(i){if(null==i){var o="l"+(s=r.oidCounter);r.oidCounter++,n.seq((function(t){r.literals.insert(e,[s,0],(function(){t()}))}),(function(t){r.oidLiterals.insert(o,e,(function(){t()}))}))((function(){t(s)}))}else{var s=i[0];i[1]=i[1]+1,t(s)}}))},Lexicon.prototype.resolveLiteral=function(e,t){this.literals.search(e,(function(e){t(null!=e?e[0]:-1)}))},Lexicon.prototype.resolveLiteralCost=function(e,t){this.literals.search(e,(function(e){t(null!=e?e[1]:-1)}))},Lexicon.prototype.parseLiteral=function(e){var t;return-1!=(t=e.lastIndexOf("@"))&&'"'===e[t-1]&&null!=e.substring(t,e.length).match(/^@[a-zA-Z\-]+$/g)?{token:"literal",value:e.substring(1,t-1),lang:e.substring(t+1,e.length)}:-1!=(t=e.lastIndexOf("^^"))&&'"'===e[t-1]&&"<"===e[t+2]&&">"===e[e.length-1]?{token:"literal",value:e.substring(1,t-1),type:e.substring(t+3,e.length-1)}:{token:"literal",value:e.substring(1,e.length-1)}},Lexicon.prototype.parseUri=function(e){return{token:"uri",value:e}},Lexicon.prototype.retrieve=function(e,t){var r=this;e===this.defaultGraphOid?t({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):n.seq((function(t,n){r.oidUris.search("u"+e,(function(e){n(null,null!=e?r.parseUri(e):null)}))}),(function(t,n){null==t?r.oidLiterals.search("l"+e,(function(e){n(null,null!=e?r.parseLiteral(e):null)})):n(null,t)}),(function(t,n){null==t?r.oidBlanks.search(""+e,(function(t){n(null,null!=t?{token:"blank",value:"_:"+e}:null)})):n(null,t)}))(null,(function(e,r){t(r)}))},Lexicon.prototype.clear=function(e){var t=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,n.seq((function(e){new i(2,(function(r){t.uris=r,e()}))}),(function(e){new i(2,(function(r){t.literals=r,e()}))}),(function(e){new i(2,(function(r){t.knownGraphs=r,e()}))}),(function(e){new i(2,(function(r){t.oidUris=r,e()}))}),(function(e){new i(2,(function(r){t.oidLiterals=r,e()}))}),(function(e){new i(2,(function(r){t.oidBlanks=r,e()}))}))((function(){null!=e&&e()}))},Lexicon.prototype.unregister=function(e,t,r){var i=this;n.seq((function(r){i._unregisterTerm(e.subject.token,t.subject,r)}),(function(r){i._unregisterTerm(e.predicate.token,t.predicate,r)}),(function(r){i._unregisterTerm(e.object.token,t.object,r)}),(function(r){null!=e.graph?i._unregisterTerm(e.graph.token,t.graph,r):r()}))((function(){r(!0)}))},Lexicon.prototype._unregisterTerm=function(e,t,r){var i=this;if("uri"===e)if(t!=this.defaultGraphOid){var o="u"+t;i.oidUris.search(o,(function(e){i.uris.search(e,(function(s){var a=s[1];""+s[0]==""+t?0===a?n.seq((function(e){i.oidUris.delete(o,(function(){e()}))}),(function(t){i.uris.delete(e,(function(){t()}))}),(function(e){i.knownGraphs.delete(t,(function(){e()}))}))((function(){r()})):i.uris.insert(e,[t,a-1],(function(){r()})):r()}))}))}else r();else if("literal"===e){this.oidCounter++;o="l"+t;i.oidLiterals.search(o,(function(e){i.literals.search(e,(function(s){var a=s[1];""+s[0]==""+t?0===a?n.seq((function(e){i.oidLiterals.delete(o,(function(){e()}))}),(function(t){i.literals.delete(e,(function(){t()}))}))((function(){r()})):i.literals.insert(e,[t,a-1],(function(){r()})):r()}))}))}else"blank"===e?i.oidBlanks.delete(""+t,(function(){r()})):r()},t.exports={Lexicon:Lexicon}},{"./btree":123,"./utils":140}],127:[function(e,t,r){if(!e("./utils").isWorker()){var n=e("http"),i=e("https"),o=e("url");NetworkTransport={load:function(e,t,r,s){var a=null==s?3:s,l=o.parse(e,!0,!0),u={host:l.host,hostname:l.hostname,method:"GET",path:l.path,headers:{host:l.hostname,Accept:t}},c=null;"http:"===l.protocol?(u.port=l.port||80,c=n):"https:"===l.protocol&&(u.port=l.port||443,c=i);var f=c.request(u,(function(e){var n=e.headers,i="";if("2"==(""+e.statusCode)[0])e.on("end",(function(){r(null,{headers:n,data:i})})),e.on("data",(function(e){i+=e}));else if("3"==(""+e.statusCode)[0])if(0==a)r(new Error("Too many redirections"));else{var o=n.Location||n.location;null!=o?NetworkTransport.load(o,t,r,a-1):r(new Error("Redirection without location header"))}else r(new Error("HTTP error: "+e.statusCode))}));f.on("error",r),f.end()}},t.exports={NetworkTransport:NetworkTransport}}},{"./utils":140,http:91,https:20,url:112}],128:[function(e,t,r){t.exports=function(){"use strict";function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?o(e.parts[t][0])+"-"+o(e.parts[t][1]):o(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,i,o=new Array(e.length);for(t=0;t<e.length;t++)o[t]=(i=e[t],r[i.type](i));if(o.sort(),o.length>0){for(t=1,n=1;t<o.length;t++)o[t-1]!==o[t]&&(o[n]=o[t],n++);o.length=n}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,i={},o={DOCUMENT:Pc},s=Pc,a=Ic("[1] QueryUnit"),l=Ic("[2] Query"),u=Ic("[3] Prologue"),c=Ic("[4] BaseDecl"),f="BASE",p=Fc("BASE",!1),d="base",h=Fc("base",!1),y=Ic("[5] PrefixDecl"),v="PREFIX",g=Fc("PREFIX",!1),b="prefix",m=Fc("prefix",!1),x=Ic("[6] SelectQuery"),_=Ic("[7] SubSelect"),w=Ic("[8] SelectClause"),k="SELECT",E=Fc("SELECT",!1),A="select",S=Fc("select",!1),j="DISTINCT",T=Fc("DISTINCT",!1),F="distinct",C=Fc("distinct",!1),I="REDUCED",R=Fc("REDUCED",!1),N="reduced",O=Fc("reduced",!1),L="(",P=Fc("(",!1),D="AS",Q=Fc("AS",!1),M="as",B=Fc("as",!1),U=")",G=Fc(")",!1),q="*",H=Fc("*",!1),J=Ic("[9] ConstructQuery"),z="CONSTRUCT",V=Fc("CONSTRUCT",!1),W="construct",X=Fc("construct",!1),K="WHERE",$=Fc("WHERE",!1),Z="where",Y=Fc("where",!1),ee="{",te=Fc("{",!1),re="}",ne=Fc("}",!1),ie=Ic("[10] DescribeQuery"),oe="DESCRIBE",se=Fc("DESCRIBE",!1),ae=Ic("[11] AskQuery"),le="ASK",ue=Fc("ASK",!1),ce="ask",fe=Fc("ask",!1),pe=Ic("[12] DatasetClause"),de="FROM",he=Fc("FROM",!1),ye="from",ve=Fc("from",!1),ge=Ic("[13] DefaultGraphClause"),be=Ic("[14] NamedGraphClause"),me="NAMED",xe=Fc("NAMED",!1),_e="named",we=Fc("named",!1),ke=Ic("[15] SourceSelector"),Ee=Ic("[16] WhereClause"),Ae=Ic("[17] SolutionModifier"),Se=Ic("[18] GroupClause"),je="GROUP",Te=Fc("GROUP",!1),Fe="group",Ce=Fc("group",!1),Ie="BY",Re=Fc("BY",!1),Ne="by",Oe=Fc("by",!1),Le=Ic("[19] GroupCondition"),Pe=Ic("[20] HavingClause"),De="HAVING",Qe=Fc("HAVING",!1),Me=Ic("[21] HavingCondition"),Be=Ic("[22] OrderClause"),Ue="ORDER",Ge=Fc("ORDER",!1),qe="order",He=Fc("order",!1),Je=Ic("[23] OrderCondition"),ze=Fc("ASC",!1),Ve=Fc("asc",!1),We="DESC",Xe=Fc("DESC",!1),Ke="desc",$e=Fc("desc",!1),Ze=Ic("[24] LimitOffsetClauses"),Ye=Ic("[25] LimitClause"),et="LIMIT",tt=Fc("LIMIT",!1),rt="limit",nt=Fc("limit",!1),it=Ic("[26] OffsetClause"),ot="OFFSET",st=Fc("OFFSET",!1),at="offset",lt=Fc("offset",!1),ut=Ic("[27] BindingsClause"),ct="BINDINGS",ft=Fc("BINDINGS",!1),pt=Ic("[28] BindingValue"),dt="UNDEF",ht=Fc("UNDEF",!1),yt=Ic("[28]\tValuesClause\t  ::=\t( 'VALUES' DataBlock )?"),vt="VALUES",gt=Fc("VALUES",!1),bt="values",mt=Fc("values",!1),xt=Ic("[29] UpdateUnit"),_t=Ic("[30] Update"),wt=";",kt=Fc(";",!1),Et=Ic("[31] Update1"),At=Ic("[32] Load"),St="LOAD",jt=Fc("LOAD",!1),Tt="load",Ft=Fc("load",!1),Ct="INTO",It=Fc("INTO",!1),Rt="into",Nt=Fc("into",!1),Ot=Ic("[33] Clear"),Lt="CLEAR",Pt=Fc("CLEAR",!1),Dt="clear",Qt=Fc("clear",!1),Mt="SILENT",Bt=Fc("SILENT",!1),Ut="silent",Gt=Fc("silent",!1),qt=Ic("[34] Drop"),Ht="DROP",Jt=Fc("DROP",!1),zt="drop",Vt=Fc("drop",!1),Wt=Ic("[35] Create"),Xt="CREATE",Kt=Fc("CREATE",!1),$t="create",Zt=Fc("create",!1),Yt=Ic("[36] InsertData"),er="INSERT",tr=Fc("INSERT",!1),rr="insert",nr=Fc("insert",!1),ir="DATA",or=Fc("DATA",!1),sr="data",ar=Fc("data",!1),lr=Ic("[37] DeleteData"),ur="DELETE",cr=Fc("DELETE",!1),fr="delete",pr=Fc("delete",!1),dr=Ic("[38] DeleteWhere"),hr=Ic("[39] Modify"),yr="WITH",vr=Fc("WITH",!1),gr="with",br=Fc("with",!1),mr=Ic("[40] DeleteClause"),xr=Ic("[41] InsertClause"),_r=Ic("[42] UsingClause"),wr="USING",kr=Fc("USING",!1),Er="using",Ar=Fc("using",!1),Sr=Ic("[43] GraphRef"),jr="GRAPH",Tr=Fc("GRAPH",!1),Fr="graph",Cr=Fc("graph",!1),Ir=Ic("[44] GraphRefAll"),Rr="DEFAULT",Nr=Fc("DEFAULT",!1),Or="default",Lr=Fc("default",!1),Pr=Fc("ALL",!1),Dr=Fc("all",!1),Qr=Ic("[45] QuadPattern"),Mr=function(e){return e.quadsContext},Br=Ic("[46] QuadData"),Ur=Ic("[47] Quads"),Gr=".",qr=Fc(".",!1),Hr=Ic("[48] QuadsNotTriples"),Jr=Ic("[49] TriplesTemplate"),zr=Ic("[50] GroupGraphPattern"),Vr=Ic("[51] GroupGraphPatternSub"),Wr=Ic("[54] TriplesBlock"),Xr=Ic("[53] GraphPatternNotTriples"),Kr=Ic("[54] OptionalGraphPattern"),$r="OPTIONAL",Zr=Fc("OPTIONAL",!1),Yr="optional",en=Fc("optional",!1),tn=Ic("[55] GraphGraphPattern"),rn=Ic("[56] ServiceGraphPattern"),nn="SERVICE",on=Fc("SERVICE",!1),sn=Ic("[57] MinusGraphPattern"),an="MINUS",ln=Fc("MINUS",!1),un="minus",cn=Fc("minus",!1),fn=Ic("[58] GroupOrUnionGraphPattern"),pn="UNION",dn=Fc("UNION",!1),hn="union",yn=Fc("union",!1),vn=Ic("[59] Filter"),gn="FILTER",bn=Fc("FILTER",!1),mn="filter",xn=Fc("filter",!1),_n=Ic("[60] Bind"),wn="BIND",kn=Fc("BIND",!1),En="bind",An=Fc("bind",!1),Sn=Ic("[60] Constraint"),jn=Ic("[61] InlineData"),Tn=Ic("[62] DataBlock"),Fn=Ic("[63] InlineDataOneVar"),Cn=Ic("[64] InlineDataFull"),In=Ic("[65] DataBlockValue"),Rn=Ic("[61] FunctionCall"),Nn=Ic("[62] ArgList"),On=function(){var e={token:"args",value:[]};return e},Ln=",",Pn=Fc(",",!1),Dn=Ic("[63] ExpressionList"),Qn=Ic("[64] ConstructTemplate"),Mn=Ic("[65] ConstructTriples"),Bn=Ic("[66] TriplesSameSubject"),Un=Ic("[83] PropertyListPathNotEmpty"),Gn=Ic("[67] PropertyListNotEmpty"),qn=Ic("[68] PropertyList"),Hn=Ic("[86] ObjectListPath"),Jn=Ic("[69] ObjectList"),zn=Ic("[87] ObjectPath"),Vn=Ic("[70] Object"),Wn=Ic("[71] Verb"),Xn="a",Kn=Fc("a",!1),$n=Ic("[72] TriplesSameSubjectPath"),Zn=Ic("[73] PropertyListNotEmptyPath"),Yn=Ic("[74] PropertyListPath"),ei=Ic("[75]"),ti=Ic("[76] VerbSimple"),ri=Ic("[77] Path"),ni=Ic("[78] PathAlternative"),ii="|",oi=Fc("|",!1),si=Ic("[79] PathSequence"),ai="/",li=Fc("/",!1),ui=Ic("[88] PathElt"),ci=Ic("[81] PathEltOrInverse"),fi=Fc("^",!1),pi=Ic("[82] PathMod"),di="?",hi=Fc("?",!1),yi="+",vi=Fc("+",!1),gi=Ic("[83] PathPrimary"),bi="!",mi=Fc("!",!1),xi=Ic("[85] PathOneInPropertySet"),_i=Ic("[86] Integer"),wi=Ic("[100] TriplesNodePath"),ki=Ic("[87] TriplesNode"),Ei=Ic("[101] BlankNodePropertyListPath"),Ai="[",Si=Fc("[",!1),ji="]",Ti=Fc("]",!1),Fi=Ic("[88] BlankNodePropertyList"),Ci=Ic("[103] CollectionPath"),Ii=Ic("[89] Collection"),Ri=Ic("[105] GraphNodePath"),Ni=function(e){return e[1]},Oi=Ic("[90] GraphNode"),Li=Ic("[91] VarOrTerm"),Pi=Ic("[92] VarOrIRIref"),Di=Ic("[93] Var"),Qi=Ic("[94] GraphTerm"),Mi=Ic("[95] Expression"),Bi=Ic("[96] ConditionalOrExpression"),Ui="||",Gi=Fc("||",!1),qi=Ic("[97] ConditionalAndExpression"),Hi="&&",Ji=Fc("&&",!1),zi=Ic("[98] ValueLogical"),Vi=Ic("[99] RelationalExpression"),Wi="=",Xi=Fc("=",!1),Ki="!=",$i=Fc("!=",!1),Zi="<",Yi=Fc("<",!1),eo=">",to=Fc(">",!1),ro="<=",no=Fc("<=",!1),io=">=",oo=Fc(">=",!1),so="I",ao=Fc("I",!1),lo="i",uo=Fc("i",!1),co="N",fo=Fc("N",!1),po="n",ho=Fc("n",!1),yo="O",vo=Fc("O",!1),go="o",bo=Fc("o",!1),mo="T",xo=Fc("T",!1),_o="t",wo=Fc("t",!1),ko=Ic("[100] NumericExpression"),Eo=Ic("[101] AdditiveExpression"),Ao="-",So=Fc("-",!1),jo=Ic("[102] MultiplicativeExpression"),To=Ic("[103] UnaryExpression"),Fo=Ic("[104] PrimaryExpression"),Co=Ic("[105] BrackettedExpression"),Io=Ic("[106] BuiltInCall"),Ro=Fc("STR",!1),No=Fc("str",!1),Oo="LANG",Lo=Fc("LANG",!1),Po="lang",Do=Fc("lang",!1),Qo="LANGMATCHES",Mo=Fc("LANGMATCHES",!1),Bo="langmatches",Uo=Fc("langmatches",!1),Go="DATATYPE",qo=Fc("DATATYPE",!1),Ho="datatype",Jo=Fc("datatype",!1),zo="BOUND",Vo=Fc("BOUND",!1),Wo="bound",Xo=Fc("bound",!1),Ko=Fc("IRI",!1),$o=Fc("iri",!1),Zo=Fc("URI",!1),Yo=Fc("uri",!1),es="BNODE",ts=Fc("BNODE",!1),rs="bnode",ns=Fc("bnode",!1),is="COALESCE",os=Fc("COALESCE",!1),ss="coalesce",as=Fc("coalesce",!1),ls=Fc("IF",!1),us=Fc("if",!1),cs="ISLITERAL",fs=Fc("ISLITERAL",!1),ps="isliteral",ds=Fc("isliteral",!1),hs="isLITERAL",ys=Fc("isLITERAL",!1),vs="ISBLANK",gs=Fc("ISBLANK",!1),bs="isblank",ms=Fc("isblank",!1),xs="isBLANK",_s=Fc("isBLANK",!1),ws="SAMETERM",ks=Fc("SAMETERM",!1),Es="sameterm",As=Fc("sameterm",!1),Ss="ISURI",js=Fc("ISURI",!1),Ts="isuri",Fs=Fc("isuri",!1),Cs="isURI",Is=Fc("isURI",!1),Rs="ISIRI",Ns=Fc("ISIRI",!1),Os="isiri",Ls=Fc("isiri",!1),Ps="isIRI",Ds=Fc("isIRI",!1),Qs="custom:",Ms=Fc("custom:",!1),Bs="CUSTOM:",Us=Fc("CUSTOM:",!1),Gs=/^[a-zA-Z0-9_]/,qs=Cc([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),Hs=Ic("[107] RegexExpression"),Js="REGEX",zs=Fc("REGEX",!1),Vs="regex",Ws=Fc("regex",!1),Xs=Ic("[108] ExistsFunc"),Ks="EXISTS",$s=Fc("EXISTS",!1),Zs="exists",Ys=Fc("exists",!1),ea=Ic("[109] NotExistsFunc"),ta="NOT",ra=Fc("NOT",!1),na="not",ia=Fc("not",!1),oa=Ic("[110] Aggregate"),sa="COUNT",aa=Fc("COUNT",!1),la="count",ua=Fc("count",!1),ca="GROUP_CONCAT",fa=Fc("GROUP_CONCAT",!1),pa="group_concat",da=Fc("group_concat",!1),ha="SEPARATOR",ya=Fc("SEPARATOR",!1),va="SUM",ga=Fc("SUM",!1),ba="sum",ma=Fc("sum",!1),xa="MIN",_a=Fc("MIN",!1),wa="min",ka=Fc("min",!1),Ea="MAX",Aa=Fc("MAX",!1),Sa="max",ja=Fc("max",!1),Ta="AVG",Fa=Fc("AVG",!1),Ca="avg",Ia=Fc("avg",!1),Ra=Ic("[117] IRIrefOrFunction"),Na=Ic("[112] RDFLiteral"),Oa=Fc("^^",!1),La=Ic("[113] NumericLiteral"),Pa=Ic("[114] NumericLiteralUnsigned"),Da=Ic("[115] NumericLiteralPositive"),Qa=Ic("[116] NumericLiteralNegative"),Ma=Ic("[117] BooleanLiteral"),Ba="TRUE",Ua=Fc("TRUE",!1),Ga="true",qa=Fc("true",!1),Ha="FALSE",Ja=Fc("FALSE",!1),za="false",Va=Fc("false",!1),Wa=Ic("[118] String"),Xa=function(e){return{token:"string",value:e}},Ka=Ic("[119] IRIref"),$a=Ic("[120] PrefixedName"),Za=Ic("[121] BlankNode"),Ya=Ic("[122] IRI_REF"),el=/^[^<>"{}|\^`\\]/,tl=Cc(["<",">",'"',"{","}","|","^","`","\\"],!0,!1),rl=Ic("[123] PNAME_NS"),nl=":",il=Fc(":",!1),ol=Ic("[124] PNAME_LN"),sl=Ic("[125] BLANK_NODE_LABEL"),al="_:",ll=Fc("_:",!1),ul=Ic("[126] VAR1"),cl=Ic("[127] VAR2"),fl="$",pl=Fc("$",!1),dl=Ic("[128] LANGTAG"),hl="@",yl=Fc("@",!1),vl=/^[a-zA-Z]/,gl=Cc([["a","z"],["A","Z"]],!1,!1),bl=/^[a-zA-Z0-9]/,ml=Cc([["a","z"],["A","Z"],["0","9"]],!1,!1),xl=Ic("[129] INTEGER"),_l=/^[0-9]/,wl=Cc([["0","9"]],!1,!1),kl=Ic("[130] DECIMAL"),El=Ic("[131] DOUBLE"),Al=Ic("[132] INTEGER_POSITIVE"),Sl=Ic("[133] DECIMAL_POSITIVE"),jl=function(e){return e.value="+"+e.value,e},Tl=Ic("[134] DOUBLE_POSITIVE"),Fl=Ic("[135] INTEGER_NEGATIVE"),Cl=function(e){return e.value="-"+e.value,e},Il=Ic("[136] DECIMAL_NEGATIVE"),Rl=Ic("[137] DOUBLE_NEGATIVE"),Nl=Ic("[138] EXPONENT"),Ol=/^[eE]/,Ll=Cc(["e","E"],!1,!1),Pl=/^[+\-]/,Dl=Cc(["+","-"],!1,!1),Ql=Ic("[139] STRING_LITERAL1"),Ml="'",Bl=Fc("'",!1),Ul=/^[^'\\\n\r]/,Gl=Cc(["'","\\","\n","\r"],!0,!1),ql=function(e){return gp(e)},Hl=Ic("[140] STRING_LITERAL2"),Jl='"',zl=Fc('"',!1),Vl=/^[^"\\\n\r]/,Wl=Cc(['"',"\\","\n","\r"],!0,!1),Xl=Ic("[141] STRING_LITERAL_LONG1"),Kl="'''",$l=Fc("'''",!1),Zl=/^[^'\\]/,Yl=Cc(["'","\\"],!0,!1),eu=Ic("[142] STRING_LITERAL_LONG2"),tu='"""',ru=Fc('"""',!1),nu=/^[^"\\]/,iu=Cc(['"',"\\"],!0,!1),ou=Ic("[143] ECHAR"),su=Fc("\\",!1),au=/^[tbnrf"']/,lu=Cc(["t","b","n","r","f",'"',"'"],!1,!1),uu=Ic("[144] NIL"),cu=Ic("[145] WS"),fu=/^[ ]/,pu=Cc([" "],!1,!1),du=/^[\t]/,hu=Cc(["\t"],!1,!1),yu=/^[\r]/,vu=Cc(["\r"],!1,!1),gu=/^[\n]/,bu=Cc(["\n"],!1,!1),mu=Ic(" COMMENT"),xu="#",_u=Fc("#",!1),wu=/^[^\n\r]/,ku=Cc(["\n","\r"],!0,!1),Eu=Ic("[146] ANON"),Au=Ic("[147] PN_CHARS_BASE"),Su=/^[A-Z]/,ju=Cc([["A","Z"]],!1,!1),Tu=/^[a-z]/,Fu=Cc([["a","z"]],!1,!1),Cu=/^[\xC0-\xD6]/,Iu=Cc([["",""]],!1,!1),Ru=/^[\xD8-\xF6]/,Nu=Cc([["",""]],!1,!1),Ou=/^[\xF8-\u02FF]/,Lu=Cc([["",""]],!1,!1),Pu=/^[\u0370-\u037D]/,Du=Cc([["",""]],!1,!1),Qu=/^[\u037F-\u1FFF]/,Mu=Cc([["",""]],!1,!1),Bu=/^[\u200C-\u200D]/,Uu=Cc([["",""]],!1,!1),Gu=/^[\u2070-\u218F]/,qu=Cc([["",""]],!1,!1),Hu=/^[\u2C00-\u2FEF]/,Ju=Cc([["",""]],!1,!1),zu=/^[\u3001-\uD7FF]/,Vu=Cc([["",""]],!1,!1),Wu=/^[\uF900-\uFDCF]/,Xu=Cc([["",""]],!1,!1),Ku=/^[\uFDF0-\uFFFD]/,$u=Cc([["",""]],!1,!1),Zu=/^[\u1000-\uEFFF]/,Yu=Cc([["",""]],!1,!1),ec=Ic("[148] PN_CHARS_U"),tc=Fc("_",!1),rc=Ic("[149] VARNAME"),nc=/^[\xB7]/,ic=Cc([""],!1,!1),oc=/^[\u0300-\u036F]/,sc=Cc([["",""]],!1,!1),ac=/^[\u203F-\u2040]/,lc=Cc([["",""]],!1,!1),uc=Ic("[150] PN_CHARS"),cc=Ic("[151] PN_PREFIX"),fc=Ic("[152] PN_LOCAL"),pc=Ic("[170] PLX"),dc=Ic("[171] PERCENT"),hc="%",yc=Fc("%",!1),vc=Ic("[172] HEX"),gc=/^[A-F]/,bc=Cc([["A","F"]],!1,!1),mc=/^[a-f]/,xc=Cc([["a","f"]],!1,!1),_c=Ic("[173] PN_LOCAL_ESC"),wc=Fc("~",!1),kc=Fc("&",!1),Ec=0,Ac=[{line:1,column:1}],Sc=0,jc=[],Tc=0;if("startRule"in r){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');s=o[r.startRule]}function Fc(e,t){return{type:"literal",text:e,ignoreCase:t}}function Cc(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function Ic(e){return{type:"other",description:e}}function Rc(e){var r,n=Ac[e];if(n)return n;for(r=e-1;!Ac[r];)r--;for(n={line:(n=Ac[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Ac[e]=n,n}function Nc(e,t){var r=Rc(e),n=Rc(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function Oc(e){Ec<Sc||(Ec>Sc&&(Sc=Ec,jc=[]),jc.push(e))}function Lc(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}function Pc(){return function(){var e;e=function(){var e;Tc++,e=function(){var e,r,n,o;Tc++,e=Ec,(r=Dc())!==i?(n=function(){var e,r,n,o,s,a,l,u,c,f;if(Tc++,e=Ec,r=Mc(),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i){for(o=[],s=Bc();s!==i;)o.push(s),s=Bc();if(o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Gc())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if((u=qc())!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i?(f=function(){var e,r,n,o,s,a,l,u,c;Tc++,e=Ec,t.substr(Ec,8)===ct?(r=ct,Ec+=8):(r=i,0===Tc&&Oc(ft));if(r!==i){for(n=[],o=Mf();o!==i;)n.push(o),o=Mf();if(n!==i)if(123===t.charCodeAt(Ec)?(o=ee,Ec++):(o=i,0===Tc&&Oc(te)),o!==i){if(s=[],a=Ec,40===t.charCodeAt(Ec)?(l=L,Ec++):(l=i,0===Tc&&Oc(P)),l!==i){if(u=[],(c=Xc())!==i)for(;c!==i;)u.push(c),c=Xc();else u=i;u!==i?(41===t.charCodeAt(Ec)?(c=U,Ec++):(c=i,0===Tc&&Oc(G)),c!==i?a=l=[l,u,c]:(Ec=a,a=i)):(Ec=a,a=i)}else Ec=a,a=i;for(a===i&&(a=lp());a!==i;){if(s.push(a),a=Ec,40===t.charCodeAt(Ec)?(l=L,Ec++):(l=i,0===Tc&&Oc(P)),l!==i){if(u=[],(c=Xc())!==i)for(;c!==i;)u.push(c),c=Xc();else u=i;u!==i?(41===t.charCodeAt(Ec)?(c=U,Ec++):(c=i,0===Tc&&Oc(G)),c!==i?a=l=[l,u,c]:(Ec=a,a=i)):(Ec=a,a=i)}else Ec=a,a=i;a===i&&(a=lp())}s!==i?(125===t.charCodeAt(Ec)?(a=re,Ec++):(a=i,0===Tc&&Oc(ne)),a!==i?e=r=[r,n,o,s,a]:(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;e===i&&(e=null);Tc--,e===i&&(r=i,0===Tc&&Oc(ut));return e}(),f!==i?(e,e=r=function(e,t,r,n){for(var i={named:[],implicit:[]},o=0;o<t.length;o++){var s=t[o];"default"===s.kind?i.implicit.push(s.graph):i.named.push(s.graph)}0===i.named.length&&0===i.implicit.length&&i.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var a={kind:"select",token:"executableunit"};return a.dataset=i,a.projection=e.vars,a.modifier=e.modifier,a.pattern=r,null!=n&&null!=n.limit&&(a.limit=n.limit),null!=n&&null!=n.offset&&(a.offset=n.offset),null!=n&&null!=n.order&&""!=n.order&&(a.order=n.order),null!=n&&null!=n.group&&(a.group=n.group),a}(r,o,a,u)):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(x));return e}(),n===i&&(n=function(){var e,r,n,o,s,a,l,u,c,f,p,d,h,y,v;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,9)===z?(n=z,Ec+=9):(n=i,0===Tc&&Oc(V)),n===i&&(t.substr(Ec,9)===W?(n=W,Ec+=9):(n=i,0===Tc&&Oc(X))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if(s=function(){var e,r,n,o,s,a;Tc++,e=Ec,123===t.charCodeAt(Ec)?(r=ee,Ec++):(r=i,0===Tc&&Oc(te));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=vf())===i&&(o=null),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i?(125===t.charCodeAt(Ec)?(a=re,Ec++):(a=i,0===Tc&&Oc(ne)),a!==i?(e,e=r=o):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Qn));return e}(),s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i){for(l=[],u=Bc();u!==i;)l.push(u),u=Bc();if(l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();if(u!==i)if((c=Gc())!==i){for(f=[],p=up();p!==i;)f.push(p),p=up();f!==i&&(p=qc())!==i?(e,e=r=function(e,t,r,n){for(var i={named:[],implicit:[]},o=0;o<t.length;o++){var s=t[o];"default"===s.kind?i.implicit.push(s.graph):i.named.push(s.graph)}0===i.named.length&&0===i.implicit.length&&i.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var a={kind:"construct",token:"executableunit"};return a.dataset=i,a.template=e,a.pattern=r,null!=n&&null!=n.limit&&(a.limit=n.limit),null!=n&&null!=n.offset&&(a.offset=n.offset),null!=n&&null!=n.order&&""!=n.order&&(a.order=n.order),a}(s,l,c,p)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;if(e===i){for(e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,9)===z?(n=z,Ec+=9):(n=i,0===Tc&&Oc(V)),n===i&&(t.substr(Ec,9)===W?(n=W,Ec+=9):(n=i,0===Tc&&Oc(X))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i){for(s=[],a=Bc();a!==i;)s.push(a),a=Bc();if(s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if(t.substr(Ec,5)===K?(l=K,Ec+=5):(l=i,0===Tc&&Oc($)),l===i&&(t.substr(Ec,5)===Z?(l=Z,Ec+=5):(l=i,0===Tc&&Oc(Y))),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();if(u!==i)if(123===t.charCodeAt(Ec)?(c=ee,Ec++):(c=i,0===Tc&&Oc(te)),c!==i){for(f=[],p=up();p!==i;)f.push(p),p=up();if(f!==i)if((p=sf())===i&&(p=null),p!==i){for(d=[],h=up();h!==i;)d.push(h),h=up();if(d!==i)if(125===t.charCodeAt(Ec)?(h=re,Ec++):(h=i,0===Tc&&Oc(ne)),h!==i){for(y=[],v=up();v!==i;)y.push(v),v=up();y!==i&&(v=qc())!==i?(e,e=r=function(e,t,r){for(var n={named:[],implicit:[]},i=0;i<e.length;i++){var o=e[i];"default"===o.kind?n.implicit.push(o.graph):n.named.push(o.graph)}0===n.named.length&&0===n.implicit.length&&n.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var s={kind:"construct",token:"executableunit"};return s.dataset=n,s.template=t,s.pattern={token:"basicgraphpattern",triplesContext:t.triplesContext},null!=r&&null!=r.limit&&(s.limit=r.limit),null!=r&&null!=r.offset&&(s.offset=r.offset),null!=r&&null!=r.order&&""!=r.order&&(s.order=r.order),s}(s,p,v)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}Tc--,e===i&&(r=i,0===Tc&&Oc(J));return e}(),n===i&&(n=function(){var e,r,n,o,s,a;Tc++,e=Ec,t.substr(Ec,8)===oe?(r=oe,Ec+=8):(r=i,0===Tc&&Oc(se));if(r!==i){if(n=[],(o=Qf())!==i)for(;o!==i;)n.push(o),o=Qf();else n=i;if(n===i&&(42===t.charCodeAt(Ec)?(n=q,Ec++):(n=i,0===Tc&&Oc(H))),n!==i){for(o=[],s=Bc();s!==i;)o.push(s),s=Bc();o!==i?((s=Gc())===i&&(s=null),s!==i&&(a=qc())!==i?e=r=[r,n,o,s,a]:(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(ie));return e}(),n===i&&(n=function(){var e,r,n,o,s,a,l;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,3)===le?(n=le,Ec+=3):(n=i,0===Tc&&Oc(ue)),n===i&&(t.substr(Ec,3)===ce?(n=ce,Ec+=3):(n=i,0===Tc&&Oc(fe))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i){for(s=[],a=Bc();a!==i;)s.push(a),a=Bc();if(s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();a!==i&&(l=Gc())!==i?(e,e=r=function(e,t){for(var r={named:[],implicit:[]},n=0;n<e.length;n++){var i=e[n];"implicit"===i.kind?r.implicit.push(i.graph):r.named.push(i.graph)}0===r.named.length&&0===r.implicit.length&&r.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var o={kind:"ask",token:"executableunit"};return o.dataset=r,o.pattern=t,o}(s,l)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(ae));return e}()))),n!==i?(o=function(){var e,r,n,o;Tc++,e=Ec,r=Ec,t.substr(Ec,6)===vt?(n=vt,Ec+=6):(n=i,0===Tc&&Oc(gt));n===i&&(t.substr(Ec,6)===bt?(n=bt,Ec+=6):(n=i,0===Tc&&Oc(mt)));n!==i&&(o=ff())!==i?r=n=[n,o]:(Ec=r,r=i);r===i&&(r=null);r!==i&&(e,r=null!=(s=r)?s[1]:null);var s;e=r,Tc--,e===i&&(r=i,0===Tc&&Oc(yt));return e}(),o!==i?(e,e=r=function(e,t,r){return{token:"query",kind:"query",prologue:e,units:[t],inlineData:r}}(r,n,o)):(Ec=e,e=i)):(Ec=e,e=i)):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(l));return e}(),Tc--,e===i&&(i,0===Tc&&Oc(a));return e}(),e===i&&(e=function(){var e;Tc++,e=Kc(),Tc--,e===i&&(i,0===Tc&&Oc(xt));return e}());return e}()}function Dc(){var e,r,n,o,s;if(Tc++,e=Ec,r=function(){var e,r,n,o,s;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,4)===f?(n=f,Ec+=4):(n=i,0===Tc&&Oc(p)),n===i&&(t.substr(Ec,4)===d?(n=d,Ec+=4):(n=i,0===Tc&&Oc(h))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i&&(s=tp())!==i?(e,e=r=function(e){_p(e);var t={token:"base"};return t.value=e,t}(s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(c));return e}(),r===i&&(r=null),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i){for(o=[],s=Qc();s!==i;)o.push(s),s=Qc();o!==i?(e,e=r={token:"prologue",base:r,prefixes:o}):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(u)),e}function Qc(){var e,r,n,o,s,a,l;for(Tc++,e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,6)===v?(n=v,Ec+=6):(n=i,0===Tc&&Oc(g)),n===i&&(t.substr(Ec,6)===b?(n=b,Ec+=6):(n=i,0===Tc&&Oc(m))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if((s=rp())!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();a!==i&&(l=tp())!==i?(e,e=r=function(e,t){xp(e,t);var r={token:"prefix"};return r.prefix=e,r.local=t,r}(s,l)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(y)),e}function Mc(){var e,r,n,o,s,a,l,u,c,f,p,d,h,y,v,g,b,m,x,_;for(Tc++,e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,6)===k?(n=k,Ec+=6):(n=i,0===Tc&&Oc(E)),n===i&&(t.substr(Ec,6)===A?(n=A,Ec+=6):(n=i,0===Tc&&Oc(S))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if(t.substr(Ec,8)===j?(s=j,Ec+=8):(s=i,0===Tc&&Oc(T)),s===i&&(t.substr(Ec,8)===F?(s=F,Ec+=8):(s=i,0===Tc&&Oc(C))),s===i&&(t.substr(Ec,7)===I?(s=I,Ec+=7):(s=i,0===Tc&&Oc(R)),s===i&&(t.substr(Ec,7)===N?(s=N,Ec+=7):(s=i,0===Tc&&Oc(O)))),s===i&&(s=null),s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i){for(l=[],u=Ec,c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if((f=Mf())!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?u=c=[c,f,p]:(Ec=u,u=i)}else Ec=u,u=i;else Ec=u,u=i;if(u===i){for(u=Ec,c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(40===t.charCodeAt(Ec)?(f=L,Ec++):(f=i,0===Tc&&Oc(P)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();if(p!==i)if((d=Bf())!==i){for(h=[],y=up();y!==i;)h.push(y),y=up();if(h!==i)if(t.substr(Ec,2)===D?(y=D,Ec+=2):(y=i,0===Tc&&Oc(Q)),y===i&&(t.substr(Ec,2)===M?(y=M,Ec+=2):(y=i,0===Tc&&Oc(B))),y!==i){for(v=[],g=up();g!==i;)v.push(g),g=up();if(v!==i)if((g=Mf())!==i){for(b=[],m=up();m!==i;)b.push(m),m=up();if(b!==i)if(41===t.charCodeAt(Ec)?(m=U,Ec++):(m=i,0===Tc&&Oc(G)),m!==i){for(x=[],_=up();_!==i;)x.push(_),_=up();x!==i?u=c=[c,f,p,d,h,y,v,g,b,m,x]:(Ec=u,u=i)}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i}if(u!==i)for(;u!==i;){for(l.push(u),u=Ec,c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if((f=Mf())!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?u=c=[c,f,p]:(Ec=u,u=i)}else Ec=u,u=i;else Ec=u,u=i;if(u===i){for(u=Ec,c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(40===t.charCodeAt(Ec)?(f=L,Ec++):(f=i,0===Tc&&Oc(P)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();if(p!==i)if((d=Bf())!==i){for(h=[],y=up();y!==i;)h.push(y),y=up();if(h!==i)if(t.substr(Ec,2)===D?(y=D,Ec+=2):(y=i,0===Tc&&Oc(Q)),y===i&&(t.substr(Ec,2)===M?(y=M,Ec+=2):(y=i,0===Tc&&Oc(B))),y!==i){for(v=[],g=up();g!==i;)v.push(g),g=up();if(v!==i)if((g=Mf())!==i){for(b=[],m=up();m!==i;)b.push(m),m=up();if(b!==i)if(41===t.charCodeAt(Ec)?(m=U,Ec++):(m=i,0===Tc&&Oc(G)),m!==i){for(x=[],_=up();_!==i;)x.push(_),_=up();x!==i?u=c=[c,f,p,d,h,y,v,g,b,m,x]:(Ec=u,u=i)}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i}}else l=i;if(l===i){for(l=Ec,u=[],c=up();c!==i;)u.push(c),c=up();if(u!==i)if(42===t.charCodeAt(Ec)?(c=q,Ec++):(c=i,0===Tc&&Oc(H)),c!==i){for(f=[],p=up();p!==i;)f.push(p),p=up();f!==i?l=u=[u,c,f]:(Ec=l,l=i)}else Ec=l,l=i;else Ec=l,l=i}l!==i?(e,e=r=function(e,t){var r=[];if(3===t.length&&"*"===t[1])return{vars:[{token:"variable",kind:"*"}],modifier:wp(e)};for(var n=0;n<t.length;n++){var i=t[n];3===i.length?r.push({token:"variable",kind:"var",value:i[1]}):r.push({token:"variable",kind:"aliased",expression:i[3],alias:i[7]})}return{vars:r,modifier:wp(e)}}(s,l)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(w)),e}function Bc(){var e,r,n,o,s,a;if(Tc++,e=Ec,t.substr(Ec,4)===de?(r=de,Ec+=4):(r=i,0===Tc&&Oc(he)),r===i&&(t.substr(Ec,4)===ye?(r=ye,Ec+=4):(r=i,0===Tc&&Oc(ve))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(o=function(){var e,t,r;Tc++,e=Ec,t=[],r=up();for(;r!==i;)t.push(r),r=up();t!==i&&(r=Uc())!==i?(e,e=t={graph:r,kind:"default",token:"graphClause"}):(Ec=e,e=i);Tc--,e===i&&(t=i,0===Tc&&Oc(ge));return e}(),o===i&&(o=function(){var e,r,n,o;Tc++,e=Ec,t.substr(Ec,5)===me?(r=me,Ec+=5):(r=i,0===Tc&&Oc(xe));r===i&&(t.substr(Ec,5)===_e?(r=_e,Ec+=5):(r=i,0===Tc&&Oc(we)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i&&(o=Uc())!==i?(e,e=r={graph:o,kind:"named",token:"graphCluase"}):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(be));return e}()),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i?(e,e=r=o):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(pe)),e}function Uc(){var e;return Tc++,e=ep(),Tc--,e===i&&(i,0===Tc&&Oc(ke)),e}function Gc(){var e,r,n,o,s,a;if(Tc++,e=Ec,t.substr(Ec,5)===K?(r=K,Ec+=5):(r=i,0===Tc&&Oc($)),r===i&&(t.substr(Ec,5)===Z?(r=Z,Ec+=5):(r=i,0===Tc&&Oc(Y))),r===i&&(r=null),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=af())!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i?(e,e=r=o):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Ee)),e}function qc(){var e,r,n,o,s,a,l,u,c;return Tc++,e=Ec,r=function(){var e,r,n,o,s,a,l;Tc++,e=Ec,t.substr(Ec,5)===je?(r=je,Ec+=5):(r=i,0===Tc&&Oc(Te));r===i&&(t.substr(Ec,5)===Fe?(r=Fe,Ec+=5):(r=i,0===Tc&&Oc(Ce)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(t.substr(Ec,2)===Ie?(o=Ie,Ec+=2):(o=i,0===Tc&&Oc(Re)),o===i&&(t.substr(Ec,2)===Ne?(o=Ne,Ec+=2):(o=i,0===Tc&&Oc(Oe))),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i){if(a=[],(l=Hc())!==i)for(;l!==i;)a.push(l),l=Hc();else a=i;a!==i?(e,e=r=a):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Se));return e}(),r===i&&(r=null),r!==i?(n=function(){var e,r,n,o;Tc++,e=Ec,t.substr(Ec,6)===De?(r=De,Ec+=6):(r=i,0===Tc&&Oc(Qe));if(r!==i){if(n=[],(o=Jc())!==i)for(;o!==i;)n.push(o),o=Jc();else n=i;n!==i?e=r=[r,n]:(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Pe));return e}(),n===i&&(n=null),n!==i?(o=function(){var e,r,n,o,s,a,l,u;Tc++,e=Ec,t.substr(Ec,5)===Ue?(r=Ue,Ec+=5):(r=i,0===Tc&&Oc(Ge));r===i&&(t.substr(Ec,5)===qe?(r=qe,Ec+=5):(r=i,0===Tc&&Oc(He)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(t.substr(Ec,2)===Ie?(o=Ie,Ec+=2):(o=i,0===Tc&&Oc(Re)),o===i&&(t.substr(Ec,2)===Ne?(o=Ne,Ec+=2):(o=i,0===Tc&&Oc(Oe))),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i){if(a=[],(l=zc())!==i)for(;l!==i;)a.push(l),l=zc();else a=i;if(a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(e,e=r=a):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Be));return e}(),o===i&&(o=null),o!==i?(s=function(){var e,t,r,n;Tc++,e=Ec,t=Ec,r=Vc(),r!==i?((n=Wc())===i&&(n=null),n!==i?t=r=[r,n]:(Ec=t,t=i)):(Ec=t,t=i);t===i&&(t=Ec,(r=Wc())!==i?((n=Vc())===i&&(n=null),n!==i?t=r=[r,n]:(Ec=t,t=i)):(Ec=t,t=i));t!==i&&(e,t=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];null!=n&&null!=n.limit?t.limit=n.limit:null!=n&&null!=n.offset&&(t.offset=n.offset)}return t}(t));e=t,Tc--,e===i&&(t=i,0===Tc&&Oc(Ze));return e}(),s===i&&(s=null),s!==i?(e,a=r,l=o,c={},null!=(u=s)&&(null!=u.limit&&(c.limit=u.limit),null!=u.offset&&(c.offset=u.offset)),null!=a&&(c.group=a),c.order=l,e=r=c):(Ec=e,e=i)):(Ec=e,e=i)):(Ec=e,e=i)):(Ec=e,e=i),Tc--,e===i&&(r=i,0===Tc&&Oc(Ae)),e}function Hc(){var e,r,n,o,s,a,l,u,c,f,p,d,h;for(Tc++,e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if((n=Wf())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?(e,e=r=n):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;if(e===i){for(e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if((n=df())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?(e,e=r=n):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;if(e===i){for(e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if(40===t.charCodeAt(Ec)?(n=L,Ec++):(n=i,0===Tc&&Oc(P)),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if((s=Bf())!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i){if(l=Ec,t.substr(Ec,2)===D?(u=D,Ec+=2):(u=i,0===Tc&&Oc(Q)),u===i&&(t.substr(Ec,2)===M?(u=M,Ec+=2):(u=i,0===Tc&&Oc(B))),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i&&(f=Mf())!==i?l=u=[u,c,f]:(Ec=l,l=i)}else Ec=l,l=i;if(l===i&&(l=null),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();if(u!==i)if(41===t.charCodeAt(Ec)?(c=U,Ec++):(c=i,0===Tc&&Oc(G)),c!==i){for(f=[],p=up();p!==i;)f.push(p),p=up();f!==i?(e,d=s,e=r=0!=(h=l).length?{token:"aliased_expression",expression:d,alias:h[2]}:d):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;if(e===i){for(e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if((n=Mf())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?(e,e=r=n):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}}}return Tc--,e===i&&(r=i,0===Tc&&Oc(Le)),e}function Jc(){var e;return Tc++,e=cf(),Tc--,e===i&&(i,0===Tc&&Oc(Me)),e}function zc(){var e,r,n,o,s,a,l;if(Tc++,e=Ec,"ASC"===t.substr(Ec,3)?(r="ASC",Ec+=3):(r=i,0===Tc&&Oc(ze)),r===i&&("asc"===t.substr(Ec,3)?(r="asc",Ec+=3):(r=i,0===Tc&&Oc(Ve)),r===i&&(t.substr(Ec,4)===We?(r=We,Ec+=4):(r=i,0===Tc&&Oc(Xe)),r===i&&(t.substr(Ec,4)===Ke?(r=Ke,Ec+=4):(r=i,0===Tc&&Oc($e))))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=Vf())!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i?(e,l=o,e=r={direction:r.toUpperCase(),expression:l}):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i)if(e=Ec,(r=cf())===i&&(r=Mf()),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i?(e,r=function(e){"var"===e.token&&(e={token:"expression",expressionType:"atomic",primaryexpression:"var",value:e});return{direction:"ASC",expression:e}}(r),e=r):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Je)),e}function Vc(){var e,r,n,o,s,a;if(Tc++,e=Ec,t.substr(Ec,5)===et?(r=et,Ec+=5):(r=i,0===Tc&&Oc(tt)),r===i&&(t.substr(Ec,5)===rt?(r=rt,Ec+=5):(r=i,0===Tc&&Oc(nt))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=np())!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i?(e,e=r={limit:parseInt(o.value)}):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Ye)),e}function Wc(){var e,r,n,o,s,a;if(Tc++,e=Ec,t.substr(Ec,6)===ot?(r=ot,Ec+=6):(r=i,0===Tc&&Oc(st)),r===i&&(t.substr(Ec,6)===at?(r=at,Ec+=6):(r=i,0===Tc&&Oc(lt))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=np())!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i?(e,e=r={offset:parseInt(o.value)}):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(it)),e}function Xc(){var e;return Tc++,(e=ep())===i&&(e=Xf())===i&&(e=Kf())===i&&(e=Zf())===i&&(t.substr(Ec,5)===dt?(e=dt,Ec+=5):(e=i,0===Tc&&Oc(ht))),Tc--,e===i&&(i,0===Tc&&Oc(pt)),e}function Kc(){var e,r,n,o,s,a,l,u,c;if(Tc++,e=Ec,(r=Dc())!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(o=function(){var e;Tc++,e=function(){var e,r,n,o,s,a,l,u,c;Tc++,e=Ec,t.substr(Ec,4)===St?(r=St,Ec+=4):(r=i,0===Tc&&Oc(jt));r===i&&(t.substr(Ec,4)===Tt?(r=Tt,Ec+=4):(r=i,0===Tc&&Oc(Ft)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=ep())!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i){if(a=Ec,t.substr(Ec,4)===Ct?(l=Ct,Ec+=4):(l=i,0===Tc&&Oc(It)),l===i&&(t.substr(Ec,4)===Rt?(l=Rt,Ec+=4):(l=i,0===Tc&&Oc(Nt))),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i&&(c=Yc())!==i?a=l=[l,u,c]:(Ec=a,a=i)}else Ec=a,a=i;a===i&&(a=null),a!==i?(e,f=a,(p={kind:"load",token:"executableunit"}).sourceGraph=o,null!=f&&(p.destinyGraph=f[2]),e=r=p):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;var f,p;Tc--,e===i&&(r=i,0===Tc&&Oc(At));return e}(),e===i&&(e=function(){var e,r,n,o,s,a;Tc++,e=Ec,t.substr(Ec,5)===Lt?(r=Lt,Ec+=5):(r=i,0===Tc&&Oc(Pt));r===i&&(t.substr(Ec,5)===Dt?(r=Dt,Ec+=5):(r=i,0===Tc&&Oc(Qt)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(t.substr(Ec,6)===Mt?(o=Mt,Ec+=6):(o=i,0===Tc&&Oc(Bt)),o===i&&(t.substr(Ec,6)===Ut?(o=Ut,Ec+=6):(o=i,0===Tc&&Oc(Gt))),o===i&&(o=null),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i&&(a=ef())!==i?(e,(l={kind:"clear",token:"executableunit"}).destinyGraph=a,e=r=l):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;var l;Tc--,e===i&&(r=i,0===Tc&&Oc(Ot));return e}(),e===i&&(e=function(){var e,r,n,o,s,a;Tc++,e=Ec,t.substr(Ec,4)===Ht?(r=Ht,Ec+=4):(r=i,0===Tc&&Oc(Jt));r===i&&(t.substr(Ec,4)===zt?(r=zt,Ec+=4):(r=i,0===Tc&&Oc(Vt)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(t.substr(Ec,6)===Mt?(o=Mt,Ec+=6):(o=i,0===Tc&&Oc(Bt)),o===i&&(t.substr(Ec,6)===Ut?(o=Ut,Ec+=6):(o=i,0===Tc&&Oc(Gt))),o===i&&(o=null),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i&&(a=ef())!==i?(e,(l={kind:"drop",token:"executableunit"}).destinyGraph=a,e=r=l):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;var l;Tc--,e===i&&(r=i,0===Tc&&Oc(qt));return e}(),e===i&&(e=function(){var e,r,n,o,s,a;Tc++,e=Ec,t.substr(Ec,6)===Xt?(r=Xt,Ec+=6):(r=i,0===Tc&&Oc(Kt));r===i&&(t.substr(Ec,6)===$t?(r=$t,Ec+=6):(r=i,0===Tc&&Oc(Zt)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(t.substr(Ec,6)===Mt?(o=Mt,Ec+=6):(o=i,0===Tc&&Oc(Bt)),o===i&&(t.substr(Ec,6)===Ut?(o=Ut,Ec+=6):(o=i,0===Tc&&Oc(Gt))),o===i&&(o=null),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i&&(a=Yc())!==i?(e,(l={kind:"create",token:"executableunit"}).destinyGraph=a,e=r=l):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;var l;Tc--,e===i&&(r=i,0===Tc&&Oc(Wt));return e}(),e===i&&(e=function(){var e,r,n,o,s,a;Tc++,e=Ec,t.substr(Ec,6)===er?(r=er,Ec+=6):(r=i,0===Tc&&Oc(tr));r===i&&(t.substr(Ec,6)===rr?(r=rr,Ec+=6):(r=i,0===Tc&&Oc(nr)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(t.substr(Ec,4)===ir?(o=ir,Ec+=4):(o=i,0===Tc&&Oc(or)),o===i&&(t.substr(Ec,4)===sr?(o=sr,Ec+=4):(o=i,0===Tc&&Oc(ar))),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i&&(a=rf())!==i?(e,(l={kind:"insertdata",token:"executableunit"}).quads=a,e=r=l):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;var l;Tc--,e===i&&(r=i,0===Tc&&Oc(Yt));return e}(),e===i&&(e=function(){var e,r,n,o,s;Tc++,e=Ec,t.substr(Ec,6)===ur?(r=ur,Ec+=6):(r=i,0===Tc&&Oc(cr));r===i&&(t.substr(Ec,6)===fr?(r=fr,Ec+=6):(r=i,0===Tc&&Oc(pr)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i?(t.substr(Ec,4)===ir?(o=ir,Ec+=4):(o=i,0===Tc&&Oc(or)),o===i&&(t.substr(Ec,4)===sr?(o=sr,Ec+=4):(o=i,0===Tc&&Oc(ar))),o!==i&&(s=rf())!==i?(e,(a={kind:"deletedata",token:"executableunit"}).quads=s,e=r=a):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;var a;Tc--,e===i&&(r=i,0===Tc&&Oc(lr));return e}(),e===i&&(e=function(){var e,r,n,o,s,a;Tc++,e=Ec,t.substr(Ec,6)===ur?(r=ur,Ec+=6):(r=i,0===Tc&&Oc(cr));r===i&&(t.substr(Ec,6)===fr?(r=fr,Ec+=6):(r=i,0===Tc&&Oc(pr)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(t.substr(Ec,5)===K?(o=K,Ec+=5):(o=i,0===Tc&&Oc($)),o===i&&(t.substr(Ec,5)===Z?(o=Z,Ec+=5):(o=i,0===Tc&&Oc(Y))),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i&&(a=af())!==i?(e,e=r=function(e){var t={kind:"modify"};t.pattern=e,t.with=null,t.using=null;var r=[],n=e.patterns[0];n=null==n.triplesContext&&null!=n.patterns?n.patterns[0].triplesContext:n.triplesContext;for(var i=0;i<n.length;i++){var o={},s=n[i];o.subject=s.subject,o.predicate=s.predicate,o.object=s.object,o.graph=s.graph,r.push(o)}return t.delete=r,t}(a)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(dr));return e}(),e===i&&(e=function(){var e,r,n,o,s,a,l,u,c,f,p,d;Tc++,e=Ec,r=Ec,t.substr(Ec,4)===yr?(n=yr,Ec+=4):(n=i,0===Tc&&Oc(vr));n===i&&(t.substr(Ec,4)===gr?(n=gr,Ec+=4):(n=i,0===Tc&&Oc(br)));if(n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i&&(s=ep())!==i?r=n=[n,o,s]:(Ec=r,r=i)}else Ec=r,r=i;r===i&&(r=null);if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i){if(o=Ec,s=function(){var e,r,n;Tc++,e=Ec,t.substr(Ec,6)===ur?(r=ur,Ec+=6):(r=i,0===Tc&&Oc(cr));r===i&&(t.substr(Ec,6)===fr?(r=fr,Ec+=6):(r=i,0===Tc&&Oc(pr)));r!==i&&(n=tf())!==i?(e,e=r=n):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(mr));return e}(),s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();a!==i?((l=$c())===i&&(l=null),l!==i?o=s=[s,a,l]:(Ec=o,o=i)):(Ec=o,o=i)}else Ec=o,o=i;if(o===i&&(o=$c()),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i){for(a=[],l=Zc();l!==i;)a.push(l),l=Zc();if(a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(t.substr(Ec,5)===K?(u=K,Ec+=5):(u=i,0===Tc&&Oc($)),u===i&&(t.substr(Ec,5)===Z?(u=Z,Ec+=5):(u=i,0===Tc&&Oc(Y))),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if((f=af())!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?(e,e=r=function(e,t,r,n){var i={kind:"modify"};return i.with=""!=e&&null!=e?e[2]:null,3!==t.length||""!==t[2]&&null!=t[2]?3===t.length&&null!=t[0].length&&null!=t[1].length&&null!=t[2].length?(i.delete=t[0],i.insert=t[2]):(i.insert=t,i.delete=null):(i.delete=t[0],i.insert=null),""!=r&&(i.using=r),i.pattern=n,i}(r,o,a,f)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(hr));return e}())))))));Tc--,e===i&&(i,0===Tc&&Oc(Et));return e}(),o!==i){for(s=Ec,a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if(59===t.charCodeAt(Ec)?(l=wt,Ec++):(l=i,0===Tc&&Oc(kt)),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i?((c=Kc())===i&&(c=null),c!==i?s=a=[a,l,u,c]:(Ec=s,s=i)):(Ec=s,s=i)}else Ec=s,s=i;else Ec=s,s=i;s===i&&(s=null),s!==i?(e,e=r=function(e,t,r){var n={token:"query",kind:"update"};n.prologue=e;var i=[t];return null!=r&&null!=r.length&&null!=r[3]&&null!=r[3].units&&(i=i.concat(r[3].units)),n.units=i,n}(r,o,s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(_t)),e}function $c(){var e,r,n;return Tc++,e=Ec,t.substr(Ec,6)===er?(r=er,Ec+=6):(r=i,0===Tc&&Oc(tr)),r===i&&(t.substr(Ec,6)===rr?(r=rr,Ec+=6):(r=i,0===Tc&&Oc(nr))),r!==i&&(n=tf())!==i?(e,e=r=n):(Ec=e,e=i),Tc--,e===i&&(r=i,0===Tc&&Oc(xr)),e}function Zc(){var e,r,n,o,s,a,l,u,c;for(Tc++,e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,5)===wr?(n=wr,Ec+=5):(n=i,0===Tc&&Oc(kr)),n===i&&(t.substr(Ec,5)===Er?(n=Er,Ec+=5):(n=i,0===Tc&&Oc(Ar))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i){if((s=ep())===i)if(s=Ec,t.substr(Ec,5)===me?(a=me,Ec+=5):(a=i,0===Tc&&Oc(xe)),a===i&&(t.substr(Ec,5)===_e?(a=_e,Ec+=5):(a=i,0===Tc&&Oc(we))),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=ep())!==i?s=a=[a,l,u]:(Ec=s,s=i)}else Ec=s,s=i;s!==i?(e,e=r=null!=(c=s).length?{kind:"named",uri:c[2]}:{kind:"default",uri:c}):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(_r)),e}function Yc(){var e,r,n,o;if(Tc++,e=Ec,t.substr(Ec,5)===jr?(r=jr,Ec+=5):(r=i,0===Tc&&Oc(Tr)),r===i&&(t.substr(Ec,5)===Fr?(r=Fr,Ec+=5):(r=i,0===Tc&&Oc(Cr))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i&&(o=ep())!==i?(e,e=r=o):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Sr)),e}function ef(){var e,r;return Tc++,e=Ec,(r=Yc())!==i&&e,(e=r)===i&&(e=Ec,t.substr(Ec,7)===Rr?(r=Rr,Ec+=7):(r=i,0===Tc&&Oc(Nr)),r===i&&(t.substr(Ec,7)===Or?(r=Or,Ec+=7):(r=i,0===Tc&&Oc(Lr))),r!==i&&(e,r="default"),(e=r)===i&&(e=Ec,t.substr(Ec,5)===me?(r=me,Ec+=5):(r=i,0===Tc&&Oc(xe)),r===i&&(t.substr(Ec,5)===_e?(r=_e,Ec+=5):(r=i,0===Tc&&Oc(we))),r!==i&&(e,r="named"),(e=r)===i&&(e=Ec,"ALL"===t.substr(Ec,3)?(r="ALL",Ec+=3):(r=i,0===Tc&&Oc(Pr)),r===i&&("all"===t.substr(Ec,3)?(r="all",Ec+=3):(r=i,0===Tc&&Oc(Dr))),r!==i&&(e,r="all"),e=r))),Tc--,e===i&&(r=i,0===Tc&&Oc(Ir)),e}function tf(){var e,r,n,o,s,a,l,u,c;for(Tc++,e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if(123===t.charCodeAt(Ec)?(n=ee,Ec++):(n=i,0===Tc&&Oc(te)),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if((s=nf())!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if(125===t.charCodeAt(Ec)?(l=re,Ec++):(l=i,0===Tc&&Oc(ne)),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i?(e,e=r=Mr(s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Qr)),e}function rf(){var e,r,n,o,s,a,l,u,c;for(Tc++,e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if(123===t.charCodeAt(Ec)?(n=ee,Ec++):(n=i,0===Tc&&Oc(te)),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if((s=nf())!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if(125===t.charCodeAt(Ec)?(l=re,Ec++):(l=i,0===Tc&&Oc(ne)),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i?(e,e=r=Mr(s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Br)),e}function nf(){var e,r,n,o,s,a,l;if(Tc++,e=Ec,(r=sf())===i&&(r=null),r!==i){for(n=[],o=Ec,(s=of())!==i?(46===t.charCodeAt(Ec)?(a=Gr,Ec++):(a=i,0===Tc&&Oc(qr)),a===i&&(a=null),a!==i?((l=sf())===i&&(l=null),l!==i?o=s=[s,a,l]:(Ec=o,o=i)):(Ec=o,o=i)):(Ec=o,o=i);o!==i;)n.push(o),o=Ec,(s=of())!==i?(46===t.charCodeAt(Ec)?(a=Gr,Ec++):(a=i,0===Tc&&Oc(qr)),a===i&&(a=null),a!==i?((l=sf())===i&&(l=null),l!==i?o=s=[s,a,l]:(Ec=o,o=i)):(Ec=o,o=i)):(Ec=o,o=i);n!==i?(e,e=r=function(e,t){var r=[];if(null!=e&&null!=e.triplesContext)for(var n=0;n<e.triplesContext.length;n++)(i=e.triplesContext[n]).graph=null,r.push(i);if(t&&t.length>0&&t[0].length>0&&(r=r.concat(t[0][0].quadsContext),null!=t[0][2]&&null!=t[0][2].triplesContext))for(n=0;n<t[0][2].triplesContext.length;n++){var i;(i=t[0][2].triplesContext[n]).graph=null,r.push(i)}return{token:"quads",quadsContext:r}}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Ur)),e}function of(){var e,r,n,o,s,a,l,u,c,f,p,d,h;for(Tc++,e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,5)===jr?(n=jr,Ec+=5):(n=i,0===Tc&&Oc(Tr)),n===i&&(t.substr(Ec,5)===Fr?(n=Fr,Ec+=5):(n=i,0===Tc&&Oc(Cr))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if((s=Qf())!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if(123===t.charCodeAt(Ec)?(l=ee,Ec++):(l=i,0===Tc&&Oc(te)),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();if(u!==i)if((c=sf())===i&&(c=null),c!==i){for(f=[],p=up();p!==i;)f.push(p),p=up();if(f!==i)if(125===t.charCodeAt(Ec)?(p=re,Ec++):(p=i,0===Tc&&Oc(ne)),p!==i){for(d=[],h=up();h!==i;)d.push(h),h=up();d!==i?(e,e=r=function(e,t){var r=[];if(null!=t)for(var n=0;n<t.triplesContext.length;n++){var i=t.triplesContext[n];i.graph=e,r.push(i)}return{token:"quadsnottriples",quadsContext:r}}(s,c)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Hr)),e}function sf(){var e,r,n,o,s,a,l,u,c;if(Tc++,e=Ec,(r=gf())!==i){for(n=Ec,o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if(46===t.charCodeAt(Ec)?(s=Gr,Ec++):(s=i,0===Tc&&Oc(qr)),s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();a!==i?((l=sf())===i&&(l=null),l!==i?n=o=[o,s,a,l]:(Ec=n,n=i)):(Ec=n,n=i)}else Ec=n,n=i;else Ec=n,n=i;n===i&&(n=null),n!==i?(e,u=n,c=r.triplesContext,null!=u&&"object"==typeof u&&null!=u.length&&null!=u[3]&&null!=u[3].triplesContext&&(c=c.concat(u[3].triplesContext)),e=r={token:"triplestemplate",triplesContext:c}):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Jr)),e}function af(){var e,r,n,o,s,a;if(Tc++,e=Ec,123===t.charCodeAt(Ec)?(r=ee,Ec++):(r=i,0===Tc&&Oc(te)),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(o=function(){var e,t,r,n,o,s,a,l;return Tc++,e=Ec,(t=Mc())!==i&&(r=Gc())!==i&&(n=qc())!==i?(e,s=r,a=n,(l={kind:"select",token:"subselect"}).projection=(o=t).vars,l.modifier=o.modifier,l.pattern=s,null!=a&&null!=a.limit&&(l.limit=a.limit),null!=a&&null!=a.offset&&(l.offset=a.offset),null!=a&&null!=a.order&&""!=a.order&&(l.order=a.order),null!=a&&null!=a.group&&(l.group=a.group),e=t=l):(Ec=e,e=i),Tc--,e===i&&(t=i,0===Tc&&Oc(_)),e}(),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i?(125===t.charCodeAt(Ec)?(a=re,Ec++):(a=i,0===Tc&&Oc(ne)),a!==i?(e,e=r=o):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i)if(e=Ec,123===t.charCodeAt(Ec)?(r=ee,Ec++):(r=i,0===Tc&&Oc(te)),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(o=function(){var e,r,n,o,s,a,l,u,c,f;Tc++,e=Ec,r=lf(),r===i&&(r=null);if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i){if(o=[],s=Ec,(a=uf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(46===t.charCodeAt(Ec)?(u=Gr,Ec++):(u=i,0===Tc&&Oc(qr)),u===i&&(u=null),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i?((f=lf())===i&&(f=null),f!==i?s=a=[a,l,u,c,f]:(Ec=s,s=i)):(Ec=s,s=i)}else Ec=s,s=i;else Ec=s,s=i}else Ec=s,s=i;for(;s!==i;)if(o.push(s),s=Ec,(a=uf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(46===t.charCodeAt(Ec)?(u=Gr,Ec++):(u=i,0===Tc&&Oc(qr)),u===i&&(u=null),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i?((f=lf())===i&&(f=null),f!==i?s=a=[a,l,u,c,f]:(Ec=s,s=i)):(Ec=s,s=i)}else Ec=s,s=i;else Ec=s,s=i}else Ec=s,s=i;o!==i?(e,e=r=function(e,t){var r=[];null!=e&&e!=[]&&r.push(e);for(var n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)null!=t[n][i]&&null!=t[n][i].token&&r.push(t[n][i]);var o=[],s=[],a=[],l=[];for(n=0;n<r.length;n++)if("triplespattern"!==r[n].token&&"filter"!==r[n].token&&"bind"!==r[n].token){if(0!=s.length||0!=a.length){var u=[];for(i=0;i<s.length;i++)u=u.concat(s[i].triplesContext);u.length>0&&o.push({token:"basicgraphpattern",triplesContext:u}),s=[]}o.push(r[n])}else"triplespattern"===r[n].token?s.push(r[n]):"bind"===r[n].token?l.push(r[n]):a.push(r[n]);if(0!=s.length||0!=a.length){for(u=[],i=0;i<s.length;i++)u=u.concat(s[i].triplesContext);u.length>0&&o.push({token:"basicgraphpattern",triplesContext:u})}return{token:"groupgraphpattern",patterns:o,filters:a,binds:l}}(r,o)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Vr));return e}(),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i?(125===t.charCodeAt(Ec)?(a=re,Ec++):(a=i,0===Tc&&Oc(ne)),a!==i?(e,e=r=o):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(zr)),e}function lf(){var e,r,n,o,s,a,l,u;if(Tc++,e=Ec,r=function(){var e,r,n,o,s;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if((n=Df())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i&&(s=Ef())!==i?(e,e=r=function(e,t){var r=t.triplesContext,n=e;if(t.pairs)for(var i=0;i<t.pairs.length;i++){var o=t.pairs[i],s=null;null!=o[1].length&&(o[1]=o[1][0]),n.token&&"triplesnodecollection"===n.token?("path"===(s={subject:n.chainSubject[0],predicate:o[0],object:o[1]}).predicate.token&&"element"===s.predicate.kind&&(s.predicate=s.predicate.value),r.push(s),r=r.concat(n.triplesContext)):("path"===(s={subject:n,predicate:o[0],object:o[1]}).predicate.token&&"element"===s.predicate.kind&&(s.predicate=s.predicate.value),r.push(s))}var a={token:"triplessamesubject"};return a.triplesContext=r,a.chainSubject=n,a}(n,s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;if(e===i){for(e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if((n=Nf())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?(s=function(){var e;Tc++,e=function(){var e,r,n,o,s,a,l,u,c,f,p,d,h;Tc++,e=Ec,r=Af(),r===i&&(r=Sf());if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=mf())!==i){for(s=[],a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(59===t.charCodeAt(Ec)?(u=wt,Ec++):(u=i,0===Tc&&Oc(kt)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i){if(f=Ec,(p=Af())===i&&(p=Sf()),p!==i){for(d=[],h=up();h!==i;)d.push(h),h=up();d!==i&&(h=xf())!==i?f=p=[p,d,h]:(Ec=f,f=i)}else Ec=f,f=i;f===i&&(f=null),f!==i?a=l=[l,u,c,f]:(Ec=a,a=i)}else Ec=a,a=i}else Ec=a,a=i;else Ec=a,a=i;for(;a!==i;){for(s.push(a),a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(59===t.charCodeAt(Ec)?(u=wt,Ec++):(u=i,0===Tc&&Oc(kt)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i){if(f=Ec,(p=Af())===i&&(p=Sf()),p!==i){for(d=[],h=up();h!==i;)d.push(h),h=up();d!==i&&(h=xf())!==i?f=p=[p,d,h]:(Ec=f,f=i)}else Ec=f,f=i;f===i&&(f=null),f!==i?a=l=[l,u,c,f]:(Ec=a,a=i)}else Ec=a,a=i}else Ec=a,a=i;else Ec=a,a=i}s!==i?(e,e=r=function(e,t,r){for(var n={token:"propertylist"},i=[],o=[],s=0;s<t.length;s++)null!=t[s].triplesContext?(i=i.concat(t[s].triplesContext),"triplesnodecollection"===t[s].token&&null!=t[s].chainSubject.length?o.push([e,t[s].chainSubject[0]]):o.push([e,t[s].chainSubject])):o.push([e,t[s]]);for(s=0;s<r.length;s++)for(var a=r[s][3],l=a[0],u=a[2]||[],c=0;c<u.length;c++)null!=u[c].triplesContext?(i=i.concat(u[c].triplesContext),o.push([l,u[c].chainSubject])):o.push([l,u[c]]);return n.pairs=o,n.triplesContext=i,n}(r,o,s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Un));return e}(),e===i&&(e=null);Tc--,e===i&&(i,0===Tc&&Oc(Yn));return e}(),s!==i?(e,e=r=function(e,t){var r=e.triplesContext,n=e.chainSubject;if(null!=t&&null!=t.pairs)for(var i=0;i<t.pairs.length;i++){var o=t.pairs[i];if(null!=o[1].length&&(o[1]=o[1][0]),"triplesnodecollection"===e.token)for(var s=0;s<n.length;s++){var a=n[s];if(null!=a.triplesContext){var l={subject:a.chainSubject,predicate:o[0],object:o[1]};r.concat(a.triplesContext)}else l={subject:n[s],predicate:o[0],object:o[1]},r.push(l)}else l={subject:n,predicate:o[0],object:o[1]},r.push(l)}var u={token:"triplessamesubject"};return u.triplesContext=r,u.chainSubject=n,u}(n,s)):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}Tc--,e===i&&(r=i,0===Tc&&Oc($n));return e}(),r!==i){for(n=Ec,o=[],s=up();s!==i;)o.push(s),s=up();o!==i?(46===t.charCodeAt(Ec)?(s=Gr,Ec++):(s=i,0===Tc&&Oc(qr)),s!==i?((a=lf())===i&&(a=null),a!==i?n=o=[o,s,a]:(Ec=n,n=i)):(Ec=n,n=i)):(Ec=n,n=i),n===i&&(n=null),n!==i?(e,l=n,u=r.triplesContext,null!=l&&"object"==typeof l&&null!=l&&null!=l.length&&null!=l[2]&&null!=l[2].triplesContext&&(u=u.concat(l[2].triplesContext)),e=r={token:"triplespattern",triplesContext:u}):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Wr)),e}function uf(){var e;return Tc++,e=function(){var e,r,n,o,s,a,l,u;if(Tc++,e=Ec,r=af(),r!==i){for(n=[],o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,5)===pn?(a=pn,Ec+=5):(a=i,0===Tc&&Oc(dn)),a===i&&(t.substr(Ec,5)===hn?(a=hn,Ec+=5):(a=i,0===Tc&&Oc(yn))),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=af())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;for(;o!==i;){for(n.push(o),o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,5)===pn?(a=pn,Ec+=5):(a=i,0===Tc&&Oc(dn)),a===i&&(t.substr(Ec,5)===hn?(a=hn,Ec+=5):(a=i,0===Tc&&Oc(yn))),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=af())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i}n!==i?(e,e=r=function(e,t){if(0===t.length)return e;for(var r={token:"graphunionpattern",value:[e]},n=0;n<t.length;n++)n==t.length-1?r.value.push(t[n][3]):(r.value.push(t[n][3]),r={token:"graphunionpattern",value:[r]});return r}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(fn));return e}(),e===i&&(e=function(){var e,r,n,o,s;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,8)===$r?(n=$r,Ec+=8):(n=i,0===Tc&&Oc(Zr)),n===i&&(t.substr(Ec,8)===Yr?(n=Yr,Ec+=8):(n=i,0===Tc&&Oc(en))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i&&(s=af())!==i?(e,e=r={token:"optionalgraphpattern",value:s}):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Kr));return e}(),e===i&&(e=function(){var e,r,n,o;Tc++,e=Ec,t.substr(Ec,5)===an?(r=an,Ec+=5):(r=i,0===Tc&&Oc(ln));r===i&&(t.substr(Ec,5)===un?(r=un,Ec+=5):(r=i,0===Tc&&Oc(cn)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i&&(o=af())!==i?(e,e=r={token:"minusgraphpattern",status:"todo",value:o}):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(sn));return e}(),e===i&&(e=function(){var e,r,n,o,s,a,l;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,5)===jr?(n=jr,Ec+=5):(n=i,0===Tc&&Oc(Tr)),n===i&&(t.substr(Ec,5)===Fr?(n=Fr,Ec+=5):(n=i,0===Tc&&Oc(Cr))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if((s=Qf())!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();a!==i&&(l=af())!==i?(e,e=r=function(e,t){for(var r=0;r<t.patterns.length;r++)for(var n=t.patterns[r],i=0;i<n.triplesContext.length;i++)n.triplesContext[i].graph=e;return t.token="groupgraphpattern",t}(s,l)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(tn));return e}(),e===i&&(e=function(){var e,r,n,o;Tc++,e=Ec,t.substr(Ec,7)===nn?(r=nn,Ec+=7):(r=i,0===Tc&&Oc(on));r!==i&&(n=Qf())!==i&&(o=af())!==i?(e,e=r={token:"servicegraphpattern",status:"todo",value:[n,o]}):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(rn));return e}(),e===i&&(e=function(){var e,r,n,o,s;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,6)===gn?(n=gn,Ec+=6):(n=i,0===Tc&&Oc(bn)),n===i&&(t.substr(Ec,6)===mn?(n=mn,Ec+=6):(n=i,0===Tc&&Oc(xn))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i&&(s=cf())!==i?(e,e=r={token:"filter",value:s}):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(vn));return e}(),e===i&&(e=function(){var e,r,n,o,s,a,l,u,c,f,p,d,h;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,4)===wn?(n=wn,Ec+=4):(n=i,0===Tc&&Oc(kn)),n===i&&(t.substr(Ec,4)===En?(n=En,Ec+=4):(n=i,0===Tc&&Oc(An))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if(40===t.charCodeAt(Ec)?(s=L,Ec++):(s=i,0===Tc&&Oc(P)),s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if((l=Bf())!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();if(u!==i)if(t.substr(Ec,2)===M?(c=M,Ec+=2):(c=i,0===Tc&&Oc(B)),c===i&&(t.substr(Ec,2)===D?(c=D,Ec+=2):(c=i,0===Tc&&Oc(Q))),c!==i){for(f=[],p=up();p!==i;)f.push(p),p=up();if(f!==i)if((p=Mf())!==i){for(d=[],h=up();h!==i;)d.push(h),h=up();d!==i?(41===t.charCodeAt(Ec)?(h=U,Ec++):(h=i,0===Tc&&Oc(G)),h!==i?(e,e=r={token:"bind",expression:l,as:p}):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(_n));return e}(),e===i&&(e=function(){var e,r,n,o,s;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(t.substr(Ec,6)===vt?(n=vt,Ec+=6):(n=i,0===Tc&&Oc(gt)),n===i&&(t.substr(Ec,6)===bt?(n=bt,Ec+=6):(n=i,0===Tc&&Oc(mt))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i&&(s=ff())!==i?(e,e=r=s):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(jn));return e}()))))))),Tc--,e===i&&(i,0===Tc&&Oc(Xr)),e}function cf(){var e;return Tc++,(e=Vf())===i&&(e=Wf())===i&&(e=df()),Tc--,e===i&&(i,0===Tc&&Oc(Sn)),e}function ff(){var e;return Tc++,e=function(){var e,r,n,o,s,a,l,u;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if((n=Mf())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if(123===t.charCodeAt(Ec)?(s=ee,Ec++):(s=i,0===Tc&&Oc(te)),s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i){for(l=[],u=pf();u!==i;)l.push(u),u=pf();l!==i?(125===t.charCodeAt(Ec)?(u=re,Ec++):(u=i,0===Tc&&Oc(ne)),u!==i?(e,e=r={token:"inlineData",values:[{var:n,value:l}]}):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Fn));return e}(),e===i&&(e=function(){var e,r,n,o,s,a,l,u,c,f,p,d,h,y,v,g;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i){if((n=lp())===i)if(n=Ec,40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i){for(a=[],l=Mf();l!==i;)a.push(l),l=Mf();if(a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?n=o=[o,s,a,l,u]:(Ec=n,n=i)):(Ec=n,n=i)}else Ec=n,n=i}else Ec=n,n=i}else Ec=n,n=i;if(n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if(123===t.charCodeAt(Ec)?(s=ee,Ec++):(s=i,0===Tc&&Oc(te)),s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i){for(l=[],u=Ec,c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(40===t.charCodeAt(Ec)?(f=L,Ec++):(f=i,0===Tc&&Oc(P)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();if(p!==i){for(d=[],h=pf();h!==i;)d.push(h),h=pf();if(d!==i){for(h=[],y=up();y!==i;)h.push(y),y=up();if(h!==i)if(41===t.charCodeAt(Ec)?(y=U,Ec++):(y=i,0===Tc&&Oc(G)),y!==i){for(v=[],g=up();g!==i;)v.push(g),g=up();v!==i?u=c=[c,f,p,d,h,y,v]:(Ec=u,u=i)}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i}else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i;for(u===i&&(u=lp());u!==i;){for(l.push(u),u=Ec,c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(40===t.charCodeAt(Ec)?(f=L,Ec++):(f=i,0===Tc&&Oc(P)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();if(p!==i){for(d=[],h=pf();h!==i;)d.push(h),h=pf();if(d!==i){for(h=[],y=up();y!==i;)h.push(y),y=up();if(h!==i)if(41===t.charCodeAt(Ec)?(y=U,Ec++):(y=i,0===Tc&&Oc(G)),y!==i){for(v=[],g=up();g!==i;)v.push(g),g=up();v!==i?u=c=[c,f,p,d,h,y,v]:(Ec=u,u=i)}else Ec=u,u=i;else Ec=u,u=i}else Ec=u,u=i}else Ec=u,u=i}else Ec=u,u=i;else Ec=u,u=i;u===i&&(u=lp())}if(l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i?(125===t.charCodeAt(Ec)?(c=re,Ec++):(c=i,0===Tc&&Oc(ne)),c!==i?(e,e=r={token:"inlineData",values:[],todo:!0}):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Cn));return e}()),Tc--,e===i&&(i,0===Tc&&Oc(Tn)),e}function pf(){var e,r,n,o,s;for(Tc++,e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if((n=tp())===i&&(n=Xf())===i&&(n=Kf())===i&&(n=Zf())===i&&(t.substr(Ec,5)===dt?(n=dt,Ec+=5):(n=i,0===Tc&&Oc(ht))),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?(e,e=r=n):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(In)),e}function df(){var e,t,r,n,o,s;if(Tc++,e=Ec,(t=ep())!==i){for(r=[],n=up();n!==i;)r.push(n),n=up();r!==i&&(n=hf())!==i?(e,o=n,(s={token:"expression",expressionType:"irireforfunction"}).iriref=t,s.args=o.value,e=t=s):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(t=i,0===Tc&&Oc(Rn)),e}function hf(){var e,r,n,o,s,a,l,u,c,f,p,d;if(Tc++,e=Ec,(r=lp())!==i&&(e,r=On()),(e=r)===i)if(e=Ec,40===t.charCodeAt(Ec)?(r=L,Ec++):(r=i,0===Tc&&Oc(P)),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(t.substr(Ec,8)===j?(o=j,Ec+=8):(o=i,0===Tc&&Oc(T)),o===i&&(t.substr(Ec,8)===F?(o=F,Ec+=8):(o=i,0===Tc&&Oc(C))),o===i&&(o=null),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i){if(u=[],c=Ec,44===t.charCodeAt(Ec)?(f=Ln,Ec++):(f=i,0===Tc&&Oc(Pn)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i&&(d=Bf())!==i?c=f=[f,p,d]:(Ec=c,c=i)}else Ec=c,c=i;for(;c!==i;)if(u.push(c),c=Ec,44===t.charCodeAt(Ec)?(f=Ln,Ec++):(f=i,0===Tc&&Oc(Pn)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i&&(d=Bf())!==i?c=f=[f,p,d]:(Ec=c,c=i)}else Ec=c,c=i;u!==i?(41===t.charCodeAt(Ec)?(c=U,Ec++):(c=i,0===Tc&&Oc(G)),c!==i?(e,e=r=function(e,t,r){for(var n=[],i=0;i<r.length;i++)n.push(r[i][2]);var o={token:"args"};return o.value=[t].concat(n),null!=e&&"DISTINCT"===e.toUpperCase()?o.distinct=!0:o.distinct=!1,o}(o,a,u)):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Nn)),e}function yf(){var e,r,n,o,s,a,l,u,c,f;if(Tc++,e=Ec,(r=lp())!==i&&(e,r=On()),(e=r)===i)if(e=Ec,40===t.charCodeAt(Ec)?(r=L,Ec++):(r=i,0===Tc&&Oc(P)),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=ep())===i&&(o=Bf()),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i){if(a=[],l=Ec,44===t.charCodeAt(Ec)?(u=Ln,Ec++):(u=i,0===Tc&&Oc(Pn)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i?((f=ep())===i&&(f=Bf()),f!==i?l=u=[u,c,f]:(Ec=l,l=i)):(Ec=l,l=i)}else Ec=l,l=i;for(;l!==i;)if(a.push(l),l=Ec,44===t.charCodeAt(Ec)?(u=Ln,Ec++):(u=i,0===Tc&&Oc(Pn)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i?((f=ep())===i&&(f=Bf()),f!==i?l=u=[u,c,f]:(Ec=l,l=i)):(Ec=l,l=i)}else Ec=l,l=i;a!==i?(41===t.charCodeAt(Ec)?(l=U,Ec++):(l=i,0===Tc&&Oc(G)),l!==i?(e,e=r=function(e,t){for(var r=[],n=0;n<t.length;n++)r.push(t[n][2]);var i={token:"args"};return i.value=[e].concat(r),i}(o,a)):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Dn)),e}function vf(){var e,r,n,o,s,a,l,u,c;if(Tc++,e=Ec,(r=gf())!==i){for(n=Ec,o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if(46===t.charCodeAt(Ec)?(s=Gr,Ec++):(s=i,0===Tc&&Oc(qr)),s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();a!==i?((l=vf())===i&&(l=null),l!==i?n=o=[o,s,a,l]:(Ec=n,n=i)):(Ec=n,n=i)}else Ec=n,n=i;else Ec=n,n=i;n===i&&(n=null),n!==i?(e,u=n,c=r.triplesContext,null!=u&&"object"==typeof u&&null!=u.length&&null!=u[3]&&null!=u[3].triplesContext&&(c=c.concat(u[3].triplesContext)),e=r={token:"triplestemplate",triplesContext:c}):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Mn)),e}function gf(){var e,t,r,n,o;for(Tc++,e=Ec,t=[],r=up();r!==i;)t.push(r),r=up();if(t!==i)if((r=Df())!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i&&(o=bf())!==i?(e,e=t=function(e,t){var r=t.triplesContext,n=e;if(t.pairs)for(var i=0;i<t.pairs.length;i++){var o=t.pairs[i],s=null;null!=o[1].length&&(o[1]=o[1][0]),n.token&&"triplesnodecollection"===n.token?(s={subject:n.chainSubject[0],predicate:o[0],object:o[1]},r.push(s),r=r.concat(n.triplesContext)):(s={subject:n,predicate:o[0],object:o[1]},r.push(s))}var a={token:"triplessamesubject"};return a.triplesContext=r,a.chainSubject=n,a}(r,o)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;if(e===i){for(e=Ec,t=[],r=up();r!==i;)t.push(r),r=up();if(t!==i)if((r=Of())!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i?(o=function(){var e;Tc++,e=bf(),e===i&&(e=null);Tc--,e===i&&(i,0===Tc&&Oc(qn));return e}(),o!==i?(e,e=t=function(e,t){var r=e.triplesContext,n=e.chainSubject;if(t.pairs)for(var i=0;i<t.pairs.length;i++){var o=t.pairs[i];if(null!=o[1].length&&(o[1]=o[1][0]),"triplesnodecollection"===e.token)for(var s=0;s<n.length;s++){var a=n[s];if(null!=a.triplesContext){var l={subject:a.chainSubject,predicate:o[0],object:o[1]};r.concat(a.triplesContext)}else l={subject:n[s],predicate:o[0],object:o[1]},r.push(l)}else l={subject:n,predicate:o[0],object:o[1]},r.push(l)}var u={token:"triplessamesubject"};return u.triplesContext=r,u.chainSubject=n,u}(r,o)):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}return Tc--,e===i&&(t=i,0===Tc&&Oc(Bn)),e}function bf(){var e,r,n,o,s,a,l,u,c,f,p,d,h;if(Tc++,e=Ec,(r=kf())!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=xf())!==i){for(s=[],a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(59===t.charCodeAt(Ec)?(u=wt,Ec++):(u=i,0===Tc&&Oc(kt)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i){if(f=Ec,(p=kf())!==i){for(d=[],h=up();h!==i;)d.push(h),h=up();d!==i&&(h=xf())!==i?f=p=[p,d,h]:(Ec=f,f=i)}else Ec=f,f=i;f===i&&(f=null),f!==i?a=l=[l,u,c,f]:(Ec=a,a=i)}else Ec=a,a=i}else Ec=a,a=i;else Ec=a,a=i;for(;a!==i;){for(s.push(a),a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(59===t.charCodeAt(Ec)?(u=wt,Ec++):(u=i,0===Tc&&Oc(kt)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i){if(f=Ec,(p=kf())!==i){for(d=[],h=up();h!==i;)d.push(h),h=up();d!==i&&(h=xf())!==i?f=p=[p,d,h]:(Ec=f,f=i)}else Ec=f,f=i;f===i&&(f=null),f!==i?a=l=[l,u,c,f]:(Ec=a,a=i)}else Ec=a,a=i}else Ec=a,a=i;else Ec=a,a=i}s!==i?(e,e=r=function(e,t,r){for(var n={token:"propertylist"},i=[],o=[],s=0;s<t.length;s++)null!=t[s].triplesContext?(i=i.concat(t[s].triplesContext),"triplesnodecollection"===t[s].token&&null!=t[s].chainSubject.length?o.push([e,t[s].chainSubject[0]]):o.push([e,t[s].chainSubject])):o.push([e,t[s]]);for(s=0;s<r.length;s++)for(var a=r[s][3],l=a[0],u=a[2]||[],c=0;c<u.length;c++)null!=u[c].triplesContext?(i=i.concat(u[c].triplesContext),o.push([l,u[c].chainSubject])):o.push([l,u[c]]);return n.pairs=o,n.triplesContext=i,n}(r,o,s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Gn)),e}function mf(){var e,r,n,o,s,a,l,u;if(Tc++,e=Ec,(r=_f())!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i){if(o=[],s=Ec,44===t.charCodeAt(Ec)?(a=Ln,Ec++):(a=i,0===Tc&&Oc(Pn)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=_f())!==i?s=a=[a,l,u]:(Ec=s,s=i)}else Ec=s,s=i;for(;s!==i;)if(o.push(s),s=Ec,44===t.charCodeAt(Ec)?(a=Ln,Ec++):(a=i,0===Tc&&Oc(Pn)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=_f())!==i?s=a=[a,l,u]:(Ec=s,s=i)}else Ec=s,s=i;o!==i?(e,e=r=function(e,t){var r=[];r.push(e);for(var n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)"object"==typeof t[n][i]&&null!=t[n][i].token&&r.push(t[n][i]);return r}(r,o)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Hn)),e}function xf(){var e,r,n,o,s,a,l,u;if(Tc++,e=Ec,(r=wf())!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i){if(o=[],s=Ec,44===t.charCodeAt(Ec)?(a=Ln,Ec++):(a=i,0===Tc&&Oc(Pn)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=wf())!==i?s=a=[a,l,u]:(Ec=s,s=i)}else Ec=s,s=i;for(;s!==i;)if(o.push(s),s=Ec,44===t.charCodeAt(Ec)?(a=Ln,Ec++):(a=i,0===Tc&&Oc(Pn)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=wf())!==i?s=a=[a,l,u]:(Ec=s,s=i)}else Ec=s,s=i;o!==i?(e,e=r=function(e,t){var r=[];r.push(e);for(var n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)"object"==typeof t[n][i]&&null!=t[n][i].token&&r.push(t[n][i]);return r}(r,o)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Jn)),e}function _f(){var e;return Tc++,e=Lf(),Tc--,e===i&&(i,0===Tc&&Oc(zn)),e}function wf(){var e;return Tc++,e=Pf(),Tc--,e===i&&(i,0===Tc&&Oc(Vn)),e}function kf(){var e,r;return Tc++,(e=Qf())===i&&(e=Ec,97===t.charCodeAt(Ec)?(r=Xn,Ec++):(r=i,0===Tc&&Oc(Kn)),r!==i&&(e,r={token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}),e=r),Tc--,e===i&&(r=i,0===Tc&&Oc(Wn)),e}function Ef(){var e,r,n,o,s,a,l,u,c,f,p,d;if(Tc++,e=Ec,(r=Af())===i&&(r=Sf()),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=mf())!==i){for(s=[],a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(59===t.charCodeAt(Ec)?(u=wt,Ec++):(u=i,0===Tc&&Oc(kt)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i?(f=Ec,(p=Af())===i&&(p=Sf()),p!==i&&(d=xf())!==i?f=p=[p,d]:(Ec=f,f=i),f===i&&(f=null),f!==i?a=l=[l,u,c,f]:(Ec=a,a=i)):(Ec=a,a=i)}else Ec=a,a=i;else Ec=a,a=i;for(;a!==i;){for(s.push(a),a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(59===t.charCodeAt(Ec)?(u=wt,Ec++):(u=i,0===Tc&&Oc(kt)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i?(f=Ec,(p=Af())===i&&(p=Sf()),p!==i&&(d=xf())!==i?f=p=[p,d]:(Ec=f,f=i),f===i&&(f=null),f!==i?a=l=[l,u,c,f]:(Ec=a,a=i)):(Ec=a,a=i)}else Ec=a,a=i;else Ec=a,a=i}s!==i?(e,e=r=function(e,t,r){for(var n={token:"propertylist"},i=[],o=[],s=0;s<t.length;s++)null!=t[s].triplesContext?(i=i.concat(t[s].triplesContext),"triplesnodecollection"===t[s].token&&null!=t[s].chainSubject.length?o.push([e,t[s].chainSubject[0]]):o.push([e,t[s].chainSubject])):o.push([e,t[s]]);for(s=0;s<r.length;s++)for(var a=r[s][3],l=a[0],u=a[1]||[],c=0;c<u.length;c++)null!=u[c].triplesContext?(i=i.concat(u[c].triplesContext),o.push([l,u[c].chainSubject])):o.push([l,u[c]]);return n.pairs=o,n.triplesContext=i,n}(r,o,s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Zn)),e}function Af(){var e,t;return Tc++,e=Ec,(t=jf())!==i&&e,Tc--,(e=t)===i&&(t=i,0===Tc&&Oc(ei)),e}function Sf(){var e;return Tc++,e=Mf(),Tc--,e===i&&(i,0===Tc&&Oc(ti)),e}function jf(){var e;return Tc++,e=function(){var e,r,n,o,s,a;if(Tc++,e=Ec,r=Tf(),r!==i){for(n=[],o=Ec,124===t.charCodeAt(Ec)?(s=ii,Ec++):(s=i,0===Tc&&Oc(oi)),s!==i&&(a=Tf())!==i?o=s=[s,a]:(Ec=o,o=i);o!==i;)n.push(o),o=Ec,124===t.charCodeAt(Ec)?(s=ii,Ec++):(s=i,0===Tc&&Oc(oi)),s!==i&&(a=Tf())!==i?o=s=[s,a]:(Ec=o,o=i);n!==i?(e,e=r=function(e,t){if(null==t||0===t.length)return e;for(var r=[],n=0;n<t.length;n++)r.push(t[1]);var i={token:"path",kind:"alternative"};return i.value=r,i}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(ni));return e}(),Tc--,e===i&&(i,0===Tc&&Oc(ri)),e}function Tf(){var e,r,n,o,s,a;if(Tc++,e=Ec,(r=Cf())!==i){for(n=[],o=Ec,47===t.charCodeAt(Ec)?(s=ai,Ec++):(s=i,0===Tc&&Oc(li)),s!==i&&(a=Cf())!==i?o=s=[s,a]:(Ec=o,o=i);o!==i;)n.push(o),o=Ec,47===t.charCodeAt(Ec)?(s=ai,Ec++):(s=i,0===Tc&&Oc(li)),s!==i&&(a=Cf())!==i?o=s=[s,a]:(Ec=o,o=i);n!==i?(e,e=r=function(e,t){if(null==t||0===t.length)return e;for(var r=[e],n=0;n<t.length;n++)r.push(t[n][1]);var i={token:"path",kind:"sequence"};return i.value=r,i}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(si)),e}function Ff(){var e,r,n;return Tc++,e=Ec,r=function(){var e,r,n,o;Tc++,e=ep(),e===i&&(e=Ec,97===t.charCodeAt(Ec)?(r=Xn,Ec++):(r=i,0===Tc&&Oc(Kn)),r!==i&&(e,r={token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}),(e=r)===i&&(e=Ec,33===t.charCodeAt(Ec)?(r=bi,Ec++):(r=i,0===Tc&&Oc(mi)),r!==i?(n=function(){var e,r,n,o,s,a,l,u;if(e=If(),e===i)if(e=Ec,40===t.charCodeAt(Ec)?(r=L,Ec++):(r=i,0===Tc&&Oc(P)),r!==i){if(n=Ec,(o=If())!==i){for(s=[],a=Ec,124===t.charCodeAt(Ec)?(l=ii,Ec++):(l=i,0===Tc&&Oc(oi)),l!==i&&(u=If())!==i?a=l=[l,u]:(Ec=a,a=i);a!==i;)s.push(a),a=Ec,124===t.charCodeAt(Ec)?(l=ii,Ec++):(l=i,0===Tc&&Oc(oi)),l!==i&&(u=If())!==i?a=l=[l,u]:(Ec=a,a=i);s!==i?n=o=[o,s]:(Ec=n,n=i)}else Ec=n,n=i;n===i&&(n=null),n!==i?(41===t.charCodeAt(Ec)?(o=U,Ec++):(o=i,0===Tc&&Oc(G)),o!==i?e=r=[r,n,o]:(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;return e}(),n!==i?e=r=[r,n]:(Ec=e,e=i)):(Ec=e,e=i),e===i&&(e=Ec,40===t.charCodeAt(Ec)?(r=L,Ec++):(r=i,0===Tc&&Oc(P)),r!==i&&(n=jf())!==i?(41===t.charCodeAt(Ec)?(o=U,Ec++):(o=i,0===Tc&&Oc(G)),o!==i?(e,e=r=n):(Ec=e,e=i)):(Ec=e,e=i))));Tc--,e===i&&(r=i,0===Tc&&Oc(gi));return e}(),r!==i?(n=function(){var e,r,n,o,s,a,l,u,c;Tc++,42===t.charCodeAt(Ec)?(e=q,Ec++):(e=i,0===Tc&&Oc(H));e===i&&(63===t.charCodeAt(Ec)?(e=di,Ec++):(e=i,0===Tc&&Oc(hi)),e===i&&(43===t.charCodeAt(Ec)?(e=yi,Ec++):(e=i,0===Tc&&Oc(vi)),e===i&&(e=Ec,123===t.charCodeAt(Ec)?(r=ee,Ec++):(r=i,0===Tc&&Oc(te)),r!==i?(n=Ec,(o=Rf())!==i?(s=Ec,44===t.charCodeAt(Ec)?(a=Ln,Ec++):(a=i,0===Tc&&Oc(Pn)),a!==i?(125===t.charCodeAt(Ec)?(l=re,Ec++):(l=i,0===Tc&&Oc(ne)),l===i&&(l=Ec,(u=Rf())!==i?(125===t.charCodeAt(Ec)?(c=re,Ec++):(c=i,0===Tc&&Oc(ne)),c!==i?l=u=[u,c]:(Ec=l,l=i)):(Ec=l,l=i)),l!==i?s=a=[a,l]:(Ec=s,s=i)):(Ec=s,s=i),s===i&&(125===t.charCodeAt(Ec)?(s=re,Ec++):(s=i,0===Tc&&Oc(ne))),s!==i?n=o=[o,s]:(Ec=n,n=i)):(Ec=n,n=i),n===i&&(n=Ec,44===t.charCodeAt(Ec)?(o=Ln,Ec++):(o=i,0===Tc&&Oc(Pn)),o!==i&&(s=Rf())!==i?(125===t.charCodeAt(Ec)?(a=re,Ec++):(a=i,0===Tc&&Oc(ne)),a!==i?n=o=[o,s,a]:(Ec=n,n=i)):(Ec=n,n=i)),n!==i?e=r=[r,n]:(Ec=e,e=i)):(Ec=e,e=i))));Tc--,e===i&&(r=i,0===Tc&&Oc(pi));return e}(),n===i&&(n=null),n!==i?(e,e=r=function(e,t){if(e.token&&"path"!=e.token&&""==t)return e;if(e.token&&e.token!=r&&""!=t){var r={token:"path",kind:"element"};return r.value=e,r.modifier=t,r}return e.modifier=t,e}(r,n)):(Ec=e,e=i)):(Ec=e,e=i),Tc--,e===i&&(r=i,0===Tc&&Oc(ui)),e}function Cf(){var e,r,n,o;return Tc++,(e=Ff())===i&&(e=Ec,94===t.charCodeAt(Ec)?(r="^",Ec++):(r=i,0===Tc&&Oc(fi)),r!==i&&(n=Ff())!==i?(e,(o={token:"path",kind:"inversePath"}).value=n,e=r=o):(Ec=e,e=i)),Tc--,e===i&&(r=i,0===Tc&&Oc(ci)),e}function If(){var e,r,n;return Tc++,(e=ep())===i&&(97===t.charCodeAt(Ec)?(e=Xn,Ec++):(e=i,0===Tc&&Oc(Kn)),e===i&&(e=Ec,94===t.charCodeAt(Ec)?(r="^",Ec++):(r=i,0===Tc&&Oc(fi)),r!==i?((n=ep())===i&&(97===t.charCodeAt(Ec)?(n=Xn,Ec++):(n=i,0===Tc&&Oc(Kn))),n!==i?e=r=[r,n]:(Ec=e,e=i)):(Ec=e,e=i))),Tc--,e===i&&(r=i,0===Tc&&Oc(xi)),e}function Rf(){var e;return Tc++,e=np(),Tc--,e===i&&(i,0===Tc&&Oc(_i)),e}function Nf(){var e,r;return Tc++,e=Ec,r=function(){var e,r,n,o,s,a,l,u,c;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(40===t.charCodeAt(Ec)?(n=L,Ec++):(n=i,0===Tc&&Oc(P)),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i){if(s=[],(a=Lf())!==i)for(;a!==i;)s.push(a),a=Lf();else s=i;if(s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if(41===t.charCodeAt(Ec)?(l=U,Ec++):(l=i,0===Tc&&Oc(G)),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i?(e,e=r=s):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Ci));return e}(),r!==i&&(e,r=function(e){for(var t=[],r=[],n=null,i=0;i<e.length;i++){bp++;var o=null;null==e[i].chainSubject&&null==e[i].triplesContext?o=e[i]:(o=e[i].chainSubject,t=t.concat(e[i].triplesContext)),n={subject:{token:"blank",value:"_:"+bp},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:o},0==i&&r.push(n.subject),t.push(n),n=i===e.length-1?{subject:{token:"blank",value:"_:"+bp},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+bp},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(bp+1)}},t.push(n)}return{token:"triplesnodecollection",triplesContext:t,chainSubject:r}}(r)),(e=r)===i&&(e=function(){var e,r,n,o,s,a,l,u;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(91===t.charCodeAt(Ec)?(n=Ai,Ec++):(n=i,0===Tc&&Oc(Si)),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if((s=Ef())!==i)if(93===t.charCodeAt(Ec)?(a=ji,Ec++):(a=i,0===Tc&&Oc(Ti)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(e,e=r=function(e){for(var t={token:"blank",value:"_:"+ ++bp},r=[],n=0;n<e.pairs.length;n++){var i=e.pairs[n],o={};o.subject=t,o.predicate=i[0],null!=i[1].length&&(i[1]=i[1][0]),o.object=i[1],r.push(o)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:e.triplesContext.concat(r),chainSubject:t}}(s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Ei));return e}()),Tc--,e===i&&(r=i,0===Tc&&Oc(wi)),e}function Of(){var e,r;return Tc++,e=Ec,r=function(){var e,r,n,o,s,a,l,u,c;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(40===t.charCodeAt(Ec)?(n=L,Ec++):(n=i,0===Tc&&Oc(P)),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i){if(s=[],(a=Pf())!==i)for(;a!==i;)s.push(a),a=Pf();else s=i;if(s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if(41===t.charCodeAt(Ec)?(l=U,Ec++):(l=i,0===Tc&&Oc(G)),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i?(e,e=r=s):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Ii));return e}(),r!==i&&(e,r=function(e){for(var t=[],r=[],n=null,i=0;i<e.length;i++){bp++;var o=null;null==e[i].chainSubject&&null==e[i].triplesContext?o=e[i]:(o=e[i].chainSubject,t=t.concat(o.triplesContext)),n={subject:{token:"blank",value:"_:"+bp},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:o},0==i&&r.push(n.subject),t.push(n),n=i===e.length-1?{subject:{token:"blank",value:"_:"+bp},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+bp},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(bp+1)}},t.push(n)}return{token:"triplesnodecollection",triplesContext:t,chainSubject:r}}(r)),(e=r)===i&&(e=function(){var e,r,n,o,s,a,l,u,c;Tc++,e=Ec,r=[],n=up();for(;n!==i;)r.push(n),n=up();if(r!==i)if(91===t.charCodeAt(Ec)?(n=Ai,Ec++):(n=i,0===Tc&&Oc(Si)),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if((s=bf())!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if(93===t.charCodeAt(Ec)?(l=ji,Ec++):(l=i,0===Tc&&Oc(Ti)),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i?(e,e=r=function(e){for(var t={token:"blank",value:"_:"+ ++bp},r=[],n=0;n<e.pairs.length;n++){var i=e.pairs[n],o={};o.subject=t,o.predicate=i[0],null!=i[1].length&&(i[1]=i[1][0]),o.object=i[1],r.push(o)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:e.triplesContext.concat(r),chainSubject:t}}(s)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Fi));return e}()),Tc--,e===i&&(r=i,0===Tc&&Oc(ki)),e}function Lf(){var e,t,r,n,o,s;for(Tc++,e=Ec,t=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if((n=Df())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?t=r=[r,n,o]:(Ec=t,t=i)}else Ec=t,t=i;else Ec=t,t=i;if(t===i){for(t=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if((n=Nf())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?t=r=[r,n,o]:(Ec=t,t=i)}else Ec=t,t=i;else Ec=t,t=i}return t!==i&&(e,t=Ni(t)),Tc--,(e=t)===i&&(t=i,0===Tc&&Oc(Ri)),e}function Pf(){var e,t,r,n,o,s;for(Tc++,e=Ec,t=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if((n=Df())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?t=r=[r,n,o]:(Ec=t,t=i)}else Ec=t,t=i;else Ec=t,t=i;if(t===i){for(t=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if((n=Of())!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?t=r=[r,n,o]:(Ec=t,t=i)}else Ec=t,t=i;else Ec=t,t=i}return t!==i&&(e,t=Ni(t)),Tc--,(e=t)===i&&(t=i,0===Tc&&Oc(Oi)),e}function Df(){var e;return Tc++,(e=Mf())===i&&(e=function(){var e;Tc++,e=ep(),e===i&&(e=Xf())===i&&(e=Kf())===i&&(e=Zf())===i&&(e=function(){var e,r;Tc++,e=Ec,r=function(){var e,r,n;Tc++,e=Ec,t.substr(Ec,2)===al?(r=al,Ec+=2):(r=i,0===Tc&&Oc(ll));r!==i&&(n=hp())!==i?(e,e=r=n):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(sl));return e}(),r!==i&&(e,r={token:"blank",value:r});e=r,e===i&&(e=Ec,r=function(){var e,r,n,o;Tc++,e=Ec,91===t.charCodeAt(Ec)?(r=Ai,Ec++):(r=i,0===Tc&&Oc(Si));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i?(93===t.charCodeAt(Ec)?(o=ji,Ec++):(o=i,0===Tc&&Oc(Ti)),o!==i?e=r=[r,n,o]:(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Eu));return e}(),r!==i&&(e,r={token:"blank",value:"_:"+ ++bp}),e=r);Tc--,e===i&&(r=i,0===Tc&&Oc(Za));return e}(),e===i&&(e=lp()));Tc--,e===i&&(i,0===Tc&&Oc(Qi));return e}()),Tc--,e===i&&(i,0===Tc&&Oc(Li)),e}function Qf(){var e;return Tc++,(e=Mf())===i&&(e=ep()),Tc--,e===i&&(i,0===Tc&&Oc(Pi)),e}function Mf(){var e,r,n,o,s,a;for(Tc++,e=Ec,r=[],n=up();n!==i;)r.push(n),n=up();if(r!==i)if(n=function(){var e,r,n;Tc++,e=Ec,63===t.charCodeAt(Ec)?(r=di,Ec++):(r=i,0===Tc&&Oc(hi));r!==i&&(n=pp())!==i?(e,e=r=n):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(ul));return e}(),n===i&&(n=function(){var e,r,n;Tc++,e=Ec,36===t.charCodeAt(Ec)?(r="$",Ec++):(r=i,0===Tc&&Oc(pl));r!==i&&(n=pp())!==i?(e,e=r=n):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(cl));return e}()),n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();o!==i?(e,(a={token:"var"}).value=n,e=r=a):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Di)),e}function Bf(){var e;return Tc++,e=function(){var e,r,n,o,s,a,l,u;if(Tc++,e=Ec,r=Uf(),r!==i){for(n=[],o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===Ui?(a=Ui,Ec+=2):(a=i,0===Tc&&Oc(Gi)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Uf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;for(;o!==i;){for(n.push(o),o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===Ui?(a=Ui,Ec+=2):(a=i,0===Tc&&Oc(Gi)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Uf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i}n!==i?(e,e=r=function(e,t){if(0===t.length)return e;for(var r={token:"expression",expressionType:"conditionalor"},n=[e],i=0;i<t.length;i++)n.push(t[i][3]);return r.operands=n,r}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Bi));return e}(),Tc--,e===i&&(i,0===Tc&&Oc(Mi)),e}function Uf(){var e,r,n,o,s,a,l,u;if(Tc++,e=Ec,(r=Gf())!==i){for(n=[],o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===Hi?(a=Hi,Ec+=2):(a=i,0===Tc&&Oc(Ji)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Gf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;for(;o!==i;){for(n.push(o),o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===Hi?(a=Hi,Ec+=2):(a=i,0===Tc&&Oc(Ji)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Gf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i}n!==i?(e,e=r=function(e,t){if(0===t.length)return e;for(var r={token:"expression",expressionType:"conditionaland"},n=[e],i=0;i<t.length;i++)n.push(t[i][3]);return r.operands=n,r}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(qi)),e}function Gf(){var e;return Tc++,e=function(){var e,r,n,o,s,a,l,u,c,f,p,d,h;if(Tc++,e=Ec,r=qf(),r!==i){for(n=[],o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(61===t.charCodeAt(Ec)?(a=Wi,Ec++):(a=i,0===Tc&&Oc(Xi)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===Ki?(a=Ki,Ec+=2):(a=i,0===Tc&&Oc($i)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(60===t.charCodeAt(Ec)?(a=Zi,Ec++):(a=i,0===Tc&&Oc(Yi)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(62===t.charCodeAt(Ec)?(a=eo,Ec++):(a=i,0===Tc&&Oc(to)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===ro?(a=ro,Ec+=2):(a=i,0===Tc&&Oc(no)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===io?(a=io,Ec+=2):(a=i,0===Tc&&Oc(oo)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(73===t.charCodeAt(Ec)?(a=so,Ec++):(a=i,0===Tc&&Oc(ao)),a===i&&(105===t.charCodeAt(Ec)?(a=lo,Ec++):(a=i,0===Tc&&Oc(uo))),a!==i)if(78===t.charCodeAt(Ec)?(l=co,Ec++):(l=i,0===Tc&&Oc(fo)),l===i&&(110===t.charCodeAt(Ec)?(l=po,Ec++):(l=i,0===Tc&&Oc(ho))),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i&&(c=yf())!==i?o=s=[s,a,l,u,c]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(78===t.charCodeAt(Ec)?(a=co,Ec++):(a=i,0===Tc&&Oc(fo)),a===i&&(110===t.charCodeAt(Ec)?(a=po,Ec++):(a=i,0===Tc&&Oc(ho))),a!==i)if(79===t.charCodeAt(Ec)?(l=yo,Ec++):(l=i,0===Tc&&Oc(vo)),l===i&&(111===t.charCodeAt(Ec)?(l=go,Ec++):(l=i,0===Tc&&Oc(bo))),l!==i)if(84===t.charCodeAt(Ec)?(u=mo,Ec++):(u=i,0===Tc&&Oc(xo)),u===i&&(116===t.charCodeAt(Ec)?(u=_o,Ec++):(u=i,0===Tc&&Oc(wo))),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(73===t.charCodeAt(Ec)?(f=so,Ec++):(f=i,0===Tc&&Oc(ao)),f===i&&(105===t.charCodeAt(Ec)?(f=lo,Ec++):(f=i,0===Tc&&Oc(uo))),f!==i)if(78===t.charCodeAt(Ec)?(p=co,Ec++):(p=i,0===Tc&&Oc(fo)),p===i&&(110===t.charCodeAt(Ec)?(p=po,Ec++):(p=i,0===Tc&&Oc(ho))),p!==i){for(d=[],h=up();h!==i;)d.push(h),h=up();d!==i&&(h=yf())!==i?o=s=[s,a,l,u,c,f,p,d,h]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;else Ec=o,o=i}else Ec=o,o=i;else Ec=o,o=i;else Ec=o,o=i;else Ec=o,o=i}}}}}}}for(;o!==i;){for(n.push(o),o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(61===t.charCodeAt(Ec)?(a=Wi,Ec++):(a=i,0===Tc&&Oc(Xi)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===Ki?(a=Ki,Ec+=2):(a=i,0===Tc&&Oc($i)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(60===t.charCodeAt(Ec)?(a=Zi,Ec++):(a=i,0===Tc&&Oc(Yi)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(62===t.charCodeAt(Ec)?(a=eo,Ec++):(a=i,0===Tc&&Oc(to)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===ro?(a=ro,Ec+=2):(a=i,0===Tc&&Oc(no)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,2)===io?(a=io,Ec+=2):(a=i,0===Tc&&Oc(oo)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=qf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(73===t.charCodeAt(Ec)?(a=so,Ec++):(a=i,0===Tc&&Oc(ao)),a===i&&(105===t.charCodeAt(Ec)?(a=lo,Ec++):(a=i,0===Tc&&Oc(uo))),a!==i)if(78===t.charCodeAt(Ec)?(l=co,Ec++):(l=i,0===Tc&&Oc(fo)),l===i&&(110===t.charCodeAt(Ec)?(l=po,Ec++):(l=i,0===Tc&&Oc(ho))),l!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i&&(c=yf())!==i?o=s=[s,a,l,u,c]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(78===t.charCodeAt(Ec)?(a=co,Ec++):(a=i,0===Tc&&Oc(fo)),a===i&&(110===t.charCodeAt(Ec)?(a=po,Ec++):(a=i,0===Tc&&Oc(ho))),a!==i)if(79===t.charCodeAt(Ec)?(l=yo,Ec++):(l=i,0===Tc&&Oc(vo)),l===i&&(111===t.charCodeAt(Ec)?(l=go,Ec++):(l=i,0===Tc&&Oc(bo))),l!==i)if(84===t.charCodeAt(Ec)?(u=mo,Ec++):(u=i,0===Tc&&Oc(xo)),u===i&&(116===t.charCodeAt(Ec)?(u=_o,Ec++):(u=i,0===Tc&&Oc(wo))),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(73===t.charCodeAt(Ec)?(f=so,Ec++):(f=i,0===Tc&&Oc(ao)),f===i&&(105===t.charCodeAt(Ec)?(f=lo,Ec++):(f=i,0===Tc&&Oc(uo))),f!==i)if(78===t.charCodeAt(Ec)?(p=co,Ec++):(p=i,0===Tc&&Oc(fo)),p===i&&(110===t.charCodeAt(Ec)?(p=po,Ec++):(p=i,0===Tc&&Oc(ho))),p!==i){for(d=[],h=up();h!==i;)d.push(h),h=up();d!==i&&(h=yf())!==i?o=s=[s,a,l,u,c,f,p,d,h]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;else Ec=o,o=i}else Ec=o,o=i;else Ec=o,o=i;else Ec=o,o=i;else Ec=o,o=i}}}}}}}}n!==i?(e,e=r=function(e,t){if(0===t.length)return e;if("i"===t[0][1]||"I"===t[0][1]||"n"===t[0][1]||"N"===t[0][1]){var r={};if("i"===t[0][1]||"I"===t[0][1]){var n="=";r.expressionType="conditionalor"}else n="!=",r.expressionType="conditionaland";for(var i=e,o=[],s=0;s<t[0].length;s++)if("args"===t[0][s].token){o=t[0][s].value;break}r.token="expression",r.operands=[];for(var a=0;a<o.length;a++){var l={token:"expression",expressionType:"relationalexpression"};l.operator=n,l.op1=i,l.op2=o[a],r.operands.push(l)}return r}return(r={expressionType:"relationalexpression"}).operator=t[0][1],r.op1=e,r.op2=t[0][3],r.token="expression",r}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Vi));return e}(),Tc--,e===i&&(i,0===Tc&&Oc(zi)),e}function qf(){var e;return Tc++,e=function(){var e,r,n,o,s,a,l,u,c,f;if(Tc++,e=Ec,r=Hf(),r!==i){for(n=[],o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(43===t.charCodeAt(Ec)?(a=yi,Ec++):(a=i,0===Tc&&Oc(vi)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Hf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(45===t.charCodeAt(Ec)?(a=Ao,Ec++):(a=i,0===Tc&&Oc(So)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Hf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i)if(o=Ec,(s=$f())===i&&(s=$f()),s!==i){for(a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(42===t.charCodeAt(Ec)?(u=q,Ec++):(u=i,0===Tc&&Oc(H)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i&&(f=Jf())!==i?a=l=[l,u,c,f]:(Ec=a,a=i)}else Ec=a,a=i;else Ec=a,a=i;if(a===i){for(a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(47===t.charCodeAt(Ec)?(u=ai,Ec++):(u=i,0===Tc&&Oc(li)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i&&(f=Jf())!==i?a=l=[l,u,c,f]:(Ec=a,a=i)}else Ec=a,a=i;else Ec=a,a=i}a===i&&(a=null),a!==i?o=s=[s,a]:(Ec=o,o=i)}else Ec=o,o=i}for(;o!==i;){for(n.push(o),o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(43===t.charCodeAt(Ec)?(a=yi,Ec++):(a=i,0===Tc&&Oc(vi)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Hf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(45===t.charCodeAt(Ec)?(a=Ao,Ec++):(a=i,0===Tc&&Oc(So)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Hf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i)if(o=Ec,(s=$f())===i&&(s=$f()),s!==i){for(a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(42===t.charCodeAt(Ec)?(u=q,Ec++):(u=i,0===Tc&&Oc(H)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i&&(f=Jf())!==i?a=l=[l,u,c,f]:(Ec=a,a=i)}else Ec=a,a=i;else Ec=a,a=i;if(a===i){for(a=Ec,l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(47===t.charCodeAt(Ec)?(u=ai,Ec++):(u=i,0===Tc&&Oc(li)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i&&(f=Jf())!==i?a=l=[l,u,c,f]:(Ec=a,a=i)}else Ec=a,a=i;else Ec=a,a=i}a===i&&(a=null),a!==i?o=s=[s,a]:(Ec=o,o=i)}else Ec=o,o=i}}n!==i?(e,e=r=function(e,t){if(0===t.length)return e;var r={token:"expression",expressionType:"additiveexpression"};r.summand=e,r.summands=[];for(var n=0;n<t.length;n++){var i=t[n],o={};if(4==i.length&&"string"==typeof i[1])o.operator=i[1],o.expression=i[3];else{var s={},a=o[0],l=(o[1][1],o[1][3]);a.value<0?(o.operator="-",a.value=-a.value):o.operator="+",s.token="expression",s.expressionType="multiplicativeexpression",s.operator=a,s.factors=[{operator:null,expression:l}],o.expression=s}r.summands.push(o)}return r}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Eo));return e}(),Tc--,e===i&&(i,0===Tc&&Oc(ko)),e}function Hf(){var e,r,n,o,s,a,l,u;if(Tc++,e=Ec,(r=Jf())!==i){for(n=[],o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(42===t.charCodeAt(Ec)?(a=q,Ec++):(a=i,0===Tc&&Oc(H)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Jf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(47===t.charCodeAt(Ec)?(a=ai,Ec++):(a=i,0===Tc&&Oc(li)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Jf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i}for(;o!==i;){for(n.push(o),o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(42===t.charCodeAt(Ec)?(a=q,Ec++):(a=i,0===Tc&&Oc(H)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Jf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i;if(o===i){for(o=Ec,s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(47===t.charCodeAt(Ec)?(a=ai,Ec++):(a=i,0===Tc&&Oc(li)),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i&&(u=Jf())!==i?o=s=[s,a,l,u]:(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i}}n!==i?(e,e=r=function(e,t){if(0===t.length)return e;var r={token:"expression",expressionType:"multiplicativeexpression"};r.factor=e,r.factors=[];for(var n=0;n<t.length;n++){var i=t[n],o={};o.operator=i[1],o.expression=i[3],r.factors.push(o)}return r}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(jo)),e}function Jf(){var e,r,n,o,s;if(Tc++,e=Ec,33===t.charCodeAt(Ec)?(r=bi,Ec++):(r=i,0===Tc&&Oc(mi)),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i&&(o=zf())!==i?(e,(s={token:"expression",expressionType:"unaryexpression",unaryexpression:"!"}).expression=o,e=r=s):(Ec=e,e=i)}else Ec=e,e=i;if(e===i){if(e=Ec,43===t.charCodeAt(Ec)?(r=yi,Ec++):(r=i,0===Tc&&Oc(vi)),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i&&(o=zf())!==i?(e,r=function(e){var t={token:"expression",expressionType:"unaryexpression",unaryexpression:"+"};return t.expression=e,t}(o),e=r):(Ec=e,e=i)}else Ec=e,e=i;if(e===i){if(e=Ec,45===t.charCodeAt(Ec)?(r=Ao,Ec++):(r=i,0===Tc&&Oc(So)),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i&&(o=zf())!==i?(e,r=function(e){var t={token:"expression",expressionType:"unaryexpression",unaryexpression:"-"};return t.expression=e,t}(o),e=r):(Ec=e,e=i)}else Ec=e,e=i;e===i&&(e=zf())}}return Tc--,e===i&&(r=i,0===Tc&&Oc(To)),e}function zf(){var e,r,n;return Tc++,(e=Vf())===i&&(e=Wf())===i&&(e=function(){var e,t,r,n;if(Tc++,e=Ec,t=ep(),t!==i){for(r=[],n=up();n!==i;)r.push(n),n=up();r!==i?((n=hf())===i&&(n=null),n!==i?(e,o=n,(s={token:"expression",expressionType:"irireforfunction"}).iriref=t,s.args=null!=o?o.value:o,e=t=s):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;var o,s;Tc--,e===i&&(t=i,0===Tc&&Oc(Ra));return e}(),e===i&&(e=Ec,(r=Xf())!==i&&(e,(n={token:"expression",expressionType:"atomic",primaryexpression:"rdfliteral"}).value=r,r=n),(e=r)===i&&(e=Ec,(r=Kf())!==i&&(e,r=function(e){var t={token:"expression",expressionType:"atomic",primaryexpression:"numericliteral"};return t.value=e,t}(r)),(e=r)===i&&(e=Ec,(r=Zf())!==i&&(e,r=function(e){var t={token:"expression",expressionType:"atomic",primaryexpression:"booleanliteral"};return t.value=e,t}(r)),(e=r)===i&&(e=function(){var e,r,n,o,s,a,l,u,c,f,p,d,h,y,v,g,b,m;Tc++,e=Ec,t.substr(Ec,5)===sa?(r=sa,Ec+=5):(r=i,0===Tc&&Oc(aa));r===i&&(t.substr(Ec,5)===la?(r=la,Ec+=5):(r=i,0===Tc&&Oc(ua)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,8)===j?(a=j,Ec+=8):(a=i,0===Tc&&Oc(T)),a===i&&(t.substr(Ec,8)===F?(a=F,Ec+=8):(a=i,0===Tc&&Oc(C))),a===i&&(a=null),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(42===t.charCodeAt(Ec)?(u=q,Ec++):(u=i,0===Tc&&Oc(H)),u===i&&(u=Bf()),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(41===t.charCodeAt(Ec)?(f=U,Ec++):(f=i,0===Tc&&Oc(G)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?(e,_=u,(w={token:"expression",expressionType:"aggregate",aggregateType:"count"}).distinct=""!=(x=a)&&null!=x?"DISTINCT":x,w.expression=_,e=r=w):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;var x,_,w;if(e===i){if(e=Ec,t.substr(Ec,12)===ca?(r=ca,Ec+=12):(r=i,0===Tc&&Oc(fa)),r===i&&(t.substr(Ec,12)===pa?(r=pa,Ec+=12):(r=i,0===Tc&&Oc(da))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,8)===j?(a=j,Ec+=8):(a=i,0===Tc&&Oc(T)),a===i&&(t.substr(Ec,8)===F?(a=F,Ec+=8):(a=i,0===Tc&&Oc(C))),a===i&&(a=null),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if((u=Bf())!==i){if(c=Ec,59===t.charCodeAt(Ec)?(f=wt,Ec++):(f=i,0===Tc&&Oc(kt)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();if(p!==i)if(t.substr(Ec,9)===ha?(d=ha,Ec+=9):(d=i,0===Tc&&Oc(ya)),d!==i){for(h=[],y=up();y!==i;)h.push(y),y=up();if(h!==i)if(61===t.charCodeAt(Ec)?(y=Wi,Ec++):(y=i,0===Tc&&Oc(Xi)),y!==i){for(v=[],g=up();g!==i;)v.push(g),g=up();if(v!==i)if((g=Yf())!==i){for(b=[],m=up();m!==i;)b.push(m),m=up();b!==i?c=f=[f,p,d,h,y,v,g,b]:(Ec=c,c=i)}else Ec=c,c=i;else Ec=c,c=i}else Ec=c,c=i;else Ec=c,c=i}else Ec=c,c=i;else Ec=c,c=i}else Ec=c,c=i;if(c===i&&(c=null),c!==i)if(41===t.charCodeAt(Ec)?(f=U,Ec++):(f=i,0===Tc&&Oc(G)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?(e,r=function(e,t,r){var n={token:"expression",expressionType:"aggregate",aggregateType:"group_concat"};return n.distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=t,n.separator=r,n}(a,u,c),e=r):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,3)===va?(r=va,Ec+=3):(r=i,0===Tc&&Oc(ga)),r===i&&(t.substr(Ec,3)===ba?(r=ba,Ec+=3):(r=i,0===Tc&&Oc(ma))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,8)===j?(a=j,Ec+=8):(a=i,0===Tc&&Oc(T)),a===i&&(t.substr(Ec,8)===F?(a=F,Ec+=8):(a=i,0===Tc&&Oc(C))),a===i&&(a=null),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if((u=Bf())!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(41===t.charCodeAt(Ec)?(f=U,Ec++):(f=i,0===Tc&&Oc(G)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?(e,r=function(e,t){var r={token:"expression",expressionType:"aggregate",aggregateType:"sum"};return r.distinct=""!=e&&null!=e?"DISTINCT":e,r.expression=t,r}(a,u),e=r):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,3)===xa?(r=xa,Ec+=3):(r=i,0===Tc&&Oc(_a)),r===i&&(t.substr(Ec,3)===wa?(r=wa,Ec+=3):(r=i,0===Tc&&Oc(ka))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,8)===j?(a=j,Ec+=8):(a=i,0===Tc&&Oc(T)),a===i&&(t.substr(Ec,8)===F?(a=F,Ec+=8):(a=i,0===Tc&&Oc(C))),a===i&&(a=null),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if((u=Bf())!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(41===t.charCodeAt(Ec)?(f=U,Ec++):(f=i,0===Tc&&Oc(G)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?(e,r=function(e,t){var r={token:"expression",expressionType:"aggregate",aggregateType:"min"};return r.distinct=""!=e&&null!=e?"DISTINCT":e,r.expression=t,r}(a,u),e=r):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,3)===Ea?(r=Ea,Ec+=3):(r=i,0===Tc&&Oc(Aa)),r===i&&(t.substr(Ec,3)===Sa?(r=Sa,Ec+=3):(r=i,0===Tc&&Oc(ja))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,8)===j?(a=j,Ec+=8):(a=i,0===Tc&&Oc(T)),a===i&&(t.substr(Ec,8)===F?(a=F,Ec+=8):(a=i,0===Tc&&Oc(C))),a===i&&(a=null),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if((u=Bf())!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(41===t.charCodeAt(Ec)?(f=U,Ec++):(f=i,0===Tc&&Oc(G)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?(e,r=function(e,t){var r={token:"expression",expressionType:"aggregate",aggregateType:"max"};return r.distinct=""!=e&&null!=e?"DISTINCT":e,r.expression=t,r}(a,u),e=r):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i)if(e=Ec,t.substr(Ec,3)===Ta?(r=Ta,Ec+=3):(r=i,0===Tc&&Oc(Fa)),r===i&&(t.substr(Ec,3)===Ca?(r=Ca,Ec+=3):(r=i,0===Tc&&Oc(Ia))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if(t.substr(Ec,8)===j?(a=j,Ec+=8):(a=i,0===Tc&&Oc(T)),a===i&&(t.substr(Ec,8)===F?(a=F,Ec+=8):(a=i,0===Tc&&Oc(C))),a===i&&(a=null),a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if((u=Bf())!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if(41===t.charCodeAt(Ec)?(f=U,Ec++):(f=i,0===Tc&&Oc(G)),f!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?(e,r=function(e,t){var r={token:"expression",expressionType:"aggregate",aggregateType:"avg"};return r.distinct=""!=e&&null!=e?"DISTINCT":e,r.expression=t,r}(a,u),e=r):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}}}}Tc--,e===i&&(r=i,0===Tc&&Oc(oa));return e}(),e===i&&(e=Ec,(r=Mf())!==i&&(e,r=function(e){var t={token:"expression",expressionType:"atomic",primaryexpression:"var"};return t.value=e,t}(r)),e=r)))))),Tc--,e===i&&(r=i,0===Tc&&Oc(Fo)),e}function Vf(){var e,r,n,o,s,a;if(Tc++,e=Ec,40===t.charCodeAt(Ec)?(r=L,Ec++):(r=i,0===Tc&&Oc(P)),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if((o=Bf())!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i?(41===t.charCodeAt(Ec)?(a=U,Ec++):(a=i,0===Tc&&Oc(G)),a!==i?(e,e=r=o):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Co)),e}function Wf(){var e,r,n,o,s,a,l,u,c,f,p,d,h,y,v,g,b;if(Tc++,e=Ec,"STR"===t.substr(Ec,3)?(r="STR",Ec+=3):(r=i,0===Tc&&Oc(Ro)),r===i&&("str"===t.substr(Ec,3)?(r="str",Ec+=3):(r=i,0===Tc&&Oc(No))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?(e,(b={token:"expression",expressionType:"builtincall",builtincall:"str"}).args=[a],e=r=b):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,4)===Oo?(r=Oo,Ec+=4):(r=i,0===Tc&&Oc(Lo)),r===i&&(t.substr(Ec,4)===Po?(r=Po,Ec+=4):(r=i,0===Tc&&Oc(Do))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"lang"};return t.args=[e],t}(a),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,11)===Qo?(r=Qo,Ec+=11):(r=i,0===Tc&&Oc(Mo)),r===i&&(t.substr(Ec,11)===Bo?(r=Bo,Ec+=11):(r=i,0===Tc&&Oc(Uo))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(44===t.charCodeAt(Ec)?(u=Ln,Ec++):(u=i,0===Tc&&Oc(Pn)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if((f=Bf())!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?(41===t.charCodeAt(Ec)?(d=U,Ec++):(d=i,0===Tc&&Oc(G)),d!==i?(e,r=function(e,t){var r={token:"expression",expressionType:"builtincall",builtincall:"langmatches"};return r.args=[e,t],r}(a,f),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,8)===Go?(r=Go,Ec+=8):(r=i,0===Tc&&Oc(qo)),r===i&&(t.substr(Ec,8)===Ho?(r=Ho,Ec+=8):(r=i,0===Tc&&Oc(Jo))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"datatype"};return t.args=[e],t}(a),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,5)===zo?(r=zo,Ec+=5):(r=i,0===Tc&&Oc(Vo)),r===i&&(t.substr(Ec,5)===Wo?(r=Wo,Ec+=5):(r=i,0===Tc&&Oc(Xo))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Mf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"bound"};return t.args=[e],t}(a),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,"IRI"===t.substr(Ec,3)?(r="IRI",Ec+=3):(r=i,0===Tc&&Oc(Ko)),r===i&&("iri"===t.substr(Ec,3)?(r="iri",Ec+=3):(r=i,0===Tc&&Oc($o))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"iri"};return t.args=[e],t}(a),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,"URI"===t.substr(Ec,3)?(r="URI",Ec+=3):(r=i,0===Tc&&Oc(Zo)),r===i&&("uri"===t.substr(Ec,3)?(r="uri",Ec+=3):(r=i,0===Tc&&Oc(Yo))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"uri"};return t.args=[e],t}(a),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,5)===es?(r=es,Ec+=5):(r=i,0===Tc&&Oc(ts)),r===i&&(t.substr(Ec,5)===rs?(r=rs,Ec+=5):(r=i,0===Tc&&Oc(ns))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i){if(o=Ec,40===t.charCodeAt(Ec)?(s=L,Ec++):(s=i,0===Tc&&Oc(P)),s!==i){for(a=[],l=up();l!==i;)a.push(l),l=up();if(a!==i)if((l=Bf())!==i){for(u=[],c=up();c!==i;)u.push(c),c=up();u!==i?(41===t.charCodeAt(Ec)?(c=U,Ec++):(c=i,0===Tc&&Oc(G)),c!==i?o=s=[s,a,l,u,c]:(Ec=o,o=i)):(Ec=o,o=i)}else Ec=o,o=i;else Ec=o,o=i}else Ec=o,o=i;o===i&&(o=lp()),o!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"bnode"};return 5===e.length?t.args=[e[2]]:t.args=null,t}(o),e=r):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,8)===is?(r=is,Ec+=8):(r=i,0===Tc&&Oc(os)),r===i&&(t.substr(Ec,8)===ss?(r=ss,Ec+=8):(r=i,0===Tc&&Oc(as))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i&&(o=yf())!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"coalesce"};return t.args=e,t}(o),e=r):(Ec=e,e=i)}else Ec=e,e=i;if(e===i){if(e=Ec,"IF"===t.substr(Ec,2)?(r="IF",Ec+=2):(r=i,0===Tc&&Oc(ls)),r===i&&("if"===t.substr(Ec,2)?(r="if",Ec+=2):(r=i,0===Tc&&Oc(us))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(44===t.charCodeAt(Ec)?(u=Ln,Ec++):(u=i,0===Tc&&Oc(Pn)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if((f=Bf())!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();if(p!==i)if(44===t.charCodeAt(Ec)?(d=Ln,Ec++):(d=i,0===Tc&&Oc(Pn)),d!==i){for(h=[],y=up();y!==i;)h.push(y),y=up();if(h!==i)if((y=Bf())!==i){for(v=[],g=up();g!==i;)v.push(g),g=up();v!==i?(41===t.charCodeAt(Ec)?(g=U,Ec++):(g=i,0===Tc&&Oc(G)),g!==i?(e,r=function(e,t,r){var n={token:"expression",expressionType:"builtincall",builtincall:"if"};return n.args=[e,t,r],n}(a,f,y),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,9)===cs?(r=cs,Ec+=9):(r=i,0===Tc&&Oc(fs)),r===i&&(t.substr(Ec,9)===ps?(r=ps,Ec+=9):(r=i,0===Tc&&Oc(ds)),r===i&&(t.substr(Ec,9)===hs?(r=hs,Ec+=9):(r=i,0===Tc&&Oc(ys)))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"isliteral"};return t.args=[e],t}(a),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,7)===vs?(r=vs,Ec+=7):(r=i,0===Tc&&Oc(gs)),r===i&&(t.substr(Ec,7)===bs?(r=bs,Ec+=7):(r=i,0===Tc&&Oc(ms)),r===i&&(t.substr(Ec,7)===xs?(r=xs,Ec+=7):(r=i,0===Tc&&Oc(_s)))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"isblank"};return t.args=[e],t}(a),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,8)===ws?(r=ws,Ec+=8):(r=i,0===Tc&&Oc(ks)),r===i&&(t.substr(Ec,8)===Es?(r=Es,Ec+=8):(r=i,0===Tc&&Oc(As))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(44===t.charCodeAt(Ec)?(u=Ln,Ec++):(u=i,0===Tc&&Oc(Pn)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if((f=Bf())!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();p!==i?(41===t.charCodeAt(Ec)?(d=U,Ec++):(d=i,0===Tc&&Oc(G)),d!==i?(e,r=function(e,t){var r={token:"expression",expressionType:"builtincall",builtincall:"sameterm"};return r.args=[e,t],r}(a,f),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,5)===Ss?(r=Ss,Ec+=5):(r=i,0===Tc&&Oc(js)),r===i&&(t.substr(Ec,5)===Ts?(r=Ts,Ec+=5):(r=i,0===Tc&&Oc(Fs)),r===i&&(t.substr(Ec,5)===Cs?(r=Cs,Ec+=5):(r=i,0===Tc&&Oc(Is)),r===i&&(t.substr(Ec,5)===Rs?(r=Rs,Ec+=5):(r=i,0===Tc&&Oc(Ns)),r===i&&(t.substr(Ec,5)===Os?(r=Os,Ec+=5):(r=i,0===Tc&&Oc(Ls)),r===i&&(t.substr(Ec,5)===Ps?(r=Ps,Ec+=5):(r=i,0===Tc&&Oc(Ds))))))),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();l!==i?(41===t.charCodeAt(Ec)?(u=U,Ec++):(u=i,0===Tc&&Oc(G)),u!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"isuri"};return t.args=[e],t}(a),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;if(e===i){if(e=Ec,t.substr(Ec,7)===Qs?(r=Qs,Ec+=7):(r=i,0===Tc&&Oc(Ms)),r===i&&(t.substr(Ec,7)===Bs?(r=Bs,Ec+=7):(r=i,0===Tc&&Oc(Us))),r!==i){if(n=[],Gs.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(qs)),o!==i)for(;o!==i;)n.push(o),Gs.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(qs));else n=i;if(n!==i){for(o=[],s=up();s!==i;)o.push(s),s=up();if(o!==i)if(40===t.charCodeAt(Ec)?(s=L,Ec++):(s=i,0===Tc&&Oc(P)),s!==i){for(a=[],l=Ec,u=[],c=up();c!==i;)u.push(c),c=up();for(u!==i&&(c=Bf())!==i?(44===t.charCodeAt(Ec)?(f=Ln,Ec++):(f=i,0===Tc&&Oc(Pn)),f!==i?l=u=[u,c,f]:(Ec=l,l=i)):(Ec=l,l=i);l!==i;){for(a.push(l),l=Ec,u=[],c=up();c!==i;)u.push(c),c=up();u!==i&&(c=Bf())!==i?(44===t.charCodeAt(Ec)?(f=Ln,Ec++):(f=i,0===Tc&&Oc(Pn)),f!==i?l=u=[u,c,f]:(Ec=l,l=i)):(Ec=l,l=i)}if(a!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if((u=Bf())!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();c!==i?(41===t.charCodeAt(Ec)?(f=U,Ec++):(f=i,0===Tc&&Oc(G)),f!==i?(e,r=function(e,t,r){var n={token:"expression",expressionType:"custom"};n.name=e.join("");for(var i=[],o=0;o<t.length;o++)i.push(t[o][1]);return i.push(r),n.args=i,n}(n,a,u),e=r):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;e===i&&(e=function(){var e,r,n,o,s,a,l,u,c,f,p,d,h,y,v;Tc++,e=Ec,t.substr(Ec,5)===Js?(r=Js,Ec+=5):(r=i,0===Tc&&Oc(zs));r===i&&(t.substr(Ec,5)===Vs?(r=Vs,Ec+=5):(r=i,0===Tc&&Oc(Ws)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(40===t.charCodeAt(Ec)?(o=L,Ec++):(o=i,0===Tc&&Oc(P)),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();if(s!==i)if((a=Bf())!==i){for(l=[],u=up();u!==i;)l.push(u),u=up();if(l!==i)if(44===t.charCodeAt(Ec)?(u=Ln,Ec++):(u=i,0===Tc&&Oc(Pn)),u!==i){for(c=[],f=up();f!==i;)c.push(f),f=up();if(c!==i)if((f=Bf())!==i){for(p=[],d=up();d!==i;)p.push(d),d=up();if(p!==i){if(d=Ec,44===t.charCodeAt(Ec)?(h=Ln,Ec++):(h=i,0===Tc&&Oc(Pn)),h!==i){for(y=[],v=up();v!==i;)y.push(v),v=up();y!==i&&(v=Bf())!==i?d=h=[h,y,v]:(Ec=d,d=i)}else Ec=d,d=i;if(d===i&&(d=null),d!==i){for(h=[],y=up();y!==i;)h.push(y),y=up();h!==i?(41===t.charCodeAt(Ec)?(y=U,Ec++):(y=i,0===Tc&&Oc(G)),y!==i?(e,g=f,b=d,(m={token:"expression",expressionType:"regex"}).text=a,m.pattern=g,null!=b&&(m.flags=b[2]),e=r=m):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;var g,b,m;Tc--,e===i&&(r=i,0===Tc&&Oc(Hs));return e}(),e===i&&(e=function(){var e,r,n,o;Tc++,e=Ec,t.substr(Ec,6)===Ks?(r=Ks,Ec+=6):(r=i,0===Tc&&Oc($s));r===i&&(t.substr(Ec,6)===Zs?(r=Zs,Ec+=6):(r=i,0===Tc&&Oc(Ys)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i&&(o=af())!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"exists"};return t.args=[e],t}(o),e=r):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Xs));return e}(),e===i&&(e=function(){var e,r,n,o,s,a;Tc++,e=Ec,t.substr(Ec,3)===ta?(r=ta,Ec+=3):(r=i,0===Tc&&Oc(ra));r===i&&(t.substr(Ec,3)===na?(r=na,Ec+=3):(r=i,0===Tc&&Oc(ia)));if(r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();if(n!==i)if(t.substr(Ec,6)===Ks?(o=Ks,Ec+=6):(o=i,0===Tc&&Oc($s)),o===i&&(t.substr(Ec,6)===Zs?(o=Zs,Ec+=6):(o=i,0===Tc&&Oc(Ys))),o!==i){for(s=[],a=up();a!==i;)s.push(a),a=up();s!==i&&(a=af())!==i?(e,r=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"notexists"};return t.args=[e],t}(a),e=r):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(ea));return e}())))}}}}}}}}}}}}}}return Tc--,e===i&&(r=i,0===Tc&&Oc(Io)),e}function Xf(){var e,r,n,o,s,a,l;return Tc++,e=Ec,(r=Yf())!==i?(n=function(){var e,r,n,o,s,a,l,u;Tc++,e=Ec,64===t.charCodeAt(Ec)?(r="@",Ec++):(r=i,0===Tc&&Oc(yl));if(r!==i){if(n=[],vl.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(gl)),o!==i)for(;o!==i;)n.push(o),vl.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(gl));else n=i;if(n!==i){if(o=[],s=Ec,45===t.charCodeAt(Ec)?(a=Ao,Ec++):(a=i,0===Tc&&Oc(So)),a!==i){if(l=[],bl.test(t.charAt(Ec))?(u=t.charAt(Ec),Ec++):(u=i,0===Tc&&Oc(ml)),u!==i)for(;u!==i;)l.push(u),bl.test(t.charAt(Ec))?(u=t.charAt(Ec),Ec++):(u=i,0===Tc&&Oc(ml));else l=i;l!==i?s=a=[a,l]:(Ec=s,s=i)}else Ec=s,s=i;for(;s!==i;)if(o.push(s),s=Ec,45===t.charCodeAt(Ec)?(a=Ao,Ec++):(a=i,0===Tc&&Oc(So)),a!==i){if(l=[],bl.test(t.charAt(Ec))?(u=t.charAt(Ec),Ec++):(u=i,0===Tc&&Oc(ml)),u!==i)for(;u!==i;)l.push(u),bl.test(t.charAt(Ec))?(u=t.charAt(Ec),Ec++):(u=i,0===Tc&&Oc(ml));else l=i;l!==i?s=a=[a,l]:(Ec=s,s=i)}else Ec=s,s=i;o!==i?(e,c=n,e=r=0===(f=o).length?("@"+c.join("")).toLowerCase():("@"+c.join("")+"-"+f[0][1].join("")).toLowerCase()):(Ec=e,e=i)}else Ec=e,e=i}else Ec=e,e=i;var c,f;Tc--,e===i&&(r=i,0===Tc&&Oc(dl));return e}(),n===i&&(n=Ec,"^^"===t.substr(Ec,2)?(o="^^",Ec+=2):(o=i,0===Tc&&Oc(Oa)),o!==i&&(s=ep())!==i?n=o=[o,s]:(Ec=n,n=i)),n===i&&(n=null),n!==i?(e,a=r,e=r="string"==typeof(l=n)&&l.length>0?{token:"literal",value:a.value,lang:l.slice(1),type:null}:null!=l&&"object"==typeof l?(l.shift(),{token:"literal",value:a.value,lang:null,type:l[0]}):{token:"literal",value:a.value,lang:null,type:null}):(Ec=e,e=i)):(Ec=e,e=i),Tc--,e===i&&(r=i,0===Tc&&Oc(Na)),e}function Kf(){var e;return Tc++,(e=function(){var e;Tc++,e=op(),e===i&&(e=ip())===i&&(e=np());Tc--,e===i&&(i,0===Tc&&Oc(Pa));return e}())===i&&(e=function(){var e;Tc++,e=function(){var e,r,n;Tc++,e=Ec,43===t.charCodeAt(Ec)?(r=yi,Ec++):(r=i,0===Tc&&Oc(vi));r!==i&&(n=op())!==i?(e,e=r=jl(n)):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(Tl));return e}(),e===i&&(e=function(){var e,r,n;Tc++,e=Ec,43===t.charCodeAt(Ec)?(r=yi,Ec++):(r=i,0===Tc&&Oc(vi));r!==i&&(n=ip())!==i?(e,e=r=jl(n)):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(Sl));return e}(),e===i&&(e=function(){var e,r,n;Tc++,e=Ec,43===t.charCodeAt(Ec)?(r=yi,Ec++):(r=i,0===Tc&&Oc(vi));r!==i&&(n=np())!==i?(e,(o=n).value="+"+o.value,e=r=o):(Ec=e,e=i);var o;Tc--,e===i&&(r=i,0===Tc&&Oc(Al));return e}()));Tc--,e===i&&(i,0===Tc&&Oc(Da));return e}(),e===i&&(e=$f())),Tc--,e===i&&(i,0===Tc&&Oc(La)),e}function $f(){var e;return Tc++,e=function(){var e,r,n;Tc++,e=Ec,45===t.charCodeAt(Ec)?(r=Ao,Ec++):(r=i,0===Tc&&Oc(So));r!==i&&(n=op())!==i?(e,e=r=Cl(n)):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(Rl));return e}(),e===i&&(e=function(){var e,r,n;Tc++,e=Ec,45===t.charCodeAt(Ec)?(r=Ao,Ec++):(r=i,0===Tc&&Oc(So));r!==i&&(n=ip())!==i?(e,e=r=Cl(n)):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(Il));return e}(),e===i&&(e=function(){var e,r,n;Tc++,e=Ec,45===t.charCodeAt(Ec)?(r=Ao,Ec++):(r=i,0===Tc&&Oc(So));r!==i&&(n=np())!==i?(e,e=r=Cl(n)):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(Fl));return e}())),Tc--,e===i&&(i,0===Tc&&Oc(Qa)),e}function Zf(){var e,r;return Tc++,e=Ec,t.substr(Ec,4)===Ba?(r=Ba,Ec+=4):(r=i,0===Tc&&Oc(Ua)),r===i&&(t.substr(Ec,4)===Ga?(r=Ga,Ec+=4):(r=i,0===Tc&&Oc(qa))),r!==i&&(e,r={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}),(e=r)===i&&(e=Ec,t.substr(Ec,5)===Ha?(r=Ha,Ec+=5):(r=i,0===Tc&&Oc(Ja)),r===i&&(t.substr(Ec,5)===za?(r=za,Ec+=5):(r=i,0===Tc&&Oc(Va))),r!==i&&(e,r={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}),e=r),Tc--,e===i&&(r=i,0===Tc&&Oc(Ma)),e}function Yf(){var e,r;return Tc++,e=Ec,r=function(){var e,r,n,o;Tc++,e=Ec,t.substr(Ec,3)===Kl?(r=Kl,Ec+=3):(r=i,0===Tc&&Oc($l));if(r!==i){for(n=[],Zl.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(Yl)),o===i&&(o=ap());o!==i;)n.push(o),Zl.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(Yl)),o===i&&(o=ap());n!==i?(t.substr(Ec,3)===Kl?(o=Kl,Ec+=3):(o=i,0===Tc&&Oc($l)),o!==i?(e,e=r=ql(n)):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Xl));return e}(),r!==i&&(e,r=Xa(r)),(e=r)===i&&(e=Ec,r=function(){var e,r,n,o;Tc++,e=Ec,t.substr(Ec,3)===tu?(r=tu,Ec+=3):(r=i,0===Tc&&Oc(ru));if(r!==i){for(n=[],nu.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(iu)),o===i&&(o=ap());o!==i;)n.push(o),nu.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(iu)),o===i&&(o=ap());n!==i?(t.substr(Ec,3)===tu?(o=tu,Ec+=3):(o=i,0===Tc&&Oc(ru)),o!==i?(e,e=r=ql(n)):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(eu));return e}(),r!==i&&(e,r=Xa(r)),(e=r)===i&&(e=Ec,r=function(){var e,r,n,o;Tc++,e=Ec,39===t.charCodeAt(Ec)?(r=Ml,Ec++):(r=i,0===Tc&&Oc(Bl));if(r!==i){for(n=[],Ul.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(Gl)),o===i&&(o=ap());o!==i;)n.push(o),Ul.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(Gl)),o===i&&(o=ap());n!==i?(39===t.charCodeAt(Ec)?(o=Ml,Ec++):(o=i,0===Tc&&Oc(Bl)),o!==i?(e,e=r=ql(n)):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Ql));return e}(),r!==i&&(e,r=Xa(r)),(e=r)===i&&(e=Ec,r=function(){var e,r,n,o;Tc++,e=Ec,34===t.charCodeAt(Ec)?(r=Jl,Ec++):(r=i,0===Tc&&Oc(zl));if(r!==i){for(n=[],Vl.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(Wl)),o===i&&(o=ap());o!==i;)n.push(o),Vl.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(Wl)),o===i&&(o=ap());n!==i?(34===t.charCodeAt(Ec)?(o=Jl,Ec++):(o=i,0===Tc&&Oc(zl)),o!==i?(e,e=r=ql(n)):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(Hl));return e}(),r!==i&&(e,r=Xa(r)),e=r))),Tc--,e===i&&(r=i,0===Tc&&Oc(Wa)),e}function ep(){var e,t;return Tc++,e=Ec,(t=tp())!==i&&(e,t={token:"uri",prefix:null,suffix:null,value:t}),(e=t)===i&&(e=Ec,t=function(){var e,t;Tc++,e=Ec,t=function(){var e,t,r;Tc++,e=Ec,t=rp(),t!==i&&(r=hp())!==i?(e,e=t=function(e,t){return[e,t]}(t,r)):(Ec=e,e=i);Tc--,e===i&&(t=i,0===Tc&&Oc(ol));return e}(),t!==i&&(e,t=function(e){return{token:"uri",prefix:e[0],suffix:e[1],value:null}}(t));e=t,e===i&&(e=Ec,(t=rp())!==i&&(e,t=function(e){return{token:"uri",prefix:e,suffix:"",value:null}}(t)),e=t);Tc--,e===i&&(t=i,0===Tc&&Oc($a));return e}(),t!==i&&e,e=t),Tc--,e===i&&(t=i,0===Tc&&Oc(Ka)),e}function tp(){var e,r,n,o;if(Tc++,e=Ec,60===t.charCodeAt(Ec)?(r=Zi,Ec++):(r=i,0===Tc&&Oc(Yi)),r!==i){for(n=[],el.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(tl));o!==i;)n.push(o),el.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(tl));n!==i?(62===t.charCodeAt(Ec)?(o=eo,Ec++):(o=i,0===Tc&&Oc(to)),o!==i?(e,e=r=n.join("")):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Ya)),e}function rp(){var e,r,n;return Tc++,e=Ec,r=function(){var e,r,n,o;if(Tc++,e=Ec,r=cp(),r!==i){for(n=[],(o=dp())===i&&(46===t.charCodeAt(Ec)?(o=Gr,Ec++):(o=i,0===Tc&&Oc(qr)));o!==i;)n.push(o),(o=dp())===i&&(46===t.charCodeAt(Ec)?(o=Gr,Ec++):(o=i,0===Tc&&Oc(qr)));n!==i?(e,e=r=function(e,t){if("."==t[t.length-1])throw new Error("Wrong PN_PREFIX, cannot finish with '.'");return e+t.join("")}(r,n)):(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(cc));return e}(),r===i&&(r=null),r!==i?(58===t.charCodeAt(Ec)?(n=nl,Ec++):(n=i,0===Tc&&Oc(il)),n!==i?(e,e=r):(Ec=e,e=i)):(Ec=e,e=i),Tc--,e===i&&(r=i,0===Tc&&Oc(rl)),e}function np(){var e,r,n,o;if(Tc++,e=Ec,r=[],_l.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(wl)),n!==i)for(;n!==i;)r.push(n),_l.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(wl));else r=i;return r!==i&&(e,(o={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#integer"}).value=gp(r),r=o),Tc--,(e=r)===i&&(r=i,0===Tc&&Oc(xl)),e}function ip(){var e,r,n,o,s,a;if(Tc++,e=Ec,r=[],_l.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(wl)),n!==i)for(;n!==i;)r.push(n),_l.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(wl));else r=i;if(r!==i)if(46===t.charCodeAt(Ec)?(n=Gr,Ec++):(n=i,0===Tc&&Oc(qr)),n!==i){for(o=[],_l.test(t.charAt(Ec))?(s=t.charAt(Ec),Ec++):(s=i,0===Tc&&Oc(wl));s!==i;)o.push(s),_l.test(t.charAt(Ec))?(s=t.charAt(Ec),Ec++):(s=i,0===Tc&&Oc(wl));o!==i?(e,(a={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"}).value=gp([r,n,o]),e=r=a):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;if(e===i)if(e=Ec,46===t.charCodeAt(Ec)?(r=Gr,Ec++):(r=i,0===Tc&&Oc(qr)),r!==i){if(n=[],_l.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(wl)),o!==i)for(;o!==i;)n.push(o),_l.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(wl));else n=i;n!==i?(e,r=function(e,t){var r={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};return r.value=gp([e,t]),r}(r,n),e=r):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(kl)),e}function op(){var e,r,n,o,s,a;if(Tc++,e=Ec,r=[],_l.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(wl)),n!==i)for(;n!==i;)r.push(n),_l.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(wl));else r=i;if(r!==i)if(46===t.charCodeAt(Ec)?(n=Gr,Ec++):(n=i,0===Tc&&Oc(qr)),n!==i){for(o=[],_l.test(t.charAt(Ec))?(s=t.charAt(Ec),Ec++):(s=i,0===Tc&&Oc(wl));s!==i;)o.push(s),_l.test(t.charAt(Ec))?(s=t.charAt(Ec),Ec++):(s=i,0===Tc&&Oc(wl));o!==i&&(s=sp())!==i?(e,(a={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"}).value=gp([r,n,o,s]),e=r=a):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;if(e===i){if(e=Ec,46===t.charCodeAt(Ec)?(r=Gr,Ec++):(r=i,0===Tc&&Oc(qr)),r!==i){if(n=[],_l.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(wl)),o!==i)for(;o!==i;)n.push(o),_l.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(wl));else n=i;n!==i&&(o=sp())!==i?(e,r=function(e,t,r){var n={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};return n.value=gp([e,t,r]),n}(r,n,o),e=r):(Ec=e,e=i)}else Ec=e,e=i;if(e===i){if(e=Ec,r=[],_l.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(wl)),n!==i)for(;n!==i;)r.push(n),_l.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(wl));else r=i;r!==i&&(n=sp())!==i?(e,r=function(e,t){var r={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};return r.value=gp([e,t]),r}(r,n),e=r):(Ec=e,e=i)}}return Tc--,e===i&&(r=i,0===Tc&&Oc(El)),e}function sp(){var e,r,n,o,s;if(Tc++,e=Ec,Ol.test(t.charAt(Ec))?(r=t.charAt(Ec),Ec++):(r=i,0===Tc&&Oc(Ll)),r!==i)if(Pl.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(Dl)),n===i&&(n=null),n!==i){if(o=[],_l.test(t.charAt(Ec))?(s=t.charAt(Ec),Ec++):(s=i,0===Tc&&Oc(wl)),s!==i)for(;s!==i;)o.push(s),_l.test(t.charAt(Ec))?(s=t.charAt(Ec),Ec++):(s=i,0===Tc&&Oc(wl));else o=i;o!==i?(e,e=r=gp([r,n,o])):(Ec=e,e=i)}else Ec=e,e=i;else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(Nl)),e}function ap(){var e,r,n;return Tc++,e=Ec,92===t.charCodeAt(Ec)?(r="\\",Ec++):(r=i,0===Tc&&Oc(su)),r!==i?(au.test(t.charAt(Ec))?(n=t.charAt(Ec),Ec++):(n=i,0===Tc&&Oc(lu)),n!==i?e=r=[r,n]:(Ec=e,e=i)):(Ec=e,e=i),Tc--,e===i&&(r=i,0===Tc&&Oc(ou)),e}function lp(){var e,r,n,o;if(Tc++,e=Ec,40===t.charCodeAt(Ec)?(r=L,Ec++):(r=i,0===Tc&&Oc(P)),r!==i){for(n=[],o=up();o!==i;)n.push(o),o=up();n!==i?(41===t.charCodeAt(Ec)?(o=U,Ec++):(o=i,0===Tc&&Oc(G)),o!==i?(e,e=r={token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}):(Ec=e,e=i)):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(uu)),e}function up(){var e;return Tc++,fu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(pu)),e===i&&(du.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(hu)),e===i&&(yu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(vu)),e===i&&(gu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(bu)),e===i&&(e=function(){var e,r,n,o;Tc++,e=Ec,35===t.charCodeAt(Ec)?(r="#",Ec++):(r=i,0===Tc&&Oc(_u));if(r!==i){for(n=[],wu.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(ku));o!==i;)n.push(o),wu.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(ku));n!==i?e=r=[r,n]:(Ec=e,e=i)}else Ec=e,e=i;Tc--,e===i&&(r=i,0===Tc&&Oc(mu));return e}())))),Tc--,e===i&&(i,0===Tc&&Oc(cu)),e}function cp(){var e;return Tc++,Su.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(ju)),e===i&&(Tu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Fu)),e===i&&(Cu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Iu)),e===i&&(Ru.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Nu)),e===i&&(Ou.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Lu)),e===i&&(Pu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Du)),e===i&&(Qu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Mu)),e===i&&(Bu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Uu)),e===i&&(Gu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(qu)),e===i&&(Hu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Ju)),e===i&&(zu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Vu)),e===i&&(Wu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Xu)),e===i&&(Ku.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc($u)),e===i&&(Zu.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(Yu))))))))))))))),Tc--,e===i&&(i,0===Tc&&Oc(Au)),e}function fp(){var e;return Tc++,(e=cp())===i&&(95===t.charCodeAt(Ec)?(e="_",Ec++):(e=i,0===Tc&&Oc(tc))),Tc--,e===i&&(i,0===Tc&&Oc(ec)),e}function pp(){var e,r,n,o;if(Tc++,e=Ec,(r=fp())===i&&(_l.test(t.charAt(Ec))?(r=t.charAt(Ec),Ec++):(r=i,0===Tc&&Oc(wl))),r!==i){for(n=[],(o=fp())===i&&(_l.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(wl)),o===i&&(nc.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(ic)),o===i&&(oc.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(sc)),o===i&&(ac.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(lc))))));o!==i;)n.push(o),(o=fp())===i&&(_l.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(wl)),o===i&&(nc.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(ic)),o===i&&(oc.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(sc)),o===i&&(ac.test(t.charAt(Ec))?(o=t.charAt(Ec),Ec++):(o=i,0===Tc&&Oc(lc))))));n!==i?(e,e=r=r+n.join("")):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(rc)),e}function dp(){var e;return Tc++,(e=fp())===i&&(45===t.charCodeAt(Ec)?(e=Ao,Ec++):(e=i,0===Tc&&Oc(So)),e===i&&(_l.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(wl)),e===i&&(nc.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(ic)),e===i&&(oc.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(sc)),e===i&&(ac.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(lc))))))),Tc--,e===i&&(i,0===Tc&&Oc(uc)),e}function hp(){var e,r,n,o;if(Tc++,e=Ec,(r=fp())===i&&(_l.test(t.charAt(Ec))?(r=t.charAt(Ec),Ec++):(r=i,0===Tc&&Oc(wl)),r===i&&(58===t.charCodeAt(Ec)?(r=nl,Ec++):(r=i,0===Tc&&Oc(il)),r===i&&(r=yp()))),r!==i){for(n=[],(o=dp())===i&&(46===t.charCodeAt(Ec)?(o=Gr,Ec++):(o=i,0===Tc&&Oc(qr)),o===i&&(58===t.charCodeAt(Ec)?(o=nl,Ec++):(o=i,0===Tc&&Oc(il)),o===i&&(o=yp())));o!==i;)n.push(o),(o=dp())===i&&(46===t.charCodeAt(Ec)?(o=Gr,Ec++):(o=i,0===Tc&&Oc(qr)),o===i&&(58===t.charCodeAt(Ec)?(o=nl,Ec++):(o=i,0===Tc&&Oc(il)),o===i&&(o=yp())));n!==i?(e,e=r=r+(n||[]).join("")):(Ec=e,e=i)}else Ec=e,e=i;return Tc--,e===i&&(r=i,0===Tc&&Oc(fc)),e}function yp(){var e;return Tc++,e=function(){var e,r,n,o,s;Tc++,e=Ec,r=Ec,37===t.charCodeAt(Ec)?(n="%",Ec++):(n=i,0===Tc&&Oc(yc));n!==i&&(o=vp())!==i&&(s=vp())!==i?r=n=[n,o,s]:(Ec=r,r=i);r!==i&&(e,r=r.join(""));e=r,Tc--,e===i&&(r=i,0===Tc&&Oc(dc));return e}(),e===i&&(e=function(){var e,r,n;Tc++,e=Ec,92===t.charCodeAt(Ec)?(r="\\",Ec++):(r=i,0===Tc&&Oc(su));r!==i?(95===t.charCodeAt(Ec)?(n="_",Ec++):(n=i,0===Tc&&Oc(tc)),n===i&&(126===t.charCodeAt(Ec)?(n="~",Ec++):(n=i,0===Tc&&Oc(wc)),n===i&&(46===t.charCodeAt(Ec)?(n=Gr,Ec++):(n=i,0===Tc&&Oc(qr)),n===i&&(45===t.charCodeAt(Ec)?(n=Ao,Ec++):(n=i,0===Tc&&Oc(So)),n===i&&(33===t.charCodeAt(Ec)?(n=bi,Ec++):(n=i,0===Tc&&Oc(mi)),n===i&&(36===t.charCodeAt(Ec)?(n=fl,Ec++):(n=i,0===Tc&&Oc(pl)),n===i&&(38===t.charCodeAt(Ec)?(n="&",Ec++):(n=i,0===Tc&&Oc(kc)),n===i&&(39===t.charCodeAt(Ec)?(n=Ml,Ec++):(n=i,0===Tc&&Oc(Bl)),n===i&&(40===t.charCodeAt(Ec)?(n=L,Ec++):(n=i,0===Tc&&Oc(P)),n===i&&(41===t.charCodeAt(Ec)?(n=U,Ec++):(n=i,0===Tc&&Oc(G)),n===i&&(42===t.charCodeAt(Ec)?(n=q,Ec++):(n=i,0===Tc&&Oc(H)),n===i&&(43===t.charCodeAt(Ec)?(n=yi,Ec++):(n=i,0===Tc&&Oc(vi)),n===i&&(44===t.charCodeAt(Ec)?(n=Ln,Ec++):(n=i,0===Tc&&Oc(Pn)),n===i&&(59===t.charCodeAt(Ec)?(n=wt,Ec++):(n=i,0===Tc&&Oc(kt)),n===i&&(58===t.charCodeAt(Ec)?(n=nl,Ec++):(n=i,0===Tc&&Oc(il)),n===i&&(61===t.charCodeAt(Ec)?(n=Wi,Ec++):(n=i,0===Tc&&Oc(Xi)),n===i&&(47===t.charCodeAt(Ec)?(n=ai,Ec++):(n=i,0===Tc&&Oc(li)),n===i&&(63===t.charCodeAt(Ec)?(n=di,Ec++):(n=i,0===Tc&&Oc(hi)),n===i&&(35===t.charCodeAt(Ec)?(n=xu,Ec++):(n=i,0===Tc&&Oc(_u)),n===i&&(64===t.charCodeAt(Ec)?(n=hl,Ec++):(n=i,0===Tc&&Oc(yl)),n===i&&(37===t.charCodeAt(Ec)?(n=hc,Ec++):(n=i,0===Tc&&Oc(yc)))))))))))))))))))))),n!==i?(e,e=r="\\"+n):(Ec=e,e=i)):(Ec=e,e=i);Tc--,e===i&&(r=i,0===Tc&&Oc(_c));return e}()),Tc--,e===i&&(i,0===Tc&&Oc(pc)),e}function vp(){var e;return Tc++,_l.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(wl)),e===i&&(gc.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(bc)),e===i&&(mc.test(t.charAt(Ec))?(e=t.charAt(Ec),Ec++):(e=i,0===Tc&&Oc(xc)))),Tc--,e===i&&(i,0===Tc&&Oc(vc)),e}var gp=function(e){for(var t="",r=0;r<e.length;r++)"string"==typeof e[r]?t+=e[r]:t+=e[r].join("");return t},bp=0,mp={},xp=function(e,t){mp[e]=t},_p=function(e){mp.null=e},wp=function(e){var t="";if(null==e)return null;for(var r=0;r<e.length;r++)t+=e[r];return t.toUpperCase()};if((n=s())!==i&&Ec===t.length)return n;throw n!==i&&Ec<t.length&&Oc({type:"end"}),Lc(jc,Sc<t.length?t.charAt(Sc):null,Sc<t.length?Nc(Sc,Sc+1):Nc(Sc,Sc))}}}()},{}],129:[function(e,t,r){e("./btree").Tree;var n=e("./utils"),i=n,o=e("./lexicon").Lexicon;PersistentLexicon=function(e,t){var r=this;n.registerIndexedDB(r),this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,r.dbName=t||"rdfstorejs";var i=r.indexedDB.open(this.dbName+"_lexicon",1);i.onerror=function(t){e(null,new Error("Error opening IndexedDB: "+t.target.errorCode))},i.onsuccess=function(t){r.db=t.target.result,e(r)},i.onupgradeneeded=function(e){r.db=e.target.result,r.db.createObjectStore("knownGraphs",{keyPath:"oid"}).createIndex("uriToken","uriToken",{unique:!0}),r.db.createObjectStore("components",{keyPath:"id",autoIncrement:!0}).createIndex("value","value",{unique:!0})}},PersistentLexicon.prototype.registerGraph=function(e,t,r){if(e!=this.defaultGraphOid){var n=this.db.transaction(["knownGraphs"],"readwrite");n.onerror=function(e){r(null,new Error(e.target.statusCode))};var i=n.objectStore("knownGraphs");i.get(t).onsuccess=function(n){n.target.result?r(!0):i.add({oid:e,uriToken:t}).onsuccess=function(e){r(!0)}}}else r()},PersistentLexicon.prototype.registeredGraphs=function(e,t){var r=[],n=this.db.transaction(["knownGraphs"],"readwrite").objectStore("knownGraphs").openCursor();n.onsuccess=function(n){var i=n.target.result;i?(!0===e?r.push(i.value.uriToken):r.push(i.value.oid),i.continue()):t(r)},n.onerror=function(e){t(null,new Error("Error retrieving data from the cursor: "+e.target.errorCode))}},PersistentLexicon.prototype.registerUri=function(e,t){if(e===this.defaultGraphUri)t(this.defaultGraphOid);else{var r=this.db.transaction(["components"],"readwrite").objectStore("components"),n=r.index("value").get("_u:"+e);n.onsuccess=function(n){var i=n.target.result;if(i){i.counter++;var o=i.id,s=r.put(i);s.onsuccess=function(e){t(o)},s.onerror=function(e){t(null,new Error("Error updating the URI data"+e.target.errorCode))}}else{var a=r.add({value:"_u:"+e,counter:0,uri:!0});a.onsuccess=function(e){t(e.target.result)},a.onerror=function(e){t(null,new Error("Error inserting the URI data"+e.target.errorCode))}}},n.onerror=function(e){t(null,new Error("Error retrieving the URI data"+e.target.errorCode))}}},PersistentLexicon.prototype.resolveUri=function(e,t){if(e===this.defaultGraphUri)t(this.defaultGraphOid);else{var r=this.db.transaction(["components"]).objectStore("components").index("value").get("_u:"+e);r.onsuccess=function(e){null!=e.target.result?t(e.target.result.id):t(-1)},r.onerror=function(e){t(null,new Error("Error retrieving uri data "+e.target.errorCode))}}},PersistentLexicon.prototype.resolveUriCost=function(e,t){if(e===this.defaultGraphUri)t(0);else{var r=that.db.transaction(["components"]).objectStore("components").index("value").get("_u:"+e);r.onsuccess=function(e){null!=e.target.result?t(e.target.result.cost):t(-1)},r.onerror=function(e){t(null,new Error("Error retrieving uri data "+e.target.errorCode))}}},PersistentLexicon.prototype.registerBlank=function(e){var t=guid(),r=this.db.transaction(["components"],"readwrite").objectStore("components").add({value:"_b:"+t,counter:0,label:!0});r.onsuccess=function(t){e(t.target.result)},r.onerror=function(t){e(null,new Error("Error inserting the URI data"+t.target.errorCode))}},PersistentLexicon.prototype.resolveBlankCost=function(e,t){t(0)},PersistentLexicon.prototype.registerLiteral=function(e,t){var r=this.db.transaction(["components"],"readwrite").objectStore("components"),n=r.index("value").get("_l:"+e);n.onsuccess=function(n){var i=n.target.result;if(i){i.counter++;var o=i.id,s=r.put(i);s.onsuccess=function(e){t(o)},s.onerror=function(e){t(null,new Error("Error updating the literal data"+e.target.errorCode))}}else{var a=r.add({value:"_l:"+e,counter:0,literal:!0});a.onsuccess=function(e){t(e.target.result)},a.onerror=function(e){t(null,new Error("Error inserting the literal data"+e.target.errorCode))}}},n.onerror=function(e){t(null,new Error("Error retrieving the literal data"+e.target.errorCode))}},PersistentLexicon.prototype.resolveLiteral=function(e,t){var r=that.db.transaction(["components"]).objectStore("components").index("value").get("_l:"+e);r.onsuccess=function(e){null!=e.target.result?t(e.target.result.id):t(-1)},r.onerror=function(e){t(null,new Error("Error retrieving literal data "+e.target.errorCode))}},PersistentLexicon.prototype.resolveLiteralCost=function(e,t){var r=that.db.transaction(["components"]).objectStore("components").index("components").get(e);r.onsuccess=function(e){null!=e.target.result?t(e.target.result.cost):t(-1)},r.onerror=function(e){t(null,new Error("Error retrieving literal data "+e.target.errorCode))}},PersistentLexicon.prototype.parseLiteral=function(e){return o.prototype.parseLiteral(e)},PersistentLexicon.prototype.parseUri=function(e){return o.prototype.parseUri(e)},PersistentLexicon.prototype.retrieve=function(e,t){var r,n=this;e===this.defaultGraphOid?t({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):((r=n.db.transaction(["components"]).objectStore("components").get(e)).onsuccess=function(e){if(null!=e.target.result)if(null!=e.target.result.label){var r="_:"+e.target.result.id;t({token:"blank",value:r})}else null!=e.target.result.uri?t(n.parseUri(e.target.result.value.slice(3,e.target.result.value.length))):null!=e.target.result.literal?t(n.parseLiteral(e.target.result.value.slice(3,e.target.result.value.length))):(console.log(e.target.result),t(null,new Error("Unknown type of component "+e.target.result)));else t(null,null)},r.onerror=function(e){t(null,new Error("Error searching in blanks data "+e.target.errorCode))})},PersistentLexicon.prototype.clear=function(e){this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri};var t,r=function(){null!=e&&e()};(t=this.db.transaction(["components"],"readwrite").objectStore("components").clear()).onsuccess=r,t.onerror=r},PersistentLexicon.prototype.unregister=function(e,t,r){var n=this;i.seq((function(r){n._unregisterTerm(e.subject.token,t.subject,r)}),(function(r){n._unregisterTerm(e.predicate.token,t.predicate,r)}),(function(r){n._unregisterTerm(e.object.token,t.object,r)}),(function(r){null!=e.graph?n._unregisterTerm(e.graph.token,t.graph,r):r()}))((function(){r(!0)}))},PersistentLexicon.prototype._unregisterTerm=function(e,t,r){var n=this.db.transaction(["components","knownGraphs"],"readwrite");if("uri"===e)if(t!=this.defaultGraphOid){n.objectStore("components").delete(t).onsuccess=void(n.objectStore("knownGraphs").delete(t).onsuccess=function(){r()})}else r();else n.objectStore("components").delete(t).onsuccess=function(){r()}},t.exports={PersistentLexicon:PersistentLexicon}},{"./btree":123,"./lexicon":126,"./utils":140}],130:[function(e,t,r){var n=e("./utils");PersistentQuadBackend=function(e,t){var r=this;if(0!==arguments){for(var i in n.registerIndexedDB(r),this.indexMap={},this.indices=["S","P","O","G","SP","SO","SG","PO","PG","OG","SPO","SPG","SOG","POG","SPOG"],this.componentOrders={S:["subject","predicate","object","graph"],P:["predicate","subject","object","graph"],O:["object","subject","predicate","graph"],G:["graph","subject","predicate","object"],SP:["subject","predicate","object","graph"],SO:["subject","object","predicate","graph"],SG:["subject","graph","predicate","object"],PO:["predicate","object","subject","graph"],PG:["predicate","graph","subject","object"],OG:["object","graph","subject","predicate"],SPO:["subject","predicate","object","graph"],SPG:["subject","predicate","graph","object"],SOG:["subject","object","graph","predicate"],POG:["predicate","object","graph","subject"],SPOG:["subject","predicate","object","graph"]},this.componentOrdersMap={},this.componentOrders){var o=this.componentOrders[i],s=o.slice(0,i.length).sort().join(".");this.componentOrdersMap[s]=i}r.dbName=e.name||"rdfstorejs";var a=r.indexedDB.open(this.dbName+"_db",1);a.onerror=function(e){t(null,new Error("Error opening IndexedDB: "+e.target.errorCode))},a.onsuccess=function(e){r.db=e.target.result,t(r)},a.onupgradeneeded=function(e){var t=e.target.result.createObjectStore(r.dbName,{keyPath:"SPOG"});n.each(r.indices,(function(e){"SPOG"!==e&&t.createIndex(e,e,{unique:!1})}))}}},PersistentQuadBackend.prototype.index=function(e,t){var r=this;n.each(this.indices,(function(t){e[t]=r._genMinIndexKey(e,t)}));var i=r.db.transaction([r.dbName],"readwrite");i.oncomplete=function(e){},i.onerror=function(e){t(null,new Error(e.target.statusCode))},i.objectStore(r.dbName).add(e).onsuccess=function(e){t(!0)}},PersistentQuadBackend.prototype.range=function(e,t){var r=this,n=r.db.transaction([r.dbName]).objectStore(r.dbName),i=this._indexForPattern(e),o=this._genMinIndexKey(e,i),s=this._genMaxIndexKey(e,i),a=r.IDBKeyRange.bound(o,s,!1,!1),l=[];("SPOG"===i?n:n.index(i)).openCursor(a).onsuccess=function(e){var r=e.target.result;r?(l.push(r.value),r.continue()):t(l)}},PersistentQuadBackend.prototype.search=function(e,t){var r=this,n=r.db.transaction([r.dbName]).objectStore(r.dbName),i=this._genMinIndexKey(e,"SPOG"),o=n.get(i);o.onerror=function(e){t(null,new Error(e.target.statusCode))},o.onsuccess=function(e){t(null!=e.target.result)}},PersistentQuadBackend.prototype.delete=function(e,t){var r=this,n=r._genMinIndexKey(e,"SPOG"),i=r.db.transaction([r.dbName],"readwrite").objectStore(r.dbName).delete(n);i.onsuccess=function(){t(!0)},i.onerror=function(e){t(null,new Error(e.target.statusCode))}},PersistentQuadBackend.prototype._genMinIndexKey=function(e,t){var r=this.componentOrders[t];return n.map(r,(function(t){return"string"==typeof e[t]||null==e[t]?"0":e[t]})).join(".")},PersistentQuadBackend.prototype._genMaxIndexKey=function(e,t){for(var r=this.componentOrders[t],i=[],o=0;o<r.length;o++){var s=e[r[o]];i[o]="string"==typeof s?"z":s}return n.map(i,(function(e){return""+e})).join(".")},PersistentQuadBackend.prototype._indexForPattern=function(e){var t=e.indexKey.sort().join("."),r=this.componentOrdersMap[t];if(null==r)throw new Error("Error, cannot find index for indexKey "+t);return r},PersistentQuadBackend.prototype.clear=function(e){var t,r=this;(t=r.db.transaction([r.dbName],"readwrite").objectStore(r.dbName).clear()).onsuccess=function(){e()},t.onerror=function(){e()}},t.exports.PersistentQuadBackend=PersistentQuadBackend},{"./utils":140}],131:[function(e,t,r){var n=e("./quad_index").QuadIndex,i=e("./utils");QuadBackend=function(e,t){this.indexMap={},this.treeOrder=e.treeOrder,this.indices=e.index||QuadBackend.allIndices,this.componentOrders=QuadBackend.componentOrders;var r=this;i.eachSeries(this.indices,(function(e,t){new n({order:r.treeOrder,componentOrder:r.componentOrders[e]},(function(n){r.indexMap[e]=n,t()}))}),(function(){t(r)}))},QuadBackend.allIndices=["SPOG","GP","OGS","POG","GSP","OS"],QuadBackend.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},QuadBackend.prototype._indexForPattern=function(e){for(var t=e.indexKey,r=0;r<QuadBackend.allIndices.length;r++)for(var n=QuadBackend.allIndices[r],o=QuadBackend.componentOrders[n],s=0;s<o.length&&!1!==i.include(t,o[s]);s++)if(s==t.length-1)return n;return"SPOG"},QuadBackend.prototype.index=function(e,t){var r=this;i.eachSeries(this.indices,(function(t,n){r.indexMap[t].insert(e,(function(){n()}))}),(function(){t(!0)}))},QuadBackend.prototype.range=function(e,t){var r=this._indexForPattern(e),n=this.indexMap[r];null!=n&&n.range(e,(function(e){t(e)}))},QuadBackend.prototype.search=function(e,t){var r=this.indexMap.SPOG;null!=r&&r.search(e,(function(e){t(null!=e)}))},QuadBackend.prototype.delete=function(e,t){var r=this;i.eachSeries(this.indices,(function(t,n){r.indexMap[t].delete(e,(function(){n()}))}),(function(){t(!0)}))},QuadBackend.prototype.clear=function(e){var t=this;i.eachSeries(this.indices,(function(e,r){new n({order:t.treeOrder,componentOrder:t.componentOrders[e]},(function(n){t.indexMap[e]=n,r()}))}),(function(){e(!0)}))},t.exports.QuadBackend=QuadBackend},{"./quad_index":132,"./utils":140}],132:[function(e,t,r){var n=e("./btree").Tree,i=e("./utils"),o=e("./utils");NodeKey=function(e,t){this.subject=e.subject,this.predicate=e.predicate,this.object=e.object,this.graph=e.graph,this.order=t},NodeKey.prototype.comparator=function(e){for(var t=0;t<this.order.length;t++){var r=this.order[t];if(null==e[r])return 0;if(this[r]<e[r])return-1;if(this[r]>e[r])return 1}return 0},Pattern=function(e){this.subject=e.subject,this.predicate=e.predicate,this.object=e.object,this.graph=e.graph,this.indexKey=[],this.keyComponents={};var t=[],r=[],n=this;i.forEach(["subject","predicate","object","graph"],(function(e){"string"==typeof n[e]?(r.push(e),n.keyComponents[e]=null):(t.push(e),n.keyComponents[e]=n[e],n.indexKey.push(e))})),this.order=t.concat(r),this.key=new NodeKey(this.keyComponents,this.order)},QuadIndex=function(e,t){0!=arguments&&(this.componentOrder=e.componentOrder,n.call(this,e.order,(function(e){e.comparator=function(t,r){for(var n=0;n<e.componentOrder.length;n++){var i=e.componentOrder[n],o=t[i],s=r[i];if(o<s)return-1;if(o>s)return 1}return 0},e.rangeComparator=function(t,r){for(var n=0;n<e.componentOrder.length;n++){var i=e.componentOrder[n];if(null==r[i]||null==t[i])return 0;if(t[i]<r[i])return-1;if(t[i]>r[i])return 1}return 0},t(e)})))},QuadIndex.prototype=i.create(n.prototype,{constructor:n}),QuadIndex.prototype.insert=function(e,t){n.prototype.insert.call(this,e,null,(function(e){t(e)}))},QuadIndex.prototype.search=function(e,t){n.prototype.search.call(this,e,(function(e){t(e)}),!0)},QuadIndex.prototype.range=function(e,t){this._rangeTraverse(this,this.root,e,t)},QuadIndex.prototype._rangeTraverse=function(e,t,r,n){var i=r.key,s=[],a=[t];o.whilst((function(){return a.length>0}),(function(t){for(var r=a.shift(),n=0;n<r.numberActives&&-1===e.rangeComparator(r.keys[n].key,i);)n++;if(!0===r.isLeaf){for(var l=n;l<r.numberActives&&0===e.rangeComparator(r.keys[l].key,i);)s.push(r.keys[l].key),l++;t()}else e._diskRead(r.children[n],(function(l){a.push(l);var u=n;o.whilst((function(){return u<r.numberActives&&0===e.rangeComparator(r.keys[u].key,i)}),(function(t){s.push(r.keys[u].key),u++,e._diskRead(r.children[u],(function(e){a.push(e),t()}))}),(function(){t()}))}))}),(function(){n(s)}))},t.exports={QuadIndex:QuadIndex,Pattern:Pattern,NodeKey:NodeKey}},{"./btree":123,"./utils":140}],133:[function(e,t,r){var n=e("./abstract_query_tree").AbstractQueryTree,i=e("./abstract_query_tree").NonSupportedSparqlFeatureError,o=e("./utils"),s=e("./quad_index"),a=e("./query_plan").QueryPlan,l=e("./query_filters").QueryFilters,u=e("./rdf_model"),c=e("./rdf_loader").RDFLoader,f=e("./graph_callbacks").CallbacksBackend,p=e("./utils"),d=e("./utils");function h(e,t,r){this.name="BindExpressionError",this.bind=t,this.error=r,this.message=e}h.prototype=new Error,h.constructor=h,QueryEngine=function(e){0!=arguments.length&&(this.backend=e.backend,this.lexicon=e.lexicon,this.eventsOnBatchLoad=e.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new n,this.rdfLoader=new c(e.communication),this.callbacksBackend=new f(this),this.customFns=e.customFns||{})},QueryEngine.prototype.setCustomFunctions=function(e){this.customFns=e},QueryEngine.prototype.registerNsInEnvironment=function(e,t){var r=[];null!=e&&null!=e.prefixes&&(r=e.prefixes);var n={};for(var i in this.defaultPrefixes)n[i]=this.defaultPrefixes[i];for(var o=0;o<r.length;o++){var s=r[o];"prefix"===s.token&&(n[s.prefix]=s.local)}t.namespaces=n,null!=e&&e.base&&"object"==typeof e.base?t.base=e.base.value:t.base=null},QueryEngine.prototype.applyModifier=function(e,t){if("DISTINCT"==e){for(var r={},n=[],i=0;i<t.length;i++){var o=t[i],s="";for(var a in o){var l=o[a];null==l?s=s+a+"null":"literal"==l.token?(null!=l.value&&(s+=l.value),null!=l.lang&&(s+=l.lang),null!=l.type&&(s+=l.type)):s=l.value?s+a+l.value:s+a+l}null==r[s]&&(n.push(o),r[s]=!0)}return n}return t},QueryEngine.prototype.applyLimitOffset=function(e,t,r){return null==t&&null==e?r:(null==e&&(e=0),t=null==t?r.length:e+t,r.slice(e,t))},QueryEngine.prototype.applySingleOrderBy=function(e,t,r,n,i){var o=[],s=this;p.eachSeries(e,(function(e,i){l.collect(e.expression,[t],r,n,s,(function(e){o.push(e[0].value),i()}))}),(function(){i({binding:t,value:o})}))},QueryEngine.prototype.applyOrderBy=function(e,t,r,n,i){var o=this,s=[];null!=e&&e.length>0?p.eachSeries(t,(function(t,i){o.applySingleOrderBy(e,t,r,n,(function(e){s.push(e),i()}))}),(function(){s.sort((function(t,r){return o.compareFilteredBindings(t,r,e,n)}));for(var t=[],r=0;r<s.length;r++)t.push(s[r].binding);i(t)})):i(t)},QueryEngine.prototype.compareFilteredBindings=function(e,t,r,n){for(var i=0;;){if(i==e.value.length)return 0;var o,s=r[i].direction;if(null!=e.value[i]||null!=t.value[i]){if(null==e.value[i])o={value:!1};else if(null==t.value[i])o={value:!0};else{if("blank"===e.value[i].token&&"blank"===t.value[i].token){i++;continue}if("blank"===e.value[i].token)o={value:!1};else if("blank"===t.value[i].token)o={value:!0};else if("uri"===e.value[i].token&&"uri"===t.value[i].token){if(1==l.runEqualityFunction(e.value[i],t.value[i],[],this,n).value){i++;continue}o=l.runTotalGtFunction(e.value[i],t.value[i],[])}else if("uri"===e.value[i].token)o={value:!1};else if("uri"===t.value[i].token)o={value:!0};else if("literal"===e.value[i].token&&"literal"===t.value[i].token&&null==e.value[i].type&&null==t.value[i].type){if(1==l.runEqualityFunction(e.value[i],t.value[i],[],this,n).value){i++;continue}o=l.runTotalGtFunction(e.value[i],t.value[i],[])}else if("literal"===e.value[i].token&&null==e.value[i].type)o={value:!1};else if("literal"===t.value[i].token&&null==t.value[i].type)o={value:!0};else{if(1==l.runEqualityFunction(e.value[i],t.value[i],[],this,n).value){i++;continue}o=l.runTotalGtFunction(e.value[i],t.value[i],[])}}return 1==o.value?"ASC"===s?1:-1:"ASC"===s?-1:1}i++}},QueryEngine.prototype.removeDefaultGraphBindings=function(e,t){for(var r=[],n={},i=0;i<t.named.length;i++)n[t.named[i].oid]=!0;for(i=0;i<t.implicit.length;i++)null==n[t.implicit[i].oid]&&r.push(t.implicit[i].oid);var o=[];for(i=0;i<e.length;i++){var s=e[i],a=!1;for(var l in s){for(var u=0;u<n.length;u++)if(s[l]===n[u]){a=!0;break}if(a)break}a||o.push(s)}return o},QueryEngine.prototype.aggregateBindings=function(e,t,r,n,i){this.copyDenormalizedBindings(t,n.outCache,(function(t){for(var o={},s=0;s<e.length;s++){var a=l.runAggregator(e[s],t,this,r,n);e[s].alias?o[e[s].alias.value]=a:o[e[s].value.value]=a}i(o)}))},QueryEngine.prototype.projectBindings=function(e,t,r){if("*"===e[0].kind)return t;for(var n=[],i=0;i<t.length;i++){for(var o=t[i],s={},a=!0,u=0;u<e.length;u++)if("variable"==e[u].token&&"aliased"!=e[u].kind)s[e[u].value.value]=o[e[u].value.value];else if("variable"==e[u].token&&"aliased"==e[u].kind){var c=l.runFilter(e[u].expression,o,this,r,{blanks:{},outCache:{}});if(l.isEbvError(c)){a=!1;break}s[e[u].alias.value]=c}!0===a&&n.push(s)}return n},QueryEngine.prototype.resolveNsInEnvironment=function(e,t){return t.namespaces[e]},QueryEngine.prototype.normalizeTerm=function(e,t,r,n){if("uri"===e.token){var i=o.lexicalFormBaseUri(e,t);null==i?n(null):r?this.lexicon.registerUri(i,n):this.lexicon.resolveUri(i,n)}else if("literal"===e.token){var s=o.lexicalFormLiteral(e,t);r?this.lexicon.registerLiteral(s,n):this.lexicon.resolveLiteral(s,n)}else if("blank"===e.token){var a=e.value,l=t.blanks[a];null!=l?n(l):r?this.lexicon.registerBlank((function(e){t.blanks[a]=e,n(e)})):this.lexicon.resolveBlank((function(e){t.blanks[a]=e,n(e)}))}else"var"===e.token?n(e.value):n(null)},QueryEngine.prototype.normalizeDatasets=function(e,t,r){var n=this;p.eachSeries(e,(function(e,r){e.value===n.lexicon.defaultGraphUri?(e.oid=n.lexicon.defaultGraphOid,r()):n.normalizeTerm(e,t,!1,(function(t){null!=t&&(e.oid=t),r()}))}),(function(){r(!0)}))},QueryEngine.prototype.normalizeQuad=function(e,t,r,n){var i=null,s=null,a=null,l=null,u=this,c=!1;p.seq((function(n){if(null==e.graph||e.graph.value===u.lexicon.defaultGraphUri)l=0,n();else{var i=o.lexicalFormBaseUri(e.graph,t);u.normalizeTerm(e.graph,t,r,(function(t){null!=t?(l=t,!0===r&&"var"!=e.graph.token?u.lexicon.registerGraph(t,i,(function(){n()})):n()):(c=!0,n())}))}}),(function(n){!1===c?u.normalizeTerm(e.subject,t,r,(function(e){null!=e?(i=e,n()):(c=!0,n())})):n()}),(function(n){!1===c?u.normalizeTerm(e.predicate,t,r,(function(e){null!=e?(s=e,n()):(c=!0,n())})):n()}),(function(n){!1===c?u.normalizeTerm(e.object,t,r,(function(e){null!=e?(a=e,n()):(c=!0,n())})):n()}))((function(){n(!0===c?null:{subject:i,predicate:s,object:a,graph:l})}))},QueryEngine.prototype.denormalizeBindingsList=function(e,t,r){var n=this,i=[];p.eachSeries(e,(function(e,r){n.denormalizeBindings(e,t,(function(e){i.push(e),r()}))}),(function(){r(i)}))},QueryEngine.prototype.copyDenormalizedBindings=function(e,t,r){var n=this,i=[];p.eachSeries(e,(function(e,r){var o={},s=d.keys(e);p.eachSeries(s,(function(r,i){var s=e[r];if(null==s)o[r]=null,i();else if("object"==typeof s)o[r]=s,i();else{var a=t[s];null!=a?(o[r]=a,i()):n.lexicon.retrieve(s,(function(e){t[s]=e,o[r]=e,i()}))}}),(function(){i.push(o),r()}))}),(function(){r(i)}))},QueryEngine.prototype.denormalizeBindings=function(e,t,r){var n=d.keys(e),i=t.outCache,o=this;p.eachSeries(n,(function(r,n){var s=e[r];null==s?(e[r]=null,n()):"object"==typeof s?n():null!=i[s]?(e[r]=i[s],n()):o.lexicon.retrieve(s,(function(i){e[r]=i,"blank"===i.token&&(t.blanks[i.value]=s),n()}))}),(function(){r(e)}))},QueryEngine.prototype.execute=function(e,t,r,n){e=o.normalizeUnicodeLiterals(e);var i=this.abstractQueryTree.parseQueryString(e);if(null==i)t(!1,"Error parsing query string");else if("query"===i.token&&"update"==i.kind){this.callbacksBackend.startGraphModification();var s=this;this.executeUpdate(i,(function(e,r){s.lexicon.updateAfterWrite&&s.lexicon.updateAfterWrite(),e?(s.callbacksBackend.cancelGraphModification(),t(e,r)):s.callbacksBackend.endGraphModification((function(){t(e,r)}))}))}else"query"===i.token&&"query"==i.kind&&this.executeQuery(i,t,r,n)},QueryEngine.prototype.executeQuery=function(e,t,r,n){var i=e.prologue,o=e.units,s=this,a={blanks:{},outCache:{}};this.registerNsInEnvironment(i,a);var l=s.abstractQueryTree.parseExecutableUnit(o[0]);"select"===l.kind?this.executeSelect(l,a,r,n,(function(e,r){null==e?"object"==typeof r&&!0===r.denorm?t(null,r.bindings):s.denormalizeBindingsList(r,a,(function(e){t(null,e)})):t(e)})):"ask"===l.kind?(l.projection=[{token:"variable",kind:"*"}],this.executeSelect(l,a,r,n,(function(e,r){null==e?r.length>0?t(null,!0):t(null,!1):t(e)}))):"construct"===l.kind&&(l.projection=[{token:"variable",kind:"*"}],s=this,this.executeSelect(l,a,r,n,(function(e,r){null==e?s.denormalizeBindingsList(r,a,(function(e){if(null!=e){var r=new u.Graph;null==l.template&&(l.template={triplesContext:l.pattern});for(var n=1,i=[],o=0;o<e.length;o++){for(var c=e[o],f=0;f<i.length;f++)delete i[f].valuetmp;for(f=0;f<l.template.triplesContext.length;f++){for(var p=["subject","predicate","object"],d=l.template.triplesContext[f],h=0;h<p.length;h++){var y=p[h];if("blank"===d[y].token)if(d[y].valuetmp&&null!=d[y].valuetmp);else{var v="_:b"+n;n++,d[y].valuetmp=v,i.push(d[y])}}var g=u.buildRDFResource(d.subject,c,s,a),b=(h=u.buildRDFResource(d.predicate,c,s,a),u.buildRDFResource(d.object,c,s,a));if(null!=g&&null!=h&&null!=b){var m=new u.Triple(g,h,b);r.add(m)}}}t(null,r)}else t(new Error("Error denormalizing bindings."))})):t(e)})))},QueryEngine.prototype.executeSelect=function(e,t,r,n,i){if("select"===e.kind||"ask"===e.kind||"construct"===e.kind||"modify"===e.kind){var o=e.projection,s=e.dataset,a=e.modifier,l=e.limit,u=e.offset,c=e.order,f=this;null==r&&null==n||(s.implicit=r||[],s.named=n||[]),null!=s.implicit&&0===s.implicit.length&&null!=s.named&&0===s.named.length&&s.implicit.push(this.lexicon.defaultGraphUriTerm),f.normalizeDatasets(s.implicit.concat(s.named),t,(function(){try{f.executeSelectUnit(o,s,e.pattern,t,(function(r){if(null!=r){if(null!=e.group&&""===e.group){for(var n=!1,d=0;d<e.projection.length;d++)if(null!=e.projection[d].expression&&"aggregate"===e.projection[d].expression.expressionType){n=!0;break}!0===n&&(e.group="singleGroup")}e.group&&""!=e.group?f.checkGroupSemantics(e.group,o)?f.groupSolution(r,e.group,s,t,(function(e){var r=[];p.eachSeries(e,(function(e,n){f.aggregateBindings(o,e,s,t,(function(e){r.push(e),n()}))}),(function(){i(null,{bindings:r,denorm:!0})}))})):i(new Error("Incompatible Group and Projection variables")):f.applyOrderBy(c,r,s,t,(function(e){var t=f.projectBindings(o,e,s),r=f.applyModifier(a,t),n=f.applyLimitOffset(u,l,r),c=f.removeDefaultGraphBindings(n,s);i(null,c)}))}else i(new Error("Error executing SELECT query."))}))}catch(e){i(e)}}))}else i(new Error("Cannot execute "+e.kind+" query as a select query"))},QueryEngine.prototype.groupSolution=function(e,t,r,n,i){var o=[],s=[],a=!1,u=this;"singleGroup"===t?i([e]):p.eachSeries(e,(function(e,i){var c=!0;p.eachSeries(t,(function(t,i){var s=null;if("var"===t.token)s=t.value,0==a&&o.push(s),i();else if("aliased_expression"===t.token){if(s=t.alias.value,0==a&&o.push(s),"var"===t.expression.primaryexpression)e[t.alias.value]=e[t.expression.value.value];else{var f=u.copyDenormalizedBindings([e],n.outCache),p=l.runFilter(t.expression,f[0],u,r,n);l.isEbvError(p)?c=!1:(null!=p.value&&(p.value=""+p.value),e[t.alias.value]=p)}i()}else u.copyDenormalizedBindings([e],n.outCache,(function(r){var f=l.runFilter(t,r[0],u,n);l.isEbvError(f)?c=!1:(e["groupCondition"+env._i]=f,s="groupCondition"+env._i,0==a&&o.push(s)),i()}))}),(function(){0==a&&(a=!0),!0===c&&s.push(e),i()}))}),(function(){for(var e={},t={},r=0;r<s.length;r++){for(var n=s[r],a="",l=0;l<o.length;l++){var u=n[o[l]];a+="object"==typeof u?u.value:u}null==e[a]?(t[a]=0,e[a]=[n]):e[a].push(n)}var c=[];for(var f in e)c.push(e[f]);i(c)}))},QueryEngine.prototype.executeSelectUnit=function(e,t,r,n,o){if("BGP"===r.kind)this.executeAndBGP(e,t,r,n,o);else if("UNION"===r.kind)this.executeUNION(e,t,r.value,n,o);else if("JOIN"===r.kind)this.executeJOIN(e,t,r,n,o);else if("LEFT_JOIN"===r.kind)this.executeLEFT_JOIN(e,t,r,n,o);else if("FILTER"===r.kind){var s=this;this.executeSelectUnit(e,t,r.value,n,(function(e){null!=e?l.checkFilters(r,e,!1,t,n,s,o):o([])}))}else{if("EMPTY_PATTERN"!==r.kind)throw new i(r.kind);o([])}},QueryEngine.prototype.executeUNION=function(e,t,r,n,i){var o,s,u=r[0],c=r[1],f=null;if(2!=r.length)throw"SPARQL algebra UNION with more than two components";var d=this;p.seq((function(r){try{d.executeSelectUnit(e,t,u,n,(function(e){o=e,r()}))}catch(e){f=e,r()}}),(function(r){if(null==f)try{d.executeSelectUnit(e,t,c,n,(function(e){s=e,r()}))}catch(e){f=e,r()}else r()}))((function(){if(null!=f)i(f);else{var e=a.unionBindings(o,s);d.runBinds(r.binds,e,t,n,(function(e,o){if(null!=e)throw new h("Error processing bind expressions",r.binds,e);l.checkFilters(r,o,!1,t,n,d,i)}))}}))},QueryEngine.prototype.executeAndBGP=function(e,t,r,n,i){var o=this;a.executeAndBGPsDPSize(r.value,t,this,n,(function(e){null!=e?o.runBinds(r.binds,e,t,n,(function(e,s){if(null!=e)throw new h("Error processing bind expressions",r.binds,e);l.checkFilters(r,s,!1,t,n,o,i)})):i(null)}))},QueryEngine.prototype.executeLEFT_JOIN=function(e,t,r,n,i){var o=r.lvalue,s=r.rvalue;if("EMPTY_PATTERN"===o.kind)this.executeSelectUnit(e,t,s,n,i);else{var u,c,f=null,d=null,y=null,v=this;p.seq((function(r){try{v.executeSelectUnit(e,t,o,n,(function(e){f=e,r()}))}catch(e){y=e,r()}}),(function(r){if(null!=y)r();else try{v.executeSelectUnit(e,t,s,n,(function(e){d=e,r()}))}catch(e){y=e,r()}}))((function(){if(null!=y)i(y);else{var e=a.leftOuterJoinBindings(f,d);v.runBinds(r.binds,e,t,n,(function(o,s){if(null!=o)throw new h("Error processing bind expressions",r.binds,o);l.checkFilters(r,e,!0,t,n,v,(function(e){if(f.length>1&&d.length>1){var t=[],r={};for(var n in f[0])r[n]=!0;for(n in d[0])1!=r[n]&&t.push(n);u=[],c={};for(var o=0;o<e.length;o++)if(!0===e[o].__nullify__){for(var s=0;s<t.length;s++)e[o].bindings[t[s]]=null;var a=[],l=[];for(var n in e[o].bindings)null!=e[o].bindings[n]&&(a.push(n+e[o].bindings[n]),a.sort(),l.push(a.join("")));if(null==c[a.join("")]){for(s=0;s<l.length;s++)c[l[s]]=!0;u.push(e[o].bindings)}}else{u.push(e[o]);a=[],l=[];for(var n in e[o])a.push(n+e[o][n]),a.sort(),c[a.join("")]=!0}i(u)}else i(e)}))}))}}))}},QueryEngine.prototype.executeJOIN=function(e,t,r,n,i){var o=r.lvalue,s=r.rvalue,u=null,c=null,f=null,d=this;p.seq((function(r){try{d.executeSelectUnit(e,t,o,n,(function(e){u=e,r()}))}catch(e){f=e,r()}}),(function(r){if(null!=f)r();else try{d.executeSelectUnit(e,t,s,n,(function(e){c=e,r()}))}catch(e){f=e,r()}}))((function(){var e=null;if(null!=f)i(f);else if(0===u.length||0===c.length)i([]);else{var p={},y=[];for(var v in u[0])p[v]=!1;for(var v in c[0])!1===p[v]&&y.push(v);e=0==y.length||d.abstractQueryTree.treeWithUnion(o)||d.abstractQueryTree.treeWithUnion(s)?a.joinBindings(u,c):a.joinBindings2(y,u,c),d.runBinds(r.binds,e,t,n,(function(e,o){if(null!=e)throw new h("Error processing bind expressions",r.binds,e);l.checkFilters(r,o,!1,t,n,d,i)}))}}))},QueryEngine.prototype.rangeQuery=function(e,t,r){var n=this;n.normalizeQuad(e,t,!1,(function(e){null!=e?n.backend.range(new s.Pattern(e),(function(e){null==e||0==e.length?r([]):r(e)})):r(null)}))},QueryEngine.prototype.executeUpdate=function(e,t){var r=e.prologue,n=e.units,i=this,s={blanks:{},outCache:{}};this.registerNsInEnvironment(r,s);for(var a=0;a<n.length;a++){var l=i.abstractQueryTree.parseExecutableUnit(n[a]);if("insertdata"===l.kind){var u=null;p.eachSeries(l.quads,(function(e,t){null===u?i._executeQuadInsert(e,s,(function(e){null!=e&&(u=e),t()})):t()}),(function(){null===u?t(null,!0):t(u)}))}else if("deletedata"===l.kind){u=null;p.eachSeries(l.quads,(function(e,t){null===u?i._executeQuadDelete(e,s,(function(e){null!=e&&(u=e),t()})):t()}),(function(){null===u?t(null,!0):t(u)}))}else if("modify"===l.kind)this._executeModifyQuery(l,s,t);else if("create"===l.kind)t(!0);else if("load"===l.kind){var c={uri:o.lexicalFormBaseUri(l.sourceGraph,s)};null!=l.destinyGraph&&(c={uri:o.lexicalFormBaseUri(l.destinyGraph,s)});i=this;this.rdfLoader.load(l.sourceGraph.value,c,(function(e,r){e?t(new Error("error batch loading quads")):i.batchLoad(r,(function(e){null!==e?t(null,e):t(new Error("Error batch loading quads"))}))}))}else if("drop"===l.kind)this._executeClearGraph(l.destinyGraph,s,t);else{if("clear"!==l.kind)throw new Error("not supported execution unit");this._executeClearGraph(l.destinyGraph,s,t)}}},QueryEngine.prototype.batchLoad=function(e,t){var r=0,n={},i=this;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();p.eachSeries(e,(function(e,t){var o={};p.eachSeries(["subject","predicate","object","graph"],(function(t,r){!function(e,t,r,o){var s;if(e[t].uri||"uri"===e[t].token){var a=e[t].uri||e[t].value;i.lexicon.registerUri(a,(function(n){var s=function(){null!=e[t].uri&&(e[t]={token:"uri",value:e[t].uri},delete e[t].uri),r[t]=n,o()};"graph"===t?i.lexicon.registerGraph(n,a,(function(){s()})):s()}))}else e[t].literal||"literal"===e[t].token?i.lexicon.registerLiteral(e[t].literal||e[t].value,(function(n){null!=e[t].literal&&(e[t]=i.lexicon.parseLiteral(e[t].literal),delete e[t].literal),r[t]=n,o()})):null==(s=n[e[t].blank||e[t].value])?i.lexicon.registerBlank((function(i){n[e[t].blank||e[t].value]=i,null==e[t].token&&(e[t].token="blank",e[t].value=e[t].blank,delete e[t].blank),r[t]=i,o()})):(null==e[t].token&&(e[t].token="blank",e[t].value=e[t].blank,delete e[t].blank),r[t]=s,o())}(e,t,o,r)}),(function(){var n=e;e=o;var a=new s.NodeKey(e);i.backend.search(a,(function(o){o?t():i.backend.index(a,(function(o){o&&(i.eventsOnBatchLoad&&i.callbacksBackend.nextGraphModification(f.added,[n,e]),r+=1),t()}))}))}))}),(function(){null!=i.lexicon.updateAfterWrite&&i.lexicon.updateAfterWrite();var e=function(){t(r)};i.eventsOnBatchLoad?i.callbacksBackend.endGraphModification(e()):e()}))},QueryEngine.prototype._executeModifyQuery=function(e,t,r){var n=this,i=!0,o=new Error("Error executing modify query"),s=null,a=["subject","predicate","object","graph"];e.insert=null==e.insert?[]:e.insert,e.delete=null==e.delete?[]:e.delete,p.seq((function(r){var a=[],l=[];if(null!=e.with&&a.push(e.with),null!=e.using){l=[];for(var u=0;u<e.using.length;u++){var c=e.using[u];"named"===c.kind?l.push(c.uri):a.push(c.uri)}}e.dataset={},e.projection=[{token:"variable",kind:"*"}],n.executeSelect(e,t,a,l,(function(e,a){if(e)return o=e,i=!1,r();n.denormalizeBindingsList(a,t,(function(e){null!=e?s=e:(o=new Error("Error denormalizing bindings list"),i=!1),r()}))}))}),(function(r){var o=e.with;if(i){for(var l=[],u=0;u<e.delete.length;u++)for(var c=e.delete[u],f=0;f<s.length;f++){for(var d={},h=s[f],y=0;y<a.length;y++){var v=a[y];"graph"==v&&null==c[v]?d.graph=o:"var"===c[v].token?d[v]=h[c[v].value]:d[v]=c[v]}l.push(d)}p.eachSeries(l,(function(e,r){n._executeQuadDelete(e,t,(function(){r()}))}),(function(){r()}))}else r()}),(function(r){var o=e.with;if(i){for(var l=[],u=0;u<e.insert.length;u++)for(var c=e.insert[u],f=0;f<s.length;f++){for(var d={},h=s[f],y=0;y<a.length;y++){var v=a[y];"graph"==v&&null==c[v]?d.graph=o:"var"===c[v].token?d[v]=h[c[v].value]:d[v]=c[v]}l.push(d)}p.eachSeries(l,(function(e,r){n._executeQuadInsert(e,t,(function(){r()}))}),(function(){r()}))}else r()}))((function(){r(i?null:o)}))},QueryEngine.prototype._executeQuadInsert=function(e,t,r){var n,i=this,o=!1,a=null;p.seq((function(r){i.normalizeQuad(e,t,!0,(function(e){null!=e?n=e:(o=!0,a="Error normalizing quad."),r()}))}),(function(t){if(!1===o){var r=new s.NodeKey(n);i.backend.search(r,(function(o){!0===o?t():i.backend.index(r,(function(){i.callbacksBackend.nextGraphModification(f.added,[e,n]),t()}))}))}else t()}))((function(){o?r(new Error(a)):r(null,!0)}))},QueryEngine.prototype._executeQuadDelete=function(e,t,r){var n,i,o,a=this,l=!1;p.seq((function(r){a.normalizeQuad(e,t,!0,(function(e){null!=e?n=e:(l=!0,i="Error normalizing quad."),r()}))}),(function(e){!1===l?(o=new s.NodeKey(n),a.backend.delete(o,(function(){e()}))):e()}),(function(t){!1===l?a.lexicon.unregister(e,o,(function(){a.callbacksBackend.nextGraphModification(f.deleted,[e,n]),t()})):t()}))((function(){l?r(new Error(i)):r(null,!0)}))},QueryEngine.prototype._executeClearGraph=function(e,t,r){var n=this;if("default"===e)this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",r);else if("named"===e)n.lexicon.registeredGraphs(!0,(function(e){if(null!=e){var t=!1;p.eachSeries(e,(function(e,r){t?r():n.execute("DELETE { GRAPH <"+e+"> { ?s ?p ?o } } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",(function(i,o){i?(t=i,r()):n.lexicon.resolveUri(e,(function(i){-1!=i?n.lexicon.knownGraphs.delete(i,(function(){r()})):(t="Cannot find graph "+e+" to clear it",r())}))}))}),(function(){r(!t)}))}else r(!1,"Error deleting named graphs")}));else if("all"===e){n=this;this.execute("CLEAR DEFAULT",(function(e,t){e?r(!1,t):n.execute("CLEAR NAMED",r)}))}else if("uri"==e.token){var i=o.lexicalFormBaseUri(e,t);null!=i?(this.callbacksBackend.ongoingModification=!0,this.execute("DELETE { GRAPH <"+i+"> { ?s ?p ?o } } WHERE { GRAPH <"+i+"> { ?s ?p ?o } }",(function(e){n.callbacksBackend.ongoingModification=!1,r(e)}))):r(!1,"wrong graph URI")}else r(!1,"wrong graph URI")},QueryEngine.prototype.checkGroupSemantics=function(e,t){if("singleGroup"===e)return!0;for(var r={},n=0;n<e.length;n++){var i=e[n];"var"===i.token?r[i.value]=!0:"aliased_expression"===i.token&&(r[i.alias.value]=!0)}for(n=0;n<t.length;n++){var o=t[n];if("var"===o.kind){if(null==r[o.value.value])return!1}else if("aliased"===o.kind&&o.expression&&"var"===o.expression.primaryexpression&&null==r[o.expression.value.value])return!1}return!0},QueryEngine.prototype.runBinds=function(e,t,r,n,i){var o=this,s=t;null!=e&&e.length>0?o.copyDenormalizedBindings(t,n.outCache,(function(a){for(var u=0;u<t.length;u++)for(var c=0;c<e.length;c++){var f=e[c],p=a[u],d=l.runFilter(f.expression,p,o,r,n);l.isEbvError(d)?i(d):s[u][f.as.value]=d}i(null,t)})):i(null,t)},QueryEngine.prototype.computeCosts=function(e,t,r){for(var n=0;n<e.length;n++)e[n]._cost=this.quadCost(e[n],t);r(e)},QueryEngine.prototype.quadCost=function(e,t){return 1},QueryEngine.prototype.registerDefaultNamespace=function(e,t){this.defaultPrefixes[e]=t},t.exports={QueryEngine:QueryEngine}},{"./abstract_query_tree":122,"./graph_callbacks":124,"./quad_index":132,"./query_filters":134,"./query_plan":135,"./rdf_loader":136,"./rdf_model":137,"./utils":140}],134:[function(e,t,r){var n=e("./utils"),i=n,o=e("./utils");QueryFilters={};var s="http://www.w3.org/2001/XMLSchema#";QueryFilters.checkFilters=function(e,t,r,n,i,s,a){var l=[];e.filter&&"function"!=typeof e.filter&&(l=e.filter);var u=[];if(null==l||0===l.length||null!=e.length)return a(t);QueryFilters.preprocessExistentialFilters(l,t,s,n,i,(function(e){o.eachSeries(e,(function(e,o){QueryFilters.run(e.value,t,r,n,i,s,(function(e){for(var r=[],n=0;n<e.length;n++){var i=e[n];null!=i.__nullify__?u.push(i):r.push(i)}t=r,o()}))}),(function(){a(t.concat(u))}))}))},QueryFilters.preprocessExistentialFilters=function(e,t,r,n,s,a){var l=[];o.eachSeries(e,(function(e,a){if("builtincall"!==e.value.expressionType||"exists"!==e.value.builtincall&&"notexists"!==e.value.builtincall)if("conditionalor"===e.value.expressionType||"conditionaland"===e.value.expressionType){var u=i.map(e.value.operands,(function(e){return{value:e}}));QueryFilters.preprocessExistentialFilters(u,t,r,n,s,(function(t){e.value.operands=t.map((function(e){return e.value})),l.push(e),a()}))}else if("multiplicativeexpression"===e.value.expressionType){u=i.map(e.value.factors,(function(e){return{value:e}}));QueryFilters.preprocessExistentialFilters(u,t,r,n,s,(function(t){e.value.factors=t.map((function(e){return e.value})),l.push(e),a()}))}else if("additiveexpression"===e.value.expressionType){u=i.map(e.value.summands,(function(e){return{value:e}}));QueryFilters.preprocessExistentialFilters(u,t,r,n,s,(function(t){e.value.summands=t.map((function(e){return e.value})),l.push(e),a()}))}else if("relationalexpression"===e.value.expressionType){u=[{value:e.value.op1},{value:e.value.op2}];QueryFilters.preprocessExistentialFilters(u,t,r,n,s,(function(t){e.value.op1=t[0].value,e.value.op2=t[1].value,l.push(e),a()}))}else if("irireforfunction"===e.value.expressionType||"custom"===e.value.expressionType)if(null!=e.value.args){u=i.map(e.value.args,(function(e){return{value:e}}));QueryFilters.preprocessExistentialFilters(u,t,r,n,s,(function(t){e.value.args=t.map((function(e){return e.value})),l.push(e),a()}))}else l.push(e),a();else l.push(e),a();else{var c=e.value.builtincall,f=e.value.args,p={};r.copyDenormalizedBindings(t,s.outCache,(function(t){o.eachSeries(t,(function(e,t){var o=i.clone(f[0],!0),a=r.abstractQueryTree.parseSelect({pattern:o},e);a=r.abstractQueryTree.bind(a.pattern,e),r.executeSelectUnit([{kind:"*"}],n,a,s,(function(r){var n=null;n="exists"===c?QueryFilters.ebvBoolean(0!==r.length):QueryFilters.ebvBoolean(0===r.length);var i=[];for(var o in e)i.push(JSON.stringify(e[o]));i=i.sort().join(""),p[i]=n,t()}))}),(function(){e.value.origArgs=e.value.args,e.value.args=p,l.push(e),a()}))}))}}),(function(){a(l)}))},QueryFilters.boundVars=function(e){if(null==e.expressionType)throw"Cannot find bound expressions in a no expression token";var t=e.expressionType;if("relationalexpression"==t){var r=e.op1,n=e.op2;return QueryFilters.boundVars(r)+QueryFilters.boundVars(n)}if("conditionalor"==t||"conditionaland"==t){for(var i=[],o=0;o<e.operands;o++)i=i.concat(QueryFilters.boundVars(e.operands[o]));return i}if("builtincall"==t){if(null==e.args)return[];var s=[];for(o=0;o<e.args.length;o++)s=s.concat(QueryFilters.boundVars(e.args[o]));return s}if("multiplicativeexpression"==t){var s=QueryFilters.boundVars(e.factor);for(o=0;o<e.factors.length;o++)s=s.concat(QueryFilters.boundVars(e.factors[o].expression));return s}if("additiveexpression"==t){for(s=QueryFilters.boundVars(e.summand),o=0;o<e.summands.length;o++)s=s.concat(QueryFilters.boundVars(e.summands[o].expression));return s}return"regex"==t?(s=QueryFilters.boundVars(e.expression1)).concat(QueryFilters.boundVars(e.expression2)):"unaryexpression"==t?QueryFilters.boundVars(e.expression):"atomic"==t?"var"==e.primaryexpression?[e.value]:[]:void 0},QueryFilters.run=function(e,t,r,n,i,o,s){o.copyDenormalizedBindings(t,i.outCache,(function(a){for(var l=[],u=0;u<t.length;u++){var c=a[u],f=QueryFilters.runFilter(e,c,o,n,i);f=QueryFilters.ebv(f);if(QueryFilters.isEbvError(f)){if(r){var p={__nullify__:!0,bindings:t[u]};l.push(p)}}else if(!0===f)l.push(t[u]);else if(r){p={__nullify__:!0,bindings:t[u]};l.push(p)}}s(l)}))},QueryFilters.collect=function(e,t,r,n,i,o){i.copyDenormalizedBindings(t,n.outCache,(function(s){for(var a=[],l=0;l<s.length;l++){var u=s[l],c=QueryFilters.runFilter(e,u,i,r,n);a.push({binding:t[l],value:c})}return o(a)}))},QueryFilters.runDistinct=function(e,t){},QueryFilters.runAggregator=function(e,t,r,i,o){if(null==t||0===t.length)return QueryFilters.ebvError();if("variable"===e.token&&"var"==e.kind)return t[0][e.value.value];if("variable"===e.token&&"aliased"===e.kind){if("atomic"===e.expression.expressionType&&"var"===e.expression.primaryexpression)return t[0][e.expression.value.value];if("aggregate"===e.expression.expressionType){if("max"===e.expression.aggregateType){for(var a=null,l=0;l<t.length;l++){var u=t[l],c=QueryFilters.runFilter(e.expression.expression,u,r,i,o);QueryFilters.isEbvError(c)||(null===a||!0===QueryFilters.runLtFunction(a,c).value)&&(a=c)}return null===a?QueryFilters.ebvError():a}if("min"===e.expression.aggregateType){var f=null;for(l=0;l<t.length;l++){u=t[l],c=QueryFilters.runFilter(e.expression.expression,u,r,i,o);QueryFilters.isEbvError(c)||(null===f||!0===QueryFilters.runGtFunction(f,c).value)&&(f=c)}return null===f?QueryFilters.ebvError():f}if("count"===e.expression.aggregateType){var p={},d=0;if("*"===e.expression.expression)if(null!=e.expression.distinct&&""!=e.expression.distinct)for(l=0;l<t.length;l++){u=t[l];null==p[v=n.hashTerm(u)]&&(p[v]=!0,d++)}else d=t.length;else for(l=0;l<t.length;l++){u=t[l],c=QueryFilters.runFilter(e.expression.expression,u,r,i,o);if(!QueryFilters.isEbvError(c))if(null!=e.expression.distinct&&""!=e.expression.distinct)null==p[v=n.hashTerm(c)]&&(p[v]=!0,d++);else d++}return{token:"literal",type:s+"integer",value:""+d}}if("avg"===e.expression.aggregateType){p={};var h={token:"literal",type:s+"integer",value:"0"};for(d=0,l=0;l<t.length;l++){u=t[l],c=QueryFilters.runFilter(e.expression.expression,u,r,i,o);if(!QueryFilters.isEbvError(c))if(null!=e.expression.distinct&&""!=e.expression.distinct)null==p[v=n.hashTerm(c)]&&(p[v]=!0,QueryFilters.isNumeric(c)&&(h=QueryFilters.runSumFunction(h,c),d++));else QueryFilters.isNumeric(c)&&(h=QueryFilters.runSumFunction(h,c),d++)}var y=QueryFilters.runDivFunction(h,{token:"literal",type:s+"integer",value:""+d});return y.value=""+y.value,y}if("sum"===e.expression.aggregateType){for(p={},h={token:"literal",type:s+"integer",value:"0"},l=0;l<t.length;l++){var v;u=t[l],c=QueryFilters.runFilter(e.expression.expression,u,r,i,o);if(!QueryFilters.isEbvError(c))if(null!=e.expression.distinct&&""!=e.expression.distinct)null==p[v=n.hashTerm(c)]&&(p[v]=!0,QueryFilters.isNumeric(c)&&(h=QueryFilters.runSumFunction(h,c)));else QueryFilters.isNumeric(c)&&(h=QueryFilters.runSumFunction(h,c))}return h.value=""+h.value,h}return c=QueryFilters.runFilter(aggregate.expression,t[0],i,{blanks:{},outCache:{}})}}},QueryFilters.runFilter=function(e,t,r,i,o){if(null!=e.expressionType){var s=e.expressionType;if("relationalexpression"==s){var a=QueryFilters.runFilter(e.op1,t,r,i,o),l=QueryFilters.runFilter(e.op2,t,r,i,o);return QueryFilters.runRelationalFilter(e,a,l,t,r,i,o)}if("conditionalor"==s)return QueryFilters.runOrFunction(e,t,r,i,o);if("conditionaland"==s)return QueryFilters.runAndFunction(e,t,r,i,o);if("additiveexpression"==s)return QueryFilters.runAddition(e.summand,e.summands,t,r,i,o);if("builtincall"==s)return QueryFilters.runBuiltInCall(e.builtincall,e.args,t,r,i,o);if("multiplicativeexpression"==s)return QueryFilters.runMultiplication(e.factor,e.factors,t,r,i,o);if("unaryexpression"==s)return QueryFilters.runUnaryExpression(e.unaryexpression,e.expression,t,r,i,o);if("irireforfunction"==s)return QueryFilters.runIriRefOrFunction(e.iriref,e.args,t,r,i,o);if("regex"==s)return QueryFilters.runRegex(e.text,e.pattern,e.flags,t,r,i,o);if("custom"==s)return QueryFilters.runBuiltInCall(e.name,e.args,t,r,i,o);if("atomic"==s)return"var"==e.primaryexpression?t[e.value.value]:("object"!=typeof e.value||null==e.value.type||"object"!=typeof e.value.type||(e.value.type=n.lexicalFormBaseUri(e.value.type,o)),e.value);throw"Unknown filter expression type"}throw"Cannot find bound expressions in a no expression token"},QueryFilters.isRDFTerm=function(e){return null!=e&&!!(e.token&&"literal"==e.token||e.token&&"uri"==e.token||e.token&&"blank"==e.token)},QueryFilters.RDFTermEquality=function(e,t,r,i){return"literal"===e.token&&"literal"===t.token?e.lang==t.lang&&e.type==t.type&&e.value==t.value||(null!=e.type&&null!=t.type||QueryFilters.isSimpleLiteral(e)&&null!=t.type||!(!QueryFilters.isSimpleLiteral(t)||null==e.type))&&QueryFilters.ebvError():"uri"===e.token&&"uri"===t.token?n.lexicalFormBaseUri(e,i)==n.lexicalFormBaseUri(t,i):"blank"===e.token&&"blank"===t.token&&e.value==t.value},QueryFilters.isInteger=function(e){return null!=e&&("literal"===e.token&&(e.type==s+"integer"||e.type==s+"decimal"||e.type==s+"double"||e.type==s+"nonPositiveInteger"||e.type==s+"negativeInteger"||e.type==s+"long"||e.type==s+"int"||e.type==s+"short"||e.type==s+"byte"||e.type==s+"nonNegativeInteger"||e.type==s+"unsignedLong"||e.type==s+"unsignedInt"||e.type==s+"unsignedShort"||e.type==s+"unsignedByte"||e.type==s+"positiveInteger"))},QueryFilters.isFloat=function(e){return null!=e&&("literal"===e.token&&e.type==s+"float")},QueryFilters.isDecimal=function(e){return null!=e&&("literal"===e.token&&e.type==s+"decimal")},QueryFilters.isDouble=function(e){return null!=e&&("literal"===e.token&&e.type==s+"double")},QueryFilters.isNumeric=function(e){return null!=e&&("literal"===e.token&&(e.type==s+"integer"||e.type==s+"decimal"||e.type==s+"float"||e.type==s+"double"||e.type==s+"nonPositiveInteger"||e.type==s+"negativeInteger"||e.type==s+"long"||e.type==s+"int"||e.type==s+"short"||e.type==s+"byte"||e.type==s+"nonNegativeInteger"||e.type==s+"unsignedLong"||e.type==s+"unsignedInt"||e.type==s+"unsignedShort"||e.type==s+"unsignedByte"||e.type==s+"positiveInteger"))},QueryFilters.isSimpleLiteral=function(e){return!(!e||"literal"!=e.token)&&(null==e.type&&null==e.lang)},QueryFilters.isXsdType=function(e,t){return!(!t||"literal"!=t.token)&&t.type==s+""+e},QueryFilters.ebv=function(e){if(null==e||QueryFilters.isEbvError(e))return QueryFilters.ebvError();if(e.token&&"literal"===e.token){if(e.type==s+"integer"||e.type==s+"decimal"||e.type==s+"double"||e.type==s+"nonPositiveInteger"||e.type==s+"negativeInteger"||e.type==s+"long"||e.type==s+"int"||e.type==s+"short"||e.type==s+"byte"||e.type==s+"nonNegativeInteger"||e.type==s+"unsignedLong"||e.type==s+"unsignedInt"||e.type==s+"unsignedShort"||e.type==s+"unsignedByte"||e.type==s+"positiveInteger"){var t=parseFloat(e.value);return!isNaN(t)&&0!=parseFloat(e.value)}return e.type===s+"boolean"?"true"===e.value||!0===e.value||"True"===e.value:e.type===s+"string"?""!=e.value:e.type===s+"dateTime"?null!=new Date(e.value):QueryFilters.isEbvError(e)?e:null==e.type?""!=e.value:QueryFilters.ebvError()}return!0===e.value},QueryFilters.effectiveBooleanValue=QueryFilters.ebv,QueryFilters.ebvTrue=function(){return{token:"literal",type:s+"boolean",value:!0}},QueryFilters.ebvFalse=function(){return{token:"literal",type:s+"boolean",value:!1}},QueryFilters.ebvError=function(){return{token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null}},QueryFilters.isEbvError=function(e){return"object"==typeof e&&null!=e&&"https://github.com/antoniogarrote/js-tools/types#error"===e.type},QueryFilters.ebvBoolean=function(e){return QueryFilters.isEbvError(e)?e:!0===e?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.runRelationalFilter=function(e,t,r,n,i,o,s){var a=e.operator;if("="===a)return QueryFilters.runEqualityFunction(t,r,n,i,o,s);if("!="===a){var l=QueryFilters.runEqualityFunction(t,r,n,i,o,s);return QueryFilters.isEbvError(l)||(l.value=!l.value),l}if("<"===a)return QueryFilters.runLtFunction(t,r,n);if(">"===a)return QueryFilters.runGtFunction(t,r,n);if("<="===a)return QueryFilters.runLtEqFunction(t,r,n);if(">="===a)return QueryFilters.runGtEqFunction(t,r,n);throw"Error applying relational filter, unknown operator"},QueryFilters.effectiveTypeValue=function(e){if("literal"!=e.token)throw console.log("not implemented yet"),console.log(e),"value not supported in operations yet";if(e.type==s+"integer")return parseInt(e.value);if(e.type==s+"decimal")return parseFloat(e.value);if(e.type==s+"float")return parseFloat(e.value);if(e.type==s+"double")return parseFloat(e.value);if(e.type==s+"nonPositiveInteger")return parseFloat(e.value);if(e.type==s+"negativeInteger")return parseInt(e.value);if(e.type==s+"long")return parseInt(e.value);if(e.type==s+"int")return parseInt(e.value);if(e.type==s+"short")return parseInt(e.value);if(e.type==s+"byte")return parseInt(e.value);if(e.type==s+"nonNegativeInteger")return parseInt(e.value);if(e.type==s+"unsignedLong")return parseInt(e.value);if(e.type==s+"unsignedInt")return parseInt(e.value);if(e.type==s+"unsignedShort")return parseInt(e.value);if(e.type==s+"unsignedByte")return parseInt(e.value);if(e.type==s+"positiveInteger")return parseInt(e.value);if(e.type!=s+"date"&&e.type!=s+"dateTime")return e.type==s+"boolean"?!0===e.value||"true"===e.value||"1"===e.value||1===e.value||!0===e.value||!1!==e.value&&"false"!==e.value&&"0"!==e.value&&0!==e.value&&!1!==e.value&&void 0:e.type==s+"string"?null===e.value||void 0===e.value?void 0:""+e.value:(e.type,e.value);try{return n.parseISO8601(e.value)}catch(e){return null}},QueryFilters.runOrFunction=function(e,t,r,n,i){for(var o=null,s=0;s<e.operands.length;s++){var a=QueryFilters.runFilter(e.operands[s],t,r,n,i);0==QueryFilters.isEbvError(a)&&(a=QueryFilters.ebv(a)),null==o?o=a:QueryFilters.isEbvError(a)?o=QueryFilters.isEbvError(o)?QueryFilters.ebvError():!0===o||QueryFilters.ebvError():!0===a?o=!0:QueryFilters.isEbvError(o)&&(o=QueryFilters.ebvError())}return QueryFilters.ebvBoolean(o)},QueryFilters.runAndFunction=function(e,t,r,n,i){for(var o=null,s=0;s<e.operands.length;s++){var a=QueryFilters.runFilter(e.operands[s],t,r,n,i);0==QueryFilters.isEbvError(a)&&(a=QueryFilters.ebv(a)),null==o?o=a:QueryFilters.isEbvError(a)?o=(QueryFilters.isEbvError(o)||!0===o)&&QueryFilters.ebvError():!0===a?QueryFilters.isEbvError(o)&&(o=QueryFilters.ebvError()):o=!1}return QueryFilters.ebvBoolean(o)},QueryFilters.runEqualityFunction=function(e,t,r,i,o,s){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)){var a=QueryFilters.effectiveTypeValue(e),l=QueryFilters.effectiveTypeValue(t);return isNaN(a)||isNaN(l)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(e,t,i,s)):QueryFilters.ebvBoolean(a==l)}if((QueryFilters.isSimpleLiteral(e)||QueryFilters.isXsdType("string",e))&&(QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",t)))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)==QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)==QueryFilters.effectiveTypeValue(t));if((QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))){if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var u=n.compareDateComponents(e.value,t.value);return null!=u?0==u?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.isRDFTerm(e)&&QueryFilters.isRDFTerm(t)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(e,t,i,s)):QueryFilters.ebvFalse()},QueryFilters.runGtFunction=function(e,t,r){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t));if(QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t));if((QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))){if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var i=n.compareDateComponents(e.value,t.value);return null!=i?1==i?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.ebvFalse()},QueryFilters.runTotalGtFunction=function(e,t){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isSimpleLiteral("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isSimpleLiteral("boolean",t)||QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isSimpleLiteral("dateTime",t)?QueryFilters.runGtFunction(e,t,[]):e.token&&"uri"===e.token&&t.token&&"uri"===t.token?QueryFilters.ebvBoolean(e.value>t.value):e.token&&"literal"===e.token&&t.token&&"literal"===t.token?QueryFilters.ebvBoolean(""+e.value+e.type+e.lang>""+t.value+t.type+t.lang):e.token&&"blank"===e.token&&t.token&&"blank"===t.token||e.value&&t.value?QueryFilters.ebvBoolean(e.value>t.value):QueryFilters.ebvTrue()},QueryFilters.runLtFunction=function(e,t,r){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t));if(QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t));if((QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))){if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var i=n.compareDateComponents(e.value,t.value);return null!=i?-1==i?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.ebvFalse()},QueryFilters.runGtEqFunction=function(e,t,r){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t));if((QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))){if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var i=n.compareDateComponents(e.value,t.value);return null!=i?-1!=i?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.ebvFalse()},QueryFilters.runLtEqFunction=function(e,t,r){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t));if((QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))){if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var i=n.compareDateComponents(e.value,t.value);return null!=i?1!=i?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.ebvFalse()},QueryFilters.runAddition=function(e,t,r,n,i,o){var s=QueryFilters.runFilter(e,r,n,i,o);if(QueryFilters.isEbvError(s))return QueryFilters.ebvError();var a=s;if(QueryFilters.isNumeric(s)){for(var l=0;l<t.length;l++){var u=QueryFilters.runFilter(t[l].expression,r,n,i,o);if(!QueryFilters.isNumeric(u))return QueryFilters.ebvFalse();"+"===t[l].operator?a=QueryFilters.runSumFunction(a,u):"-"===t[l].operator&&(a=QueryFilters.runSubFunction(a,u))}return a}return QueryFilters.ebvFalse()},QueryFilters.runSumFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)+QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:s+"double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:s+"float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:s+"decimal",value:r}:{token:"literal",type:s+"integer",value:r}},QueryFilters.runSubFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)-QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:s+"double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:s+"float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:s+"decimal",value:r}:{token:"literal",type:s+"integer",value:r}},QueryFilters.runMultiplication=function(e,t,r,n,i,o){var s=QueryFilters.runFilter(e,r,n,i,o);if(QueryFilters.isEbvError(s))return s;var a=s;if(QueryFilters.isNumeric(s)){for(var l=0;l<t.length;l++){var u=QueryFilters.runFilter(t[l].expression,r,n,i,o);if(QueryFilters.isEbvError(u))return s;if(!QueryFilters.isNumeric(u))return QueryFilters.ebvFalse();"*"===t[l].operator?a=QueryFilters.runMulFunction(a,u):"/"===t[l].operator&&(a=QueryFilters.runDivFunction(a,u))}return a}return QueryFilters.ebvFalse()},QueryFilters.runMulFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)*QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:s+"double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:s+"float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:s+"decimal",value:r}:{token:"literal",type:s+"integer",value:r}},QueryFilters.runDivFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)/QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:s+"double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:s+"float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:s+"decimal",value:r}:{token:"literal",type:s+"integer",value:r}},QueryFilters.runBuiltInCall=function(e,t,r,n,i,o){if("notexists"===e||"exists"===e){var s=[];for(var a in r)s.push(JSON.stringify(r[a]));return t[s=s.sort().join("")]}for(var l=[],u=0;u<t.length;u++)if("var"===t[u].token)l.push(t[u]);else{var c=QueryFilters.runFilter(t[u],r,n,i,o);if(QueryFilters.isEbvError(c))return c;l.push(c)}if("str"===e)return"literal"===l[0].token?{token:"literal",type:null,value:""+l[0].value}:"uri"===l[0].token?{token:"literal",type:null,value:l[0].value}:QueryFilters.ebvFalse();if("lang"===e)return"literal"===l[0].token?null!=l[0].lang?{token:"literal",value:""+l[0].lang}:{token:"literal",value:""}:QueryFilters.ebvError();if("datatype"===e){if("literal"===l[0].token){var f=l[0];return null!=f.type?"string"==typeof f.type?{token:"uri",value:f.type,prefix:null,suffix:null}:f.type:null==f.lang?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:QueryFilters.ebvError()}return QueryFilters.ebvError()}if("isliteral"===e)return"literal"===l[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isblank"===e)return"blank"===l[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isuri"===e||"isiri"===e)return"uri"===l[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("sameterm"===e){var p=l[0],d=l[1],h=QueryFilters.RDFTermEquality(p,d,n,o);return QueryFilters.isEbvError(h)&&(h=!1),QueryFilters.ebvBoolean(h)}if("langmatches"===e){var y=l[0],v=l[1];return"literal"===y.token&&"literal"===v.token?"*"===v.value&&""!=y.value?QueryFilters.ebvTrue():QueryFilters.ebvBoolean(0===y.value.toLowerCase().indexOf(v.value.toLowerCase())):QueryFilters.ebvError()}if("bound"===e){var g=l[0].value;return null==g?QueryFilters.ebvError():null!=r[g]?QueryFilters.ebvTrue():QueryFilters.ebvFalse()}if(null!=n.customFns[e])return n.customFns[e](QueryFilters,l);throw"Builtin call "+e+" not implemented yet"},QueryFilters.runUnaryExpression=function(e,t,r,n,i,o){var s=QueryFilters.runFilter(t,r,n,i,o);if(QueryFilters.isEbvError(s))return s;if("!"===e){var a=QueryFilters.ebv(s);return QueryFilters.isEbvError(a)?QueryFilters.ebvFalse():(a=!a,QueryFilters.ebvBoolean(a))}if("+"===e)return QueryFilters.isNumeric(s)?s:QueryFilters.ebvError();if("-"===e){if(QueryFilters.isNumeric(s)){var l={};for(var u in s)l[u]=s[u];return l.value=-l.value,l}return QueryFilters.ebvError()}},QueryFilters.runRegex=function(e,t,r,n,i,o,s){if(null==e)return QueryFilters.ebvError();if(e=QueryFilters.runFilter(e,n,i,o,s),null==t)return QueryFilters.ebvError();if(t=QueryFilters.runFilter(t,n,i,o,s),null!=r&&(r=QueryFilters.runFilter(r,n,i,o,s)),null==t||"literal"!==t.token||null!=r&&"literal"!==r.token)return QueryFilters.ebvError();if(t=t.value,r=null==r?null:r.value,null!=e&&"var"==e.token){if(null==n[e.value])return QueryFilters.ebvError();e=n[e.value]}else{if(null==e||"literal"!==e.token)return QueryFilters.ebvError();if(null!=e.type&&!QueryFilters.isXsdType("string",e))return QueryFilters.ebvError();e=e.value}return(null==r?new RegExp(t):new RegExp(t,r.toLowerCase())).exec(e)?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.normalizeLiteralDatatype=function(e,t,r){return null==e.value.type||"object"!=typeof e.value.type||(e.value.type=n.lexicalFormBaseUri(e.value.type,r)),e},QueryFilters.runIriRefOrFunction=function(e,t,r,i,o,a){if(null==t)return e;for(var l=[],u=0;u<t.length;u++)l.push(QueryFilters.runFilter(t[u],r,i,o,a));var c=n.lexicalFormBaseUri(e,a);if(c==s+"integer"||c==s+"decimal"||c==s+"double"||c==s+"nonPositiveInteger"||c==s+"negativeInteger"||c==s+"long"||c==s+"int"||c==s+"short"||c==s+"byte"||c==s+"nonNegativeInteger"||c==s+"unsignedLong"||c==s+"unsignedInt"||c==s+"unsignedShort"||c==s+"unsignedByte"||c==s+"positiveInteger"){if("literal"!==(f=l[0]).token)return QueryFilters.ebvError();if((f=QueryFilters.normalizeLiteralDatatype(f,i,a)).type==s+"integer"||f.type==s+"decimal"||f.type==s+"double"||f.type==s+"nonPositiveInteger"||f.type==s+"negativeInteger"||f.type==s+"long"||f.type==s+"int"||f.type==s+"short"||f.type==s+"byte"||f.type==s+"nonNegativeInteger"||f.type==s+"unsignedLong"||f.type==s+"unsignedInt"||f.type==s+"unsignedShort"||f.type==s+"unsignedByte"||f.type==s+"positiveInteger")return f.type=c,f;if("http://www.w3.org/2001/XMLSchema#boolean"==f.type)return 1==QueryFilters.ebv(f)?(f.type=c,f.value=1):(f.type=c,f.value=0),f;if("http://www.w3.org/2001/XMLSchema#float"==f.type||"http://www.w3.org/2001/XMLSchema#double"==f.type)return f.type=c,f.value=parseInt(f.value),f;if("http://www.w3.org/2001/XMLSchema#string"!=f.type&&null!=f.type)return QueryFilters.ebvError();if(f.value.split(".").length>2)return QueryFilters.ebvError();if(f.value.split("-").length>2)return QueryFilters.ebvError();if(f.value.split("/").length>2)return QueryFilters.ebvError();if(f.value.split("+").length>2)return QueryFilters.ebvError();if(c==s+"decimal"&&(-1!=f.value.indexOf("e")||-1!=f.value.indexOf("E")))return QueryFilters.ebvError();if(!(c!=s+"int"&&c!=s+"integer"||-1==f.value.indexOf("e")&&-1==f.value.indexOf("E")&&-1==f.value.indexOf(".")))return QueryFilters.ebvError();try{return f.value=parseInt(parseFloat(f.value)),isNaN(f.value)?QueryFilters.ebvError():(f.type=c,f)}catch(e){return QueryFilters.ebvError()}}else{if(c==s+"boolean")return"literal"===(f=l[0]).token&&null==f.type?"true"===f.value||"1"===f.value?QueryFilters.ebvTrue():"false"===f.value||"0"===f.value?QueryFilters.ebvFalse():QueryFilters.ebvError():"literal"===f.token?QueryFilters.isEbvError(f)?f:QueryFilters.ebvBoolean(f):QueryFilters.ebvError();if(c==s+"string")return"literal"===(f=l[0]).token?(f=QueryFilters.normalizeLiteralDatatype(f,i,a)).type==s+"integer"||f.type==s+"decimal"||f.type==s+"double"||f.type==s+"nonPositiveInteger"||f.type==s+"negativeInteger"||f.type==s+"long"||f.type==s+"int"||f.type==s+"short"||f.type==s+"byte"||f.type==s+"nonNegativeInteger"||f.type==s+"unsignedLong"||f.type==s+"unsignedInt"||f.type==s+"unsignedShort"||f.type==s+"unsignedByte"||f.type==s+"positiveInteger"||f.type==s+"float"?(f.type=c,f.value=""+f.value,f):f.type==s+"string"?f:f.type==s+"boolean"?(QueryFilters.ebv(f)?(f.type=c,f.value="true"):(f.type=c,f.value="false"),f):f.type==s+"dateTime"||f.type==s+"date"?(f.type=c,"string"!=typeof f.value&&(f.value=n.iso8601(f.value)),f):null==f.type?(f.value=""+f.value,f.type=c,f):QueryFilters.ebvError():"uri"===f.token?{token:"literal",value:n.lexicalFormBaseUri(f,a),type:c,lang:null}:QueryFilters.ebvError();if(c==s+"dateTime"||c==s+"date"){if((f=l[0]).type==s+"dateTime"||f.type==s+"date")return f;if(f.type!=s+"string"&&null!=f.type)return QueryFilters.ebvError();try{return f.value=n.iso8601(n.parseISO8601(f.value)),f.type=c,f}catch(e){return QueryFilters.ebvError()}}else{if(c!=s+"float")return null!=i.customFns[c]?i.customFns[c](QueryFilters,l):QueryFilters.ebvError();var f;if("literal"!==(f=l[0]).token)return QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#decimal"==(f=QueryFilters.normalizeLiteralDatatype(f,i,a)).type||"http://www.w3.org/2001/XMLSchema#int"==f.type)return f.type=c,f.value=parseFloat(f.value),f;if("http://www.w3.org/2001/XMLSchema#boolean"==f.type)return 1==QueryFilters.ebv(f)?(f.type=c,f.value=1):(f.type=c,f.value=0),f;if("http://www.w3.org/2001/XMLSchema#float"==f.type||"http://www.w3.org/2001/XMLSchema#double"==f.type)return f.type=c,f.value=parseFloat(f.value),f;if("http://www.w3.org/2001/XMLSchema#string"==f.type)try{return f.value=parseFloat(f.value),isNaN(f.value)?QueryFilters.ebvError():(f.type=c,f)}catch(e){return QueryFilters.ebvError()}else{if(null!=f.type)return QueryFilters.ebvError();if(f.value.split(".").length>2)return QueryFilters.ebvError();if(f.value.split("-").length>2)return QueryFilters.ebvError();if(f.value.split("/").length>2)return QueryFilters.ebvError();if(f.value.split("+").length>2)return QueryFilters.ebvError();try{return f.value=parseFloat(f.value),isNaN(f.value)?QueryFilters.ebvError():(f.type=c,f)}catch(e){return QueryFilters.ebvError()}}}}},t.exports={QueryFilters:QueryFilters}},{"./utils":140}],135:[function(e,t,r){var n=e("./utils"),i=e("./utils"),o={variablesInBGP:function(e){var t=e.variables;if(t)return t;var r=e.value||e;for(var n in t=[],r)r[n]&&"var"===r[n].token?t.push(r[n].value):r[n]&&"blank"===r[n].token&&t.push("blank:"+r[n].value);return e.variables=t,t},connected:function(e,t){for(var r="/"+e.vars.join("/")+"/",n=0;n<t.vars.length;n++)if(-1!=r.indexOf("/"+t.vars[n]+"/"))return!0;return!1}};o.variablesIntersectionBGP=function(e,t){return function(e,t){for(var r={},n=0;n<e.lenght;n++)r[e[n]]=1;for(n=0;n<t.length;n++){var i=r[t[n]]||0;i++,r[t[n]]=i}var o=[];for(var s in r)2==r[s]&&o.push(r[s]);return o}(o.variablesInBGP(e),o.variablesInBGP(t))},o.executeAndBGPsGroups=function(e){for(var t={},r={},i=0,s=function(e,t){for(var r=0;r<e.length;r++){var n="/"+e[r]+"/";if(-1!=t.indexOf(n))return!0}return!1},a=function(e,n,i,o){var s=[],a="",l="";for(var u in n)a+=u,s=s.concat(t[u]),l+=r[u];l=l+p.join("/")+"/",s.push(e),i[a]=s,o[a]=l},l=0;l<e.length;l++){var u=e[l],c={},f={},p=o.variablesInBGP(u),d={};for(var h in r)s(p,r[h])?d[h]=!0:(c[h]=t[h],f[h]=r[h]);0===n.size(d)?(c["g"+i]=[u],f["g"+i]="/"+p.join("/")+"/",i++):a(u,d,c,f),t=c,r=f}return n.values(t)},o.intersectionSize=function(e,t){for(var r=t.i.split("_"),n=0;n<r.length;n++)if(""!=r[n]&&-1!=e.i.indexOf("_"+r[n]+"_"))return 1;return 0},o.createJoinTree=function(e,t){for(var r="/"+e.vars.join("/")+"/",i=e.vars.concat([]),o=[],s=0;s<t.vars.length;s++)-1!=r.indexOf("/"+t.vars[s]+"/")?0==t.vars[s].indexOf("_:")?o.push("blank:"+t.vars[s]):o.push(t.vars[s]):i.push(t.vars[s]);var a=t.i.split("_"),l=e.i.split("_"),u={};for(s=0;s<a.length;s++)""!=a[s]&&(u[a[s]]=!0);for(s=0;s<l.length;s++)""!=l[s]&&(u[l[s]]=!0);var c=n.keys(u);return{left:e,right:t,cost:e.cost+t.cost,i:"_"+c.sort().join("_")+"_",vars:i,join:o}},o.executeBushyTree=function(e,t,r,n,i){null==e.left?o.executeEmptyJoinBGP(e.right,t,r,n,i):null==e.right?o.executeEmptyJoinBGP(e.left,t,r,n,i):o.executeBushyTree(e.left,t,r,n,(function(s){null!=s?o.executeBushyTree(e.right,t,r,n,(function(t){i(null!=t?o.joinBindings2(e.join,s,t):null)})):i(null)}))},o.executeAndBGPsDPSize=function(e,t,r,n,s){var a=o.executeAndBGPsGroups(e),l=[];i.eachSeries(a,(function(e,t){r.computeCosts(e,n,(function(e){var r={},n={},i={},s=1,a=null,u={};i[1]=[];for(var c=0;c<e.length;c++){var f=[];for(var p in delete e[c].variables,e[c])"_cost"!=p&&("var"===e[c][p].token||"blank"===e[c][p].token)&&f.push(e[c][p].value);n["_"+c+"_"]={left:e[c],right:null,cost:e[c]._cost,i:"_"+c+"_",vars:f};var d={left:e[c],right:null,cost:e[c]._cost,i:"_"+c+"_",vars:f};r["_"+c+"_"]=d,delete e[c]._cost,u["_"+c+"_"]=!0,i[1].push("_"+c+"_"),(null==a||a.cost>d.cost)&&(a=d)}for(var h=2;h<=e.length;h++)for(var y=1;y<h;y++){var v=h-y,g=i[""+y]||[],b=i[""+v]||[];for(c=0;c<g.length;c++)for(var m=0;m<b.length;m++)if(g[c]!==b[m]){var x=n[g[c]],_=n[b[m]];if(0==o.intersectionSize(x,_)&&o.connected(x,_)){s=h;var w=r[x.i],k=r[_.i],E=o.createJoinTree(w,k);if(!u[E.i]){u[E.i]=!0;var A=E.cost+1;null!=r[E.i]&&(A=r[E.i].cost);var S=i[h]||[];S.push(E.i),n[E.i]=E,i[h]=S,A>E.cost&&(s===h&&(a=E),r[E.i]=E)}}}}l.push(a),t()}))}),(function(){var e=null;i.eachSeries(l,(function(i,s){o.executeBushyTree(i,t,r,n,(function(t){t?null==e?(e=t,s()):(e=o.crossProductBindings(e,t),s()):s("Error executing bushy tree")}))}),(function(t){t?s(null,t):s(e)}))}))},o.executeEmptyJoinBGP=function(e,t,r,n,i){return o.executeBGPDatasets(e,t,r,n,i)},o.executeBGPDatasets=function(e,t,r,n,s){var a={};if(null==e.graph){var l=[];i.eachSeries(t.implicit,(function(t,i){null==a[t.oid]?(a[t.oid]=!0,e.graph=t,r.rangeQuery(e,n,(function(t){t=o.buildBindingsFromRange(t,e),l.push(t),i()}))):i()}),(function(){var e=o.unionManyBindings(l);s(e)}))}else if("var"===e.graph.token){var u=e.graph.value;l=[];i.eachSeries(t.named,(function(t,i){null==a[t.oid]?(a[t.oid]=!0,e.graph=t,null!=l?r.rangeQuery(e,n,(function(r){if(null!=r){r=o.buildBindingsFromRange(r,e);for(var n=0;n<r.length;n++)r[n][u]=t.oid;l.push(r)}else l=null;i()})):i()):i()}),(function(){if(null==l)s(null);else{var e=o.unionManyBindings(l);s(e)}}))}else r.rangeQuery(e,n,(function(t){null!=t?(t=o.buildBindingsFromRange(t,e),s(t)):s(null)}))},o.buildBindingsFromRange=function(e,t){o.variablesInBGP(t);var r=t.value||t,n={};for(c in r)r[c]&&"var"===r[c].token?n[c]=r[c].value:r[c]&&"blank"===r[c].token&&(n[c]="blank:"+r[c].value);var i=[];if(null!=e)for(var s=0;s<e.length;s++){var a={},l=e[s],u=!1;for(var c in n){var f=l[c];if(null!=a[n[c]]&&a[n[c]]!==f){u=!0;break}a[n[c]]=f}u||i.push(a)}return i},o.areCompatibleBindings=function(e,t){for(var r in e)if(null!=t[r]&&t[r]!=e[r])return!1;return!0},o.mergeBindings=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},o.joinBindings2=function(e,t,r){for(var n,i,s,a,l={},u=[],c=0;c<t.length;c++){n=t[c],a=l;for(var f=0;f<e.length;f++)i=n[e[f]],f==e.length-1?((s=a[i]||[]).push(n),a[i]=s):(s=a[i]||{},a[i]=s,a=s)}for(c=0;c<r.length;c++){n=r[c],a=l;for(f=0;f<e.length;f++)if(null!=a[i=n[e[f]]])if(f==e.length-1)for(var p=0;p<a[i].length;p++)u.push(o.mergeBindings(a[i][p],n));else a=a[i]}return u},o.joinBindings=function(e,t){for(var r=[],n=0;n<e.length;n++)for(var i=e[n],s=0;s<t.length;s++){var a=t[s];o.areCompatibleBindings(i,a)&&r.push(o.mergeBindings(i,a))}return r},o.augmentMissingBindings=function(e,t){for(var r in t)null==e[r]&&(e[r]=null);return e},o.leftOuterJoinBindings=function(e,t){for(var r=[],n=0;n<e.length;n++){for(var i=e[n],s=!1,a=0;a<t.length;a++){var l=t[a];o.areCompatibleBindings(i,l)&&(s=!0,r.push(o.mergeBindings(i,l)))}!1===s&&(o.augmentMissingBindings(i,l),r.push(i))}return r},o.crossProductBindings=function(e,t){for(var r=[],n=0;n<e.length;n++)for(var i=e[n],s=0;s<t.length;s++){var a=t[s];r.push(o.mergeBindings(i,a))}return r},o.unionBindings=function(e,t){return e.concat(t)},o.unionManyBindings=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t=o.unionBindings(t,n)}return t},t.exports={QueryPlan:o}},{"./utils":140}],136:[function(e,t,r){var n=e("./network_transport").NetworkTransport,i=e("./rvn3_parser").RVN3Parser,o=e("./jsonld_parser").JSONLDParser,s=e("./utils"),a=function(e){if(this.precedences=["text/turtle","text/n3","application/ld+json","application/json"],this.parsers={"text/turtle":i.parser,"text/n3":i.parser,"application/ld+json":o.parser,"application/json":o.parser},"undefined"!=typeof RDFXMLParser&&(this.precedences.push("application/rdf+xml"),this.parsers["application/rdf+xml"]=RDFXMLParser.parser),null!=e)for(var t in e.parsers)this.parsers[t]=e.parsers[t];if(e&&null!=e.precedences)for(var t in this.precedences=e.precedences,e.parsers)s.include(this.precedences,t)||this.precedences.push(t);this.acceptHeaderValue="";for(var r=0;r<this.precedences.length;r++)this.acceptHeaderValue=0!=r?this.acceptHeaderValue+","+this.precedences[r]:this.acceptHeaderValue+this.precedences[r]};a.prototype.registerParser=function(e,t){this.parsers[e]=t,this.precedences.push(e)},a.prototype.unregisterParser=function(e){delete this.parsers[e];for(var t=[],r=0;r<this.precedences.length;r++)this.precedences[r]!=e&&t.push(this.precedences[r]);this.precedences=t},a.prototype.setAcceptHeaderPrecedence=function(e){this.precedences=e},a.prototype.load=function(e,t,r){var i=this;n.load(e,this.acceptHeaderValue,(function(n,o){if(n)r(n);else{var s=o.headers["Content-Type"]||o.headers["content-type"],a=o.data;if(null!=s){for(var l in s=s.split(";")[0],i.parsers)if(-1!=l.indexOf("/")){var u=l.split("/");if("*"===u[1]){if(-1!=s.indexOf(u[0]))return i.tryToParse(i.parsers[l],t,a,{documentURI:e},r)}else{if(-1!=s.indexOf(l))return i.tryToParse(i.parsers[l],t,a,{documentURI:e},r);if(-1!=s.indexOf(u[1]))return i.tryToParse(i.parsers[l],t,a,{documentURI:e},r)}}else if(-1!=s.indexOf(l))return i.tryToParse(i.parsers[l],t,a,{documentURI:e},r);r(new Error("Unknown media type : "+s))}else r(new Error("Uknown media type"))}}))},a.prototype.loadFromFile=function(t,r,n,i){try{var o=this;e("fs").readFile(n.split("file:/")[1],(function(e,s){if(e)i(e);else{s=s.toString("utf8");o.tryToParse(t,r,s,{documentURI:n},i)}}))}catch(e){i(e)}},a.prototype.tryToParse=function(e,t,r,n,i){try{"string"==typeof r&&(r=s.normalizeUnicodeLiterals(r)),e.parse(r,t,n,i)}catch(e){console.log(e.message),console.log(e.stack),i(e)}},t.exports={RDFLoader:a}},{"./jsonld_parser":125,"./network_transport":127,"./rvn3_parser":138,"./utils":140,fs:4}],137:[function(e,t,r){var n=e("./utils"),i=e("./query_filters").QueryFilters;RDFModel={},RDFModel.defaultContext={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#",ldp:"http://www.w3.org/ns/ldp#"},RDFModel.UrisMap=function(){this.defaultNs="",this.interfaceProperties=["get","remove","set","setDefault","addAll","resolve","shrink"]},RDFModel.UrisMap.prototype.values=function(){var e={};for(var t in this)n.include(this.interfaceProperties,t)||"function"==typeof this[t]||"defaultNs"===t||"interfaceProperties"===t||(e[t]=this[t]);return e},RDFModel.UrisMap.prototype.get=function(e){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";return this[e]},RDFModel.UrisMap.prototype.remove=function(e){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";return delete this[e],null},RDFModel.UrisMap.prototype.set=function(e,t){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";this[e]=t},RDFModel.UrisMap.prototype.setDefault=function(e){this.defaultNs=e},RDFModel.UrisMap.prototype.addAll=function(e,t){for(var r in e)n.include(this.interfaceProperties,r)||(null!=this[r]?!0===t&&(this[r]=e[r]):this[r]=e[r]);return this},RDFModel.UrisMap.prototype.resolve=function(e){var t=e.split(":"),r=t[0],n=t[1];return""===r?null==this.defaultNs?null:this.defaultNs+n:null!=this[r]?this[r]+n:null},RDFModel.UrisMap.prototype.shrink=function(e){for(var t in this){var r=this[t];if(0===e.indexOf(r))if(""!==r&&"defaultNs"!=t)return t+":"+e.split(r)[1]}return e},RDFModel.Profile=function(){this.prefixes=new RDFModel.UrisMap,this.terms=new RDFModel.UrisMap},RDFModel.Profile.prototype.importProfile=function(e,t){this.prefixes.addAll(e.prefixes,t),this.terms.addAll(e.terms,t)},RDFModel.Profile.prototype.resolve=function(e){return-1!=e.indexOf(":")?this.prefixes.resolve(e):null!=this.terms[e]?this.terms.resolve(e):null},RDFModel.Profile.prototype.setDefaultPrefix=function(e){this.prefixes.setDefault(e)},RDFModel.Profile.prototype.setDefaultVocabulary=function(e){this.terms.setDefault(e)},RDFModel.Profile.prototype.setPrefix=function(e,t){this.prefixes.set(e,t)},RDFModel.Profile.prototype.setTerm=function(e,t){this.terms.set(e,t)},RDFModel.RDFEnvironment=function(){RDFModel.Profile.call(this),this.blankNodeCounter=0;var e=this;for(var t in this.filters={s:function(e){return function(t){return t.subject.equals(e)}},p:function(e){return function(t){return t.predicate.equals(e)}},o:function(e){return function(t){return t.object.equals(e)}},sp:function(e,t){return function(r){return r.subject.equals(e)&&r.predicate.equals(t)}},so:function(e,t){return function(r){return r.subject.equals(e)&&r.object.equals(t)}},po:function(e,t){return function(r){return r.predicate.equals(e)&&r.object.equals(t)}},spo:function(e,t,r){return function(n){return n.subject.equals(e)&&n.predicate.equals(t)&&n.object.equals(r)}},describes:function(e){return function(t){return t.subject.equals(e)||t.object.equals(e)}},type:function(t){var r=e.resolve("rdf:type");return function(e){return e.predicate.equals(r)&&e.object.equals(t)}}},RDFModel.defaultContext)this.prefixes.set(t,RDFModel.defaultContext[t])},RDFModel.RDFEnvironment.prototype=n.create(RDFModel.Profile.prototype,{constructor:RDFModel.RDFEnvironment}),RDFModel.RDFEnvironment.prototype.createBlankNode=function(){var e=new RDFModel.BlankNode(this.blankNodeCounter);return this.blankNodeCounter++,e},RDFModel.RDFEnvironment.prototype.createNamedNode=function(e){var t=this.resolve(e);return null!=t?new RDFModel.NamedNode(t):new RDFModel.NamedNode(e)},RDFModel.RDFEnvironment.prototype.createLiteral=function(e,t,r){return null!=r?new RDFModel.Literal(e,t,r.toString()):new RDFModel.Literal(e,t,r)},RDFModel.RDFEnvironment.prototype.createTriple=function(e,t,r){return new RDFModel.Triple(e,t,r)},RDFModel.RDFEnvironment.prototype.createGraph=function(e){var t=new RDFModel.Graph;if(null!=e)for(var r=0;r<e.length;r++)t.add(e[r]);return t},RDFModel.RDFEnvironment.prototype.createAction=function(e,t){return function(r){return e(r)?t(r):r}},RDFModel.RDFEnvironment.prototype.createProfile=function(e){if(!0===e)return new RDFModel.RDFEnvironment.Profile;var t=new RDFModel.RDFEnvironment.Profile;return t.importProfile(this),t},RDFModel.RDFEnvironment.prototype.createTermMap=function(e){if(!0===e)return new RDFModel.UrisMap;var t=this.terms.values(),r=new RDFModel.UrisMap;for(var n in t)r[n]=t[n];return r},RDFModel.RDFEnvironment.prototype.createPrefixMap=function(e){if(!0===e)return new RDFModel.UrisMap;var t=this.prefixes.values(),r=new RDFModel.UrisMap;for(var n in t)r[n]=t[n];return r},RDFModel.RDFNode=function(e){this.interfaceName=e,this.attributes=["interfaceName","nominalValue"]},RDFModel.RDFNode.prototype.equals=function(e){if(null==e.interfaceName)return this.valueOf()==e;for(var t in this.attributes){var r=this.attributes[t];if(this[r]!=e[r])return!1}return!0},RDFModel.BlankNode=function(e){RDFModel.RDFNode.call(this,"BlankNode"),this.nominalValue="_:"+e,this.bnodeId=e},RDFModel.BlankNode.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.BlankNode}),RDFModel.BlankNode.prototype.toString=function(){return this.nominalValue},RDFModel.BlankNode.prototype.toNT=function(){return this.nominalValue},RDFModel.BlankNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Literal=function(e,t,r){RDFModel.RDFNode.call(this,"Literal"),this.nominalValue=e,null!=t?this.language=t:null!=r&&(this.datatype=r)},RDFModel.Literal.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.Literal}),RDFModel.Literal.prototype.toString=function(){var e='"'+this.nominalValue+'"';return null!=this.language?e=e+"@"+this.language:(null!=this.datatype||this.type)&&(e=e+"^^<"+(this.datatype||this.type)+">"),e},RDFModel.Literal.prototype.toNT=function(){return this.toString()},RDFModel.Literal.prototype.valueOf=function(){return i.effectiveTypeValue({token:"literal",type:this.type||this.datatype,value:this.nominalValue,language:this.language})},RDFModel.NamedNode=function(e){RDFModel.RDFNode.call(this,"NamedNode"),null!=e.value?this.nominalValue=e.value:this.nominalValue=e},RDFModel.NamedNode.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.NamedNode}),RDFModel.NamedNode.prototype.toString=function(){return this.nominalValue},RDFModel.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"},RDFModel.NamedNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Triple=function(e,t,r){this.subject=e,this.predicate=t,this.object=r},RDFModel.Triple.prototype.equals=function(e){return this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)},RDFModel.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"},RDFModel.Graph=function(){this.triples=[],this.duplicates={},this.actions=[],this.length=0},RDFModel.Graph.prototype.add=function(e){for(var t=0;t<this.actions.length;t++)e=this.actions[t](e);var r=e.subject.toString()+e.predicate.toString()+e.object.toString();return this.duplicates[r]||(this.duplicates[r]=!0,this.triples.push(e)),this.length=this.triples.length,this},RDFModel.Graph.prototype.addAction=function(e,t){if(this.actions.push(e),1==t)for(var r=0;r<this.triples.length;r++)this.triples[r]=e(this.triples[r]);return this},RDFModel.Graph.prototype.addAll=function(e){for(var t=e.toArray(),r=0;r<t.length;r++)this.add(t[r]);return this.length=this.triples.length,this},RDFModel.Graph.prototype.remove=function(e){for(var t=null,r=0;r<this.triples.length;r++)if(this.triples[r].equals(e)){var n=e.subject.toString()+e.predicate.toString()+e.object.toString();delete this.duplicates[n],t=r;break}return null!=t&&this.triples.splice(t,1),this.length=this.triples.length,this},RDFModel.Graph.prototype.toArray=function(){return this.triples},RDFModel.Graph.prototype.some=function(e){for(var t=0;t<this.triples.length;t++)if(!0===e(this.triples[t],this))return!0;return!1},RDFModel.Graph.prototype.every=function(e){for(var t=0;t<this.triples.length;t++)if(!1===e(this.triples[t],this))return!1;return!0},RDFModel.Graph.prototype.filter=function(e){for(var t=new RDFModel.Graph,r=0;r<this.triples.length;r++)!0===e(this.triples[r],this)&&t.add(this.triples[r]);return t},RDFModel.Graph.prototype.forEach=function(e){for(var t=0;t<this.triples.length;t++)e(this.triples[t],this)},RDFModel.Graph.prototype.merge=function(e){for(var t=new RDFModel.Graph,r=0;r<this.triples.length;r++)t.add(this.triples[r]);return t},RDFModel.Graph.prototype.match=function(e,t,r,n){for(var i=new RDFModel.Graph,o=0,s=0;s<this.triples.length;s++){var a=this.triples[s];if((null==e||a.subject.equals(e))&&(null==t||a.predicate.equals(t))&&(null==r||a.object.equals(r))){if(!(null==n||o<n))return i;o++,i.add(a)}}return i},RDFModel.Graph.prototype.removeMatches=function(e,t,r){for(var n=[],i=0;i<this.triples.length;i++){var o=this.triples[i];(null==e||o.subject.equals(e))&&(null==t||o.predicate.equals(t))&&(null==r||o.object.equals(r))&&n.push(o)}for(i=0;i<n.length;i++)this.remove(n[i]);return this},RDFModel.Graph.prototype.toNT=function(){var e="";return this.forEach((function(t){e+=t.toString()})),e},RDFModel.buildRDFResource=function(e,t,r,n){if("blank"===e.token)return RDFModel.buildBlankNode(e,t,r,n);if("literal"===e.token)return RDFModel.buildLiteral(e,t,r,n);if("uri"===e.token)return RDFModel.buildNamedNode(e,t,r,n);if("var"===e.token){var i=t[e.value];return null!=i?RDFModel.buildRDFResource(i,t,r,n):null}return null},RDFModel.buildBlankNode=function(e,t,r,n){return null!=e.valuetmp&&(e.value=e.valuetmp),0===e.value.indexOf("_:")&&(e.value=e.value.split("_:")[1]),new RDFModel.BlankNode(e.value)},RDFModel.buildLiteral=function(e,t,r,n){return new RDFModel.Literal(e.value,e.lang,e.type)},RDFModel.buildNamedNode=function(e,t,r,n){if(null!=e.value)return new RDFModel.NamedNode(e);if(null!=e.prefix){var i=r.resolveNsInEnvironment(e.prefix,n);return e.value=i+e.suffix,new RDFModel.NamedNode(e)}return new RDFModel.NamedNode(e)},RDFModel.rdf=new RDFModel.RDFEnvironment,t.exports=RDFModel},{"./query_filters":134,"./utils":140}],138:[function(e,t,r){var n=e("n3").Parser,i={};function o(e){switch(e[0]){case'"':if(e.indexOf("^^")>0){var t=e.split("^^");return{literal:t[0]+"^^<"+t[1]+">"}}return{literal:e};case"_":return{blank:e.replace("b","")};default:return{token:"uri",value:e,prefix:null,suffix:null}}}i.parser={async:!0,parse:function(e,t,r,i){i||(i=r,r=t,t=null),t&&"string"==typeof t&&(t={token:"uri",value:t,prefix:null,suffix:null}),r&&r.baseURI&&(r.documentIRI=r.baseURI);var s=[];new n(r).parse(e,(function(e,r){e?i(e):r?s.push({subject:o(r.subject),predicate:o(r.predicate),object:o(r.object),graph:t}):i(!1,s)}))},resetBlankNodeIds:function(){n._resetBlankNodeIds()}},t.exports={RVN3Parser:i}},{n3:51}],139:[function(e,t,r){var n=e("./query_engine").QueryEngine,i=e("./quad_backend").QuadBackend,o=e("./persistent_quad_backend").PersistentQuadBackend,s=e("./lexicon").Lexicon,a=e("./persistent_lexicon").PersistentLexicon,l=e("./rdf_model"),u=e("./utils");Store=function(e,t){var r=null,l=null;if(0==arguments.length)l={};else if(1==arguments.length)l={},r=e;else{if(!(arguments.length>1))throw"An optional argument map and a callback must be provided";l=e,r=t}null==l.treeOrder&&(l.treeOrder=15);var u=s,c=i;!0===l.persistent&&(u=a,c=o),this.functionMap={};var f=this;this.customFns={},new u((function(e){var t=function(){new c(l,(function(t){var i=function(){l.backend=t,l.lexicon=e,f.engine=new n(l),r(null,f)};l.overwrite?t.clear(i):i()}))};!0===l.overwrite?e.clear(t):t()}),l.name)},Store.prototype.rdf=l.rdf,Store.prototype.rdf.api=l,Store.prototype.registerCustomFunction=function(e,t){this.customFns[e]=t,this.engine.setCustomFunctions(this.customFns)},Store.prototype.execute=function(){if(3===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(4===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var e;if(1===arguments.length){e=arguments[0];var t=function(){}}else 2===arguments.length&&(e=arguments[0],t=arguments[1]);this.engine.execute(e,t)}},Store.prototype.executeWithEnvironment=function(){var e,t,r;if(3===arguments.length){e=arguments[0];var n=function(){};t=arguments[1],r=arguments[2]}else if(4===arguments.length){e=arguments[0];n=arguments[3];t=arguments[1],r=arguments[2]}t=u.map(t,(function(e){return{token:"uri",value:e}})),r=u.map(r,(function(e){return{token:"uri",value:e}})),this.engine.execute(e,n,t,r)},Store.prototype.graph=function(){var e=null,t=null;if(1===arguments.length)t=arguments[0]||function(){},e=this.engine.lexicon.defaultGraphUri;else{if(2!==arguments.length)throw"An optional graph URI and a callback function must be provided";t=arguments[1]||function(){},e=arguments[0]}null!=this.rdf.resolve(e)&&(e=this.rdf.resolve(e)),this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",t)},Store.prototype.node=function(){var e=null,t=null,r=null;if(2===arguments.length)r=arguments[0],t=arguments[1]||function(){},e=this.engine.lexicon.defaultGraphUri;else{if(3!==arguments.length)throw"An optional graph URI, node URI and a callback function must be provided";r=arguments[0],e=arguments[1],t=arguments[2]||function(){}}null!=this.rdf.resolve(e)&&(e=this.rdf.resolve(e)),null!=this.rdf.resolve(r)&&(r=this.rdf.resolve(r)),this.engine.execute("CONSTRUCT { <"+r+"> ?p ?o } WHERE { GRAPH <"+e+"> { <"+r+"> ?p ?o } }",t)},Store.prototype.startObservingNode=function(){var e,t,r;2===arguments.length?(e=arguments[0],r=arguments[1],this.engine.callbacksBackend.observeNode(e,r,(function(){}))):3===arguments.length&&(e=arguments[0],t=arguments[1],r=arguments[2],this.engine.callbacksBackend.observeNode(e,t,r,(function(){})))},Store.prototype.stopObservingNode=function(e){this.engine.callbacksBackend.stopObservingNode(e)},Store.prototype.startObservingQuery=function(){var e=arguments[0],t=arguments[1],r=arguments[2];null!=r?this.engine.callbacksBackend.observeQuery(e,t,r):this.engine.callbacksBackend.observeQuery(e,t,(function(){}))},Store.prototype.stopObservingQuery=function(e){this.engine.callbacksBackend.stopObservingQuery(e)},Store.prototype.subscribe=function(e,t,r,n,i){var o=this,s=function(e,t){var r=[],n={blanks:{},outCache:{}},s=[];u.each(t,(function(e){var t=l.buildRDFResource(e.subject,s,o.engine,n),i=l.buildRDFResource(e.predicate,s,o.engine,n),a=l.buildRDFResource(e.object,s,o.engine,n);null!=t&&null!=i&&null!=a&&(e=new l.Triple(t,i,a),r.push(e))})),i(e,r)};this.functionMap[i]=s,this.engine.callbacksBackend.subscribe(e,t,r,n,s,(function(){}))},Store.prototype.unsubscribe=function(e){var t=this.functionMap[e];this.engine.callbacksBackend.unsubscribe(t),delete this.functionMap[e]},Store.prototype.setPrefix=function(e,t){this.rdf.setPrefix(e,t)},Store.prototype.setDefaultPrefix=function(e){this.rdf.setDefaultPrefix(e)},Store.prototype.insert=function(){var e,t,r;if(1===arguments.length)t=arguments[0],r=function(){};else if(2===arguments.length)t=arguments[0],r=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to insert, an optional graph and callback must be provided";t=arguments[0],e=this.rdf.createNamedNode(arguments[1]),r=arguments[2]||function(){}}var n="",i=this;t.forEach((function(e){n=n+i._nodeToQuery(e.subject)+i._nodeToQuery(e.predicate)+i._nodeToQuery(e.object)+"."})),n=null!=e?"INSERT DATA { GRAPH "+this._nodeToQuery(e)+" { "+n+" } }":"INSERT DATA { "+n+" }",this.engine.execute(n,r)},Store.prototype._nodeToQuery=function(e){if("NamedNode"===e.interfaceName){var t=this.rdf.resolve(e.valueOf());return null!=t?"<"+t+">":"<"+e.valueOf()+">"}return e.toString()},Store.prototype.delete=function(){var e,t,r;if(1===arguments.length)t=arguments[0],r=function(){};else if(2===arguments.length)t=arguments[0],r=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to delete, an optional graph and callback must be provided";t=arguments[0],e=this.rdf.createNamedNode(arguments[1]),r=arguments[2]||function(){}}var n="",i=this;t.forEach((function(e){n=n+i._nodeToQuery(e.subject)+i._nodeToQuery(e.predicate)+i._nodeToQuery(e.object)+"."})),n=null!=e?"DELETE DATA { GRAPH "+this._nodeToQuery(e)+" { "+n+" } }":"DELETE DATA { "+n+" }",this.engine.execute(n,r)},Store.prototype.clear=function(){var e;if(0===arguments.length){e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri);var t=function(){}}else if(1===arguments.length)e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),t=arguments[0]||function(){};else{if(2!==arguments.length)throw"The optional graph and a callback must be provided";e=this.rdf.createNamedNode(arguments[0]),t=arguments[1]||function(){}}var r="CLEAR GRAPH "+this._nodeToQuery(e);this.engine.execute(r,t)},Store.prototype.setBatchLoadEvents=function(e){this.engine.eventsOnBatchLoad=e},Store.prototype.registerDefaultNamespace=function(e,t){this.rdf.prefixes.set(e,t),this.engine.registerDefaultNamespace(e,t)},Store.prototype.registerDefaultProfileNamespaces=function(){var e=this.rdf.prefixes.values();for(var t in e)this.registerDefaultNamespace(t,e[t])},Store.prototype.load=function(){var e,t,r,n,i={};if(3===arguments.length)r=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),e=arguments[0],t=arguments[1],n=arguments[2]||function(){};else if(4===arguments.length)e=arguments[0],t=arguments[1],"string"==typeof(i=arguments[2])?(r=this.rdf.createNamedNode(i),i={}):(r=this.rdf.createNamedNode(i.graph||this.engine.lexicon.defaultGraphUri),delete i.graph),n=arguments[3]||function(){};else if(2===arguments.length)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if("remote"===e){var o="LOAD <"+(t=this.rdf.createNamedNode(t)).valueOf()+"> INTO GRAPH <"+r.valueOf()+">";this.engine.execute(o,n)}else{var s=this,a=this.engine.rdfLoader.parsers[e];if(!a)return n(new Error("Cannot find parser for the provided media type:"+e));var l=function(e,t){e?n(e,t):s.engine.batchLoad(t,(function(e){null!=e?n(null,e):n(new Error("Error batch-loading triples."))}))},u=[a,{token:"uri",value:r.valueOf()},t,i,l];t&&"string"==typeof t&&0===t.indexOf("file://")?this.engine.rdfLoader.loadFromFile.apply(null,u):this.engine.rdfLoader.tryToParse.apply(null,u)}},Store.prototype.registerParser=function(e,t){this.engine.rdfLoader.registerParser(e,t)},Store.prototype.registeredGraphs=function(e){this.engine.lexicon.registeredGraphs(!0,(function(t){var r=u.map(t,(function(e){return new l.NamedNode(e)}));e(null,r)}))},Store.prototype.getNetworkTransport=function(){return NetworkTransport},Store.prototype.setNetworkTransport=function(e){NetworkTransport=e},Store.prototype.close=function(e){null==e&&(e=function(){}),this.engine.close?this.engine.close(e):e()},Store.VERSION="0.9.18-alpha.9";Store.yieldFrequency=function(e){u.yieldFrequency(e)},t.exports.Store=Store,t.exports.create=function(){return 1==arguments.length?new Store(arguments[0]):2==arguments.length?new Store(arguments[0],arguments[1]):new Store},t.exports.connect=function(){(1==arguments.length?arguments[0]:2==arguments.length?arguments[1]:arguments[2])(new Error("Store#connect is not supported in the 0.9.X series of the library"))}},{"./lexicon":126,"./persistent_lexicon":129,"./persistent_quad_backend":130,"./quad_backend":131,"./query_engine":133,"./rdf_model":137,"./utils":140}],140:[function(require,module,exports){(function(process){(function(){var slowNextTick=void 0!==process&&process.nextTick?process.nextTick:"undefined"!=typeof window&&window.setImmediate?window.setImmediate:function(e){setTimeout(e,0)},spin=0,yieldFrequency=100,nextTick=function(e){++spin<yieldFrequency?e():(spin=0,slowNextTick(e))},hashTerm=function(e){try{if(null==e)return"";if("uri"===e.token)return"u"+e.value;if("blank"===e.token)return"b"+e.value;if("literal"===e.token){var t="l"+e.value;return t+=e.type||"",t+=e.lang||""}}catch(t){if("object"==typeof e){var r="";for(p in e)r=r+p+e[p];return r}return e}},lexicalFormBaseUri=function(e,t){var r=null;if(t=t||{},null==e.value){var n=e.prefix,i=e.suffix,o=t.namespaces[n];r=null!=o?o+i:n+":"+i}else r=e.value;return null===r?null:(-1==r.indexOf(":")&&(r=(t.base||"")+r),r)};parseISO8601=function(e){return Date.parse(e)},Date.prototype.toISOString||function(){function e(e){return e<10?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),iso8601=function(e){return e.toISOString()},compareDateComponents=function(e,t){var r=parseISO8601(e),n=parseISO8601(t);return r==n?0:r<n?-1:1},lexicalFormLiteral=function(e,t){var r=e.value,n=e.lang,i=e.type,o=null;if(null!=r&&null!=i&&"string"!=typeof i){var s=i.value;if(null==s){var a=i.prefix,l=i.suffix,u=t.namespaces[a];e.type=u+l,s=u+l}o=-1!=s.indexOf("hexBinary")?'"'+e.value.toLowerCase()+'"^^<'+s+">":'"'+e.value+'"^^<'+s+">"}else o=null==n&&null==i?'"'+r+'"':null==i?'"'+r+'"@'+n:-1!=i.indexOf("hexBinary")?'"'+e.value.toLowerCase()+'"^^<'+i+">":'"'+e.value+'"^^<'+i+">";return o},normalizeUnicodeLiterals=function(string){for(var escapedUnicode=string.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],dups={},i=0;i<escapedUnicode.length;i++)null==dups[escapedUnicode[i]]&&(dups[escapedUnicode[i]]=!0,string=string.replace(new RegExp("\\"+escapedUnicode[i],"g"),eval("'"+escapedUnicode[i]+"'")));return string},registerIndexedDB=function(e){if("undefined"==typeof window&&void 0!==process&&!1===process.browser){var t=_dereq_("sqlite3"),r=_dereq_("indexeddb-js"),n=new t.Database(":memory:"),i=r.makeScope("sqlite3",n);e.indexedDB=i.indexedDB,e.IDBKeyRange=i.IDBKeyRange}else{var o;(o="undefined"==typeof window?self:window).indexedDB=o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,o.IDBKeyRange=o.IDBKeyRange||o.webkitIDBKeyRange||o.msIDBKeyRange,o.indexedDB?(e.indexedDB=o.indexedDB,e.IDBKeyRange=o.IDBKeyRange):console.log("The browser does not support IndexDB.")}},guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},hashTerm=function(e){try{if(null==e)return"";if("uri"===e.token)return"u"+e.value;if("blank"===e.token)return"b"+e.value;if("literal"===e.token){var t="l"+e.value;return t+=e.type||"",t+=e.lang||""}}catch(t){if("object"==typeof e){var r="";for(p in e)r=r+p+e[p];return r}return e}};var reject=function(e,t){for(var r=[],n=0;n<e.length;n++)t(e[n])&&r.push(e[n]);return r},include=function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1},each=function(e,t){if(e.forEach)e.forEach(t);else for(var r=0;r<e.length;r++)t(e[r])},map=function(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r[n]=t(e[n]);return r},keys=function(e){var t=[];for(var r in e)t.push(r);return t},values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},size=function(e){if(e.length)return e.length;var t=0;for(var r in e)t++;return t};clone=function(e){return JSON.parse(JSON.stringify(e))};var isObject=function(e){var t=typeof e;return"function"==t||e&&"object"==t||!1},create=function(){function e(){}return function(t){if(isObject(t)){e.prototype=t;var r=new e;e.prototype=null}return r||void 0}}(),whilst=function(e,t,r){e()?t((function(n){if(n)return r(n);whilst(e,t,r)})):r()},eachSeries=function(e,t,r){if(r=r||function(){},!e.length)return r();var n=0,i=function(){t(e[n],(function(t){t?(r(t),r=function(){}):(n+=1)>=e.length?r():nextTick(i)}))};i()},eachParallel=function(e,t,r){if(r=r||function(){},!e.length)return r();for(var n=!1,i=0,o=function(t){if(t)throw n=!0,new Error(t);n||++i===e.length&&r()},s=0;s<e.length;s++)!function(e,t,r,n){nextTick((function(){try{n(e[t],(function(){r()}))}catch(e){r(e)}}))}(e,s,o,t)},reduce=function(e,t,r,n){eachSeries(e,(function(e,n){r(t,e,(function(e,r){t=r,n(e)}))}),(function(e){n(e,t)}))},seq=function(){var e=arguments;return function(){var t=this,r=Array.prototype.slice.call(arguments),n=r.pop();reduce(e,r,(function(e,r,n){r.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);n(e,t)}]))}),(function(e,r){n.apply(t,[e].concat(r))}))}},isWorker=function(){return(void 0===process||!0===process.browser)&&"undefined"==typeof window};module.exports={isWorker:isWorker,nextTick:nextTick,hasTerm:hashTerm,lexicalFormBaseUri:lexicalFormBaseUri,parseISO8601:parseISO8601,compareDateComponents:compareDateComponents,iso8601:iso8601,normalizeUnicodeLiterals:normalizeUnicodeLiterals,lexicalFormLiteral:lexicalFormLiteral,registerIndexedDB:registerIndexedDB,guid:guid,hashTerm:hashTerm,keys:keys,values:values,size:size,map:map,each:each,forEach:each,include:include,reject:reject,remove:reject,clone:clone,create:create,whilst:whilst,eachSeries:eachSeries,eachParallel:eachParallel,seq:seq,yieldFrequency:function(e){yieldFrequency=e}}}).call(this)}).call(this,require("_process"))},{_process:59}]},{},[139])(139)}));
